<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <script type="text/javascript">
 
 function goTopEx(){
        var obj=document.getElementById("goTopBtn");
        function getScrollTop(){
                return document.documentElement.scrollTop;
            }
        function setScrollTop(value){
                document.documentElement.scrollTop=value;
            }    
        window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
        obj.onclick=function(){
            var goTop=setInterval(scrollMove,10);
            function scrollMove(){
                    setScrollTop(getScrollTop()/111);
                    if(getScrollTop()<1)clearInterval(goTop);
                }
        }
    }


</script>
<script type="text/javascript">
 
 function goTopEx(){
        var obj=document.getElementById("goTopBtn");
        function getScrollTop(){
                return document.documentElement.scrollTop;
            }
        function setScrollTop(value){
                document.documentElement.scrollTop=value;
            }    
        window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
        obj.onclick=function(){
            var goTop=setInterval(scrollMove,10);
            function scrollMove(){
                    setScrollTop(getScrollTop()/111);
                    if(getScrollTop()<1)clearInterval(goTop);
                }
        }
    }


</script>
<title>ADO</title>

 <style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:85.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 105px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 30px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
	writing-mode:tb-rl;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 #shangy {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 80px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
#xiay {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 55px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 
 img{
 border:0;
 }
</style>
</head>

<body>

<div class="container">
  <h4><a href="http://www.w3school.com.cn/ado/ado_connect.asp">ADO 数据库连接</a></h4>

  <p>ADO指 ActiveX 数据对象（<em>A</em>ctiveX&nbsp;<em>D</em>ata&nbsp;<em>O</em>bjects），是一种<a href="http://baike.baidu.com/view/125370.htm" target="_blank">面向对象</a>的<a href="http://baike.baidu.com/view/897136.htm" target="_blank">编程接口</a>，微软介绍说，与其同IBM和Oracle提倡的那样，创建一个统一数据库，不如提供一个能够访问不同数据库的统一接口，这样会更加实用一些。为实现这一目标，微软在数据库和微软的OLE DB中提供了一种“桥”程序，这种程序能够提供对数据库的连接。　开发人员在使用ADO时，其实就是在使用OLE DB，不过OLE DB更加接近底层。ADO的一项属性-远程数据服务，支持“<a href="http://baike.baidu.com/view/19711.htm" target="_blank">数据仓库</a>”ActiveX&nbsp;<a href="http://baike.baidu.com/view/379950.htm" target="_blank">组件</a>以及高效的<a href="http://baike.baidu.com/view/5508102.htm" target="_blank">客户端缓存</a>。作为ActiveX的一部分，ADO也是COM组件的一部分。ADO是由早期的微软数据接口——远程<a href="http://baike.baidu.com/view/178571.htm" target="_blank">数据对象</a>RDO演化而来的。RDO同微软的ODBC一同连接关系数据库，不过不能连接非关系数据库。 </p>
  <h4>从一个  ASP 页面内部访问数据库的通常的方法是：</h4>
  <ol>
    <li>创建一个到数据库的  ADO 连接 </li>
    <li>打开数据库连接 </li>
    <li>创建 ADO 记录集 </li>
    <li>从记录集提取您需要的数据 </li>
    <li>关闭记录集 </li>
    <li>关闭连接 </li>
  </ol>
  <h4>ADO数据库编程&nbsp;</h4>
  <p>中大型的数据库管理信息系统(MIS)的开发，一般很少用VC来完成（因为开发效率低，不过运行效率很高），而是使用VB，&nbsp;C#，Java等开发效率较高的语言。但小型MIS系统完全可以用VC来实现。下面讲解VC中访问数据库的基本技术。&nbsp;</p>
  
  
  <h3>一、四种数据库访问技术&nbsp;</h3>
  <h4><strong>ODBC</strong><strong>（Open&nbsp;Database&nbsp;Connectivity</strong><strong>）&nbsp;</strong></h4>
  <p>开放式数据库连接，是一种用来在数据库管理系统（DBMS）中存取数据的标准应用程序接口。有ODBC&nbsp;API和MFC&nbsp;ODBC两种开发技术。</p>
  <h4><strong>DAO(Data&nbsp;Access&nbsp;Object&nbsp;)&nbsp;</strong></h4>
  <p>即数据访问对象集，是Microsoft提供的基于一个数据库对象集合的访问技术。和ODBC一样，他们都是Windows&nbsp;API的一部分，可以独立于（DBMS）进行数据库的访问。&nbsp;&nbsp;</p>
  <p>DAO跟ODBC的区别是：&nbsp;</p>
  <p>访问机制不同！ODBC工作依赖于数据库制造商(MS&nbsp;SQL&nbsp;Server，&nbsp;Oracle，Sybase等)提供的驱动程序。使用ODBC&nbsp;API的时候，Windows的ODBC管理程序，把对数据库的访问请求传递给正确的驱动程序，驱动程序再使用SQL语句指示DBMS完成数据库访问工作。DAO则绕开中间环节，直接使用数据库引擎（Microsoft&nbsp;Jet&nbsp;Database&nbsp;Engine）提供的各种对象进行工作。速度比ODBC快。</p>
<h4><strong>OLE&nbsp;DB</strong><strong>（Object&nbsp;Link&nbsp;and&nbsp;Embedding&nbsp;Database</strong><strong>）&nbsp;</strong></h4>
  <p>非常底层，基于COM接口技术；功能强大灵活，但编程非常麻烦，使用ADO只需要3-5行代码的事情，用OLEDB却需要将近200-300行代码才能完成。WinCE目前不支持ADO，但支持OLEDB。推荐阅读文章：VC++实战OLEDB编程(一)至(九)&nbsp;</p>
  <p>http://gamebabyrocksunblog.163.com/blog/static/571534632008101083957499/&nbsp;&nbsp;<br />
    &lt;%<br />
    Set Conn=Server.CreateObject(“Adodb.Connection”)<br />
    Path=  Server.MapPath(“/user.mdb”)<br />
    Conn.ConnectionString=“Provider=Microsoft.Jet.OLEDB.4.0;”&amp;_<br />
    “Data  Source=”&amp;Path;”&amp;_<br />
    “User Id=admin;”&amp;_<br />
    “Password=;”<br />
    Conn.Open  Provider=Microsoft.Jet.OLEDB.4.0; Data Source=”&amp; Server.MapPath(“/user.mdb”)&amp;”;user  Id=;password=;”<br />
    %&gt;</p>
  &lt;%<br />
    Set Conn=Server.CreateObject(“Adodb.Connection”)<br />
    Conn.Open  “<br />
    %&gt;</p>
  <p>(包括OLE DB提供者的名字和数据源的路径，Conn.ConnectionString还可以包括User ID=UserID;Password=Password)<br />
<h4><strong>ADO</strong><strong>(ActiveX&nbsp;Data&nbsp;Object)&nbsp;</strong></h4>
<p>是建立在OLE&nbsp;DB之上的高层数据库访问技术，是对OLEDB的封装，微软为我们提供了丰富的COM组件（包括ActiveX）来访问各种关系型/非关系型数据库。特点是简单、易用，这也是为什么大多数数据库应用软件开发者选择ADO的重要原因。</p>
  &lt;%<br />
    Set Conn=Server.CreateObject(“Adodb.Connection”)<br />
    Path=  Server.MapPath(“database/user.mdb”)<br />
    Conn.Open  “driver={Microsoft Access  Driver(user.mdb)};Path=” &amp;DBPath<br />
    %&gt;</p>
&lt;%<br />
    Set Conn=Server.CreateObject(“Adodb.Connection”)<br />
    Conn.Open  “driver={Microsoft Access  Driver(user.mdb)};Path=”  &amp;Server.MapPath(“database/user.mdb”)<br />
    %&gt;</p>

  
  <h4><strong>DSN</strong><strong>连接（Data Source Name</strong><strong>） </strong></h4>
使用Connection对象建立并管理与各种数据库的连接；<br />
    使用Command对象灵活查询数据。<br />
    使用RecordSet数据集和对象；</p>
  <p>ADO使用RecordSet数据集对象作为数据的主要界面。ADO可以使用VBScript、JavaScript等脚本语言来控制数据库以及输出查询结果。</p>
  <p>可以编写简明紧凑的脚本，以便连接到与Open DataBase  Connectivity(ODBC)兼容的数据源和与OLE DB兼容的数据源；</p>
  <p>&nbsp;</p>
  <p>notes.asp内容：</p>
  <p>&lt;%
    <br />
    Dim MM_notes_STRING<br />
    MM_notes_STRING = &quot;dsn=wwuself;&quot;<br />
  %&gt;</p>
  <p>&nbsp;</p>
  <p>add.asp:</p>
  <p>&lt;%<br />
    dim oCmd,oConn<br />
    set oConn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br />
    set oCmd = Server.CreateObject(&quot;ADODB.command&quot;)<br />
    oConn.ConnectionString = &quot;DSN=wwuself;&quot;<br />
    oConn.open<br />
    Set oCmd.ActiveConnection = oConn<br />
    oCmd.CommandText = &quot;INSERT INTO records (summary,content) VALUES ('&quot;&amp; summary1 &amp;&quot;','&quot;&amp; content1 &amp;&quot;')&quot;<br />
    oCmd.Execute<br />
  Response.Write(&quot;操作成功！&quot;)</p>
  <p>修改为：</p>
  <p>dim oCmd,oConn,db<br />
    set oConn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br />
    set oCmd = Server.CreateObject(&quot;ADODB.command&quot;)<br />
    db= &quot;\wwu.mdb&quot;<br />
    oConn.ConnectionString=&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&amp;_<br />
    &quot;Data Source=&quot; &amp; Server.MapPath(db)<br />
    oConn.open<br />
    Set oCmd.ActiveConnection = oConn<br />
    oCmd.CommandText = &quot;INSERT INTO records (summary,content) VALUES ('&quot;&amp; summary1 &amp;&quot;','&quot;&amp; content1 &amp;&quot;')&quot;<br />
    oCmd.Execute<br />
  Response.Write(&quot;操作成功！&quot;)</p>
  <p></p>
  <p></p>
  <p>addform.asp\del.asp\modify.asp\adim.asp修改：</p>
  <p>1 插入：</p>
  <p>dim oConn<br />
    dim db<br />
    set oConn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br />
    db = &quot;\wwu.mdb&quot;<br />
    oConn.ConnectionString=&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&amp;_<br />
    &quot;Data Source=&quot; &amp; Server.MapPath(db)<br />
  oConn.open()</p>
  <p>2 删除：&lt;!--#include file=&quot;Connections/notes.asp&quot; --&gt;</p>
  <p>3 替换：</p>
  <p> MM_editConnection = MM_notes_STRING</p>
  <p>替换为：MM_editConnection = oConn</p>
  <p>Recordset1.ActiveConnection = MM_notes_STRING</p>
  <p>替换为：Recordset1.ActiveConnection = oConn</p>
  <p>&nbsp;</p>
   '使用ADO对象操作数据库<br />
    &lt;%<br />
    dim oConn<br />
    dim db<br />
    set oConn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br />
    db = &quot;\wwu.mdb&quot;<br />
    oConn.ConnectionString=&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&amp;_<br />
    &quot;Data Source=&quot; &amp; Server.MapPath(db)<br />
  oConn.open()<br />
<br />
Dim rs, cmd,sql<br />
    Set rs = Server.CreateObject(&quot;ADODB.Recordset&quot;)<br />
    '对象连接，将Connection对象连接到Recordset对象<br />
    rs.ActiveConnection = oConn<br />
    '此时即可以使用rs对象的属性和方法；<br />
    ...<br />
    Set cmd = Server.CreateObject(&quot;ADODB.Command&quot;)<br />
    cmd.ActiveConnection = oConn<br />
    sql = &quot;Delete From records where summary='做空货币'&quot;<br />
    cmd.Command.Text=sql<br />
    cmd.Execute()<br />
    ...<br />
    %&gt;</p>
</div>
<a name="bottom" id="bottom"></a>
<DIV style="DISPLAY: none" id=goTopBtn>&and;</DIV>
<div id="goBottom"><a href="#bottom" target="_self">&or;</a></div>
<SCRIPT type=text/javascript>goTopEx();</SCRIPT>
</body>
</html>
<script language="javascript"> 
bg_evensssss("tbrowser","#fff","#F5F5F5","#FFFFCC","#FFDDFF");/*#FFFF84*/
</script>
