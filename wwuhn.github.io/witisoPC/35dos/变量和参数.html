<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <script type="text/javascript">
 
 function goTopEx(){
var obj=document.getElementById("goTopBtn");
function getScrollTop(){
return document.documentElement.scrollTop;
}
function setScrollTop(value){
document.documentElement.scrollTop=value;
}
window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
obj.onclick=function(){
var goTop=setInterval(scrollMove,10);
function scrollMove(){
setScrollTop(getScrollTop()/111);
if(getScrollTop()<1)clearInterval(goTop);
}
}
}


</script>
<script type="text/javascript">
 
 function goTopEx(){
var obj=document.getElementById("goTopBtn");
function getScrollTop(){
return document.documentElement.scrollTop;
}
function setScrollTop(value){
document.documentElement.scrollTop=value;
}
window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
obj.onclick=function(){
var goTop=setInterval(scrollMove,10);
function scrollMove(){
setScrollTop(getScrollTop()/111);
if(getScrollTop()<1)clearInterval(goTop);
}
}
}


</script>
<title>变量和参数</title>

 <style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:5px;
margin-bottom:-15px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color:#eee;
color:#000;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 105px;
_bottom: "auto";
cursor: pointer;
opacity: .6;
filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 30px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
	writing-mode:tb-rl;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 #shangy {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 80px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
}
#xiay {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 55px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
}
 
 img{
 border:0;
 }
 #tab1{
 width:100%;
 border-collapse:collapse;
 
 }
 #tab1 td{
 border:1px blue solid;
 }
#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	
	table-layout:fixed;
	font-size:18px;
}

#tbrowser th,#tbrowser td{
border:1px solid #eee;
font-size:14px;
color:#000000;

font-family: "宋体";
padding-left:0px;
width:14.1%;

height:22px;
line-height:18px;
/*overflow:hidden;
white-space:nowrap;*/
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
/*padding:2px 0px;*/
display:table-column-group;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
background-color:#f2f4b9;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;

/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/

/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;

/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;

/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;

line-height:18px;
font-size:16px;
color:#777;
}
table{
border-collapse:collapse;
width:100%;margin:auto;
}
table td{
border:0px;
border:1px solid #aaa;
padding:5px;
}
p{
text-indent:2em;}
 </style>
</head>

<body><div class="container">
<table cellspacing="0" cellpadding="0">
  <col width="78" />
  <col width="518" />
  <tr height="19">
    <td height="19" width="78">1    参数</td>
    <td width="518">参数变量：直接接收用户附于批处理程序后的字串，并将各字串自动代入相应的变量。</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>%0-%9；%0代表批处理文件本身，此后顺推；%0自动默认为批处理文件名，不需要任何传递或赋值操作；</td>
  </tr>
  <tr height="19">
    <td height="19">2 变量赋值</td>
    <td>set varname=varvalue</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>变量的表达式赋值：set /a ver=100+1</td>
  </tr>
  <tr height="19">
    <td height="19">3 与用户交互的变量</td>
    <td>set /p varname=&quot;remark&quot;</td>
  </tr>
  <tr height="19">
    <td height="19">4 替换变量值</td>
    <td>%varname%:表示引用变量；</td>
  </tr>
  <tr height="19">
    <td height="19">5 迭代变量</td>
    <td>%a-%z或%A-%Z；只存在于for循环的上下文件中，首先定义的是其初始值；</td>
  </tr>
  <tr height="19">
    <td height="19">变量的清除或释放：</td>
    <td>set ver=</td>
  </tr>
  <tr height="19">
    <td height="19">变量作用范围局部化</td>
    <td>setlocal</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>1 定义的变量退出cmd时这些变量将不复存在；</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>2 可设置变量的作用范围局限在某个特定的区域；</td>
  </tr>
  <tr height="19">
    <td height="19">环境变量</td>
    <td>path,homedrive,computername,errorlevel(追踪最近使用命令的退出代码）；</td>
  </tr>
  <tr height="19">
    <td height="19">变量扩充</td>
    <td>2 变量要用%x来表示,x可取a-z,A-Z,0-9;</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>%a-z或%A-Z是for语句中的迭代变量;(脚本的for命令处理的对象是文件集\目录集\或文本文件、命令输出的以行为基础的文本；</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>%0-9是批处理脚本的参数;</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>%~dI    仅将 %I 扩展到一个驱动器号</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>%~pI    仅将 %I 扩展到一个路径</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>echo %~dp0     显示当前批处理文件的路径；</td>
  </tr>
  <tr height="19">
    <td height="19">变量延迟</td>
    <td>使用变量时是用&amp;,当延迟变量时，用!代替&amp;;</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>!是%的一个强化版,在for循环中,当一个变量被多次赋值时,%dd%所获取的仅仅是dd第一次被赋予的值,想要刷新dd的值,就必须首先使用命令setlocal    enabledelayedexpansion来开启延时变量开关,然后用!dd!来获取dd的值;</td>
  </tr>
</table>



字符串的处理:截取\替换\合并\扩充 <br />
字符串的扩充是对表示文件路径的字符串进行特殊的处理;不是所有的%I都可以进行扩充的,需具备以下两个条件:<br />
1 该字符串代表一个文件的路径;<br />
2 变量要用%x来表示,x可取a-z,A-Z,0-9;<br />
%a-z或%A-Z是for语句中的迭代变量;(脚本的for命令处理的对象是文件集\目录集\或文本文件、命令输出的以行为基础的文本； <br />
%0-9是批处理脚本的参数;
<table cellspacing="0" cellpadding="0">
  <col width="94" />
  <col width="742" />
  <tr height="19">
    <td height="19" colspan="2" width="836">将指定的变量%I进行扩展(~,为扩展符号，它与不同的字母结合所代表的含义不同)</td>
  </tr>
  <tr height="19">
    <td height="19">%0</td>
    <td>代表批处理文件自身</td>
  </tr>
  <tr height="19">
    <td height="19">%~I</td>
    <td> 删除任何引号(&quot;)，扩展 %I</td>
  </tr>
  <tr height="19">
    <td height="19">%~fI   </td>
    <td> 将 %I 扩展到一个完全合格的路径名</td>
  </tr>
  <tr height="19">
    <td height="19">%~dI   </td>
    <td> 仅将 %I 扩展到一个驱动器号</td>
  </tr>
  <tr height="19">
    <td height="19">%~pI   </td>
    <td> 仅将 %I 扩展到一个路径</td>
  </tr>
  <tr height="19">
    <td height="19">%~nI   </td>
    <td> 仅将 %I 扩展到一个文件名</td>
  </tr>
  <tr height="19">
    <td height="19">%~xI   </td>
    <td> 仅将 %I 扩展到一个文件扩展名</td>
  </tr>
  <tr height="19">
    <td height="19">%~sI   </td>
    <td> 扩展的路径只含有短名</td>
  </tr>
  <tr height="19">
    <td height="19">%~aI   </td>
    <td> 将 %I 扩展到文件的文件属性</td>
  </tr>
  <tr height="19">
    <td height="19">%~tI   </td>
    <td> 将 %I 扩展到文件的日期/时间</td>
  </tr>
  <tr height="19">
    <td height="19">%~zI   </td>
    <td> 将 %I 扩展到文件的大小</td>
  </tr>
  <tr height="38">
    <td height="38">%~$PATH:I   </td>
    <td width="742"> 查找列在路径环境变量的目录，并将 %I    扩展到找到的第一个完全合格的名称。如果环境变量名未被定义，或者没有找到文件，此组合键会扩展到空字符串</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td width="742"></td>
  </tr>
  <tr height="19">
    <td height="19" colspan="2">可以组合修饰符来得到多重结果:</td>
  </tr>
  <tr height="19">
    <td height="19">%~dpI  </td>
    <td> 仅将 %I 扩展到一个驱动器号和路径</td>
  </tr>
  <tr height="19">
    <td height="19">%~nxI  </td>
    <td> 仅将 %I 扩展到一个文件名和扩展名</td>
  </tr>
  <tr height="19">
    <td height="19">%~fsI  </td>
    <td> 仅将 %I 扩展到一个带有短名的完整路径名</td>
  </tr>
  <tr height="19">
    <td height="19">%~dp$PATH:I </td>
    <td> 搜索列在路径环境变量的目录，并将 %I    扩展到找到的第一个驱动器号和路径。</td>
  </tr>
  <tr height="19">
    <td height="19">%~ftzaI</td>
    <td> 将 %I 扩展到类似输出线路的 DIR</td>
  </tr>
  <tr height="38">
    <td height="38"></td>
    <td width="742">在以上例子中，%I 和 PATH 可用其他有效数值代替。%~    语法用一个有效的 FOR 变量名终止。选取类似 %I 的大写变量名比较易读，而且避免与不分大小写的组合键混淆。</td>
  </tr>
  <tr height="19">
    <td height="19">echo %~dp0</td>
    <td width="742">显示当前批处理文件的路径；</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19">%%variable</td>
    <td>在批处理程序中使用 FOR 命令时，指定变量请使用 %%variable</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19" width="94">定义变量</td>
    <td>set extension=.rar</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td width="742">for /l %%n in    (0,1,9) do (</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td>set /a sum=0 rem定义一个数值型变量&quot;sum&quot;,并将其值设为“0”；</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td width="742">set [[/a    [expression]][/p [variable=]] string]</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19">变量引用</td>
    <td width="742">% and !</td>
  </tr>
</table>
<p>&nbsp;</p></div>
<p>&nbsp;</p>
<div class="container">

  <p>&nbsp;</p>
  <p>1 参数  参数变量：直接接收用户附于批处理程序后的字串，并将各字串自动代入相应的变量。 <br />
    %0-%9； %0代表批处理文件本身，此后顺推； <br />
    <br />
    2 环境变量  <br />
    path,homedrive,computername,errorlevel(追踪最近使用命令的退出代码）； <br />
    <br />
    2 变量赋值  <br />
    set varname=varvalue   <br />
    变量的表达式赋值： <br />
    set /a ver=100+1<br />
    set 自定义变量； <br />
    set 暂时修改预定义的环境变量； <br />
    setx 永久修改预定义的环境变量； <br />
    <br />
    3 与用户交互的变量 <br />
    set /p  varname=&quot;remark&quot; <br />
    <br />
    4 替换变量值    <br />
    %varname%:表示引用变量；   <br />
    <br />
    5 迭代变量  <br />
    %a-%z或%A-%Z；只存在于for循环的上下文件中，首先定义的是其初始值；    <br />
    <br />
    系统变量的检查：   <br />
    1 win+r %systemroot%<br />
    2 cmd   echo %computername% echo %username%<br />
    <br />
    errorlevel:可以追踪最近使用命令的退出代码。    <br />
    1 如果命令正常执行，则错误级别为0；   <br />
    2 如果命令执行过程中出错，则错误级别会被设置为一个适当的非0值；  <br />
    1代表通常的错误； <br />
    2 代表执行错误，意味着命令没有正确执行； <br />
    －2代表算数错误，比如创建了一个命令shell无法处理的过大的数值； <br />
    <br />
    变量的清除或释放： <br />
    set ver=    <br />
    <br />
    变量作用范围局部化 <br />
    1 定义的变量退出cmd时这些变量将不复存在； <br />
    2 可设置变量的作用范围局限在某个特定的区域；   <br />
    setlocal    
    </p>
    </p>
</div>
<a name="bottom" id="bottom"></a>
<DIV style="DISPLAY: none" id=goTopBtn>&and;</DIV>
<div id="shangy"><a href="javascript:void(null)" onclick="shangy()" target="_self">&uarr;</a></div>
<div id="xiay"><a href="javascript:void(null)" onclick="xiay()" target="_self">&darr;</a></div>
<div id="goBottom"><a href="#bottom" target="_self">&or;</a></div>
<SCRIPT type=text/javascript>goTopEx();</SCRIPT>
<script type="text/javascript">
function xiay(){
window.scrollBy(0,window.innerHeight);
}
function shangy(){
window.scrollBy(0,-window.innerHeight);
}
</script>
</body>
</html>
