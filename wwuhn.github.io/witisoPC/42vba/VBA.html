<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>VBA</title> <meta http-equiv="content-type" content="text/html; charset=utf-8">
</meta></head>

<style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
line-height:32px;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
  line-height: 1.2;
  padding: 5px 0;
  background-color:#eee;
  color:#000;
  font-size: 12px;
  text-align: center;
  position: fixed;
  _position: absolute;
 
  right: 10px;
  bottom: 100px;
  _bottom: "auto";
  cursor: pointer;
  opacity: .6;
  filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
  line-height: 1.2;
  padding: 5px 0;
  background-color: #eee;
  color: #fff;
  font-size: 12px;
  text-align: center;
  position: fixed;
  _position: absolute;
 
  right: 10px;
  bottom: 70px;
  _bottom: "auto";
  cursor: pointer;
  filter: Alpha(opacity=30);
	opacity=.3;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
 img{
 border:0;
 }#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	text-align:left;
	line-height:1.3em;
	table-layout:fixed;
}

#tbrowser th,#tbrowser td{
border:1px solid #ddd;
font-size:1em;
color:#000000;
text-align:left;
font-family: "宋体";
padding-left:3px;
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;
text-align:left;
/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/
text-align:left;
/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;
text-align:left;
/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;
text-align:left;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;
text-align:left;
line-height:18px;
font-size:16px;
color:#777;
}
.floatr{
float:right;
padding-right:5px;
}

#tbrowser th a:link {
	text-decoration: none;
	color:white;
}
#tbrowser th a:hover {
	text-decoration: none;
	color:white;
}
#tbrowser th a:active {
	text-decoration: none;
	color:white;
}
#tbrowser th a:visited {
	text-decoration: none;
	color:white;
}
#tbrowser caption{
font-size:1.2em;
text-align:left;
}
#tbrowser thead td{
font-size:0.8em;
text-align:left;
}div{
margin:auto;
width:74%;
border:0px blue solid;
}
p{
margin:0px;
text-indent:2em;
line-height:28px;
margin-top:8px;}
.data{
border:1px blue solid;

clear:both;
height:150px;
padding:2px;
margin-top:12px;

}
#tbrow{
border-collapse:collapse;
margin:auto;
width:88%;
}
#tbrow td{
border:0px solid blue;
}
.li{
list-style-type:decimal;
}
</style>


<body>

<div class="container">



<h3>VBA
<a href="实例/more.html">实例</a>
<a href="控制语句/more.html">控制语句实例</a>
<a href="vba使用SQL.html">vba使用SQL</a>
<a href="packingListVBAcode.html">packingListVBAcode</a>
</h3>


<table id="tbrowser">
<tr>
<td><a href="#a2">Overall</a></td>
<td><a href="#a4"></a></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</table>

<h4>总体思路：</h4>
<p>1 获取对象；</p>
<p>2 利用对象的属性和方法进行数据处理,利用事件实现自动化响应；</p>
<h4>Excel不能使用VBA</h4>
<p>1 卸载或更改程序→office→更改→添加或删除功能→office共享和工具；</p>
<p>2 允许运行宏→重启Excel;</p>

<h4>细节记录</h4>
<p>ThisWorkbook与ActiveWorkbook区别，前者是对代码所在工作簿的引用，后者是对活动工作簿的引用；</p>

<p>Worksheets(1).Activate和Worksheets(1).select的区别在于第一张表是否隐藏？Worksheets.Activate和Worksheets.select的区别在于是否可以选择多张表格？</p>
<p>Worksheets集合与sheets集合的区别在于前指普通工作表，而后者包括所有类型的工作表，如图表、excel 5.0对话框、excel 4.0宏表。</p>
<p>不是事件的事件</p>
<p> 1 Application对象的OnKey方法：此方法告诉Excel，当按下键盘上指定的键或组合键――自动执行指定的程序。</p>
<p>如：Application.OnKey "+e" "Hellow",是指当按下<shift+e>组合键时，运行Hello过程；ctrl:^,alt:%;使用此方法，实际就是给过程设置一个快捷键；与开发工具中的宏对话框中设置的快捷键中不同的是，此方法设置的快捷键在所有打开的工作簿中均有效；</p>
<p>2 Application对象的OnTime方法：是指在指定的时间自动执行指定的过程；</p>
<p>如：Application.OnTime TimeValue("12:00:00"),"Hello",是指在12点执行Hello过程；</p>
<p>每隔5分钟自动保存工作簿；<br>
sub Otime()<br>
Application.OnTime now() + TimeValue("00:05:00"), "WBSave"<br>
end sub<br>
Sub WBSave()<br>
ThisWorkbook.Save<br>
Call Otime<br>
end sub</p>
<h4>overall</h4>

<ol>
<li>如果需要实现应用程序的自动化，应用程序必须绑定自动化语言，Excel 5.0开始绑定，到Office 97开始，整个套装都有绑定VBA； </li>
<li>使用常量的好处：更好的阅读性，容易维护，不易出错；</li>
<li>变量声明的好处：减少内存占用，从而提高程序性能；也可以减少命名冲突，以及拼写错误的发生率；</li>
<li>变量赋值与对象赋值：对象赋值要用set;</li>
<li>End属性，当很难理解时可以写一段代码在Excel表中看运行的效果。</li>
<li>类模块：创建隐藏对象的代码窗口。</li>

<li>在Excel中，从Excel2007开始，包含宏代码的工作簿采用xlsm格式；</li>
<li>反复调用相同的代码：使用个人宏工作簿，其中的代码可以通过Alt+F8调用；</li>


<li>隐藏工作表:visible；</li>
<li>参数：传递给一个过程的常数、变量；过程的参数相当于一个软件的自定义选项，有了足够的自定义选项，软件才能适应工作中灵活多变的需求；</li>

<li>一句完整的代码必须有一个动作，如赋值，修改某个属性，打开或关闭对象，声明一个变量或调用一个过程；</li>

<li>常量：便于识别和简化输入;</li>
</ol>

<p>工作簿事件中的自动宏</p>
<p>在Excel2007中，可以使用工作簿级的“Workbook_Open”事件来执行自动宏。不过为了体现兼容性，微软并没有将Auto宏禁用，仍然可以继续使用，但绝不推荐用户继续使用。</p>
<p>Excel的事件可以手工启用和禁用。</p>
<p>在VBA中，通过Application对象的EnableEvents属性来控制，将EnableEvents属性设置为True即启用事件，设为False即为禁用事件。完整的代码如下：</p>
<p>Application.EnableEvents=TrueApplication.EnableEvents=False</p>
<p>通常在以下两种情况下需要禁用事件：1 临时关闭事件;2 防止事件进入死循环</p>
<p>&nbsp;</p>
<p>将较大的过程分为多个再调用</p>
<p>VBA允许一个过程存入上千条代码，然而一个过程太庞大不利于阅读和维护，特别是一个代码超过一屏时。此时需要将过程按作用分为多个子过程，再到主过程中调用。</p>
<p>&nbsp;</p>


</div>
</body>
</html>
