<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>VBAVBA对象的选择和引用</title> <meta http-equiv="content-type" content="text/html; charset=utf-8">
</meta></head>

<style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 100px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 70px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
 img{
 border:0;
 }#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	text-align:left;
	line-height:1.3em;
	table-layout:fixed;
}

#tbrowser th,#tbrowser td{
border:1px solid #ddd;
font-size:1em;
color:#000000;
text-align:left;
font-family: "宋体";
padding-left:3px;
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;
text-align:left;
/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/
text-align:left;
/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;
text-align:left;
/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;
text-align:left;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;
text-align:left;
line-height:18px;
font-size:16px;
color:#777;
}
.floatr{
float:right;
padding-right:5px;
}

#tbrowser th a:link {
	text-decoration: none;
	color:white;
}
#tbrowser th a:hover {
	text-decoration: none;
	color:white;
}
#tbrowser th a:active {
	text-decoration: none;
	color:white;
}
#tbrowser th a:visited {
	text-decoration: none;
	color:white;
}
#tbrowser caption{
font-size:1.2em;
text-align:left;
}
#tbrowser thead td{
font-size:0.8em;
text-align:left;
}div{
margin:auto;
width:74%;
border:0px blue solid;
}
p{
margin:0px;
text-indent:2em;
line-height:28px;
margin-top:8px;}
.data{
border:1px blue solid;

clear:both;
height:150px;
padding:2px;
margin-top:12px;

}
#tbrow{
border-collapse:collapse;
margin:auto;
width:88%;
}
#tbrow td{
border:0px solid blue;
}
.li{
list-style-type:decimal;
}
</style>


<body>

<div class="container">



<h3>对象引用</h3>
<ol>
<li>对象的层次与引用方式
<ol>
<li>对象的逐层引用</li>
<li>使用对象名称引用对象：Workbooks("财务表.xls")</li>
<li>使用复数形式表示对象集合：</li>
<li>使用序号参数引用集合中的子对象:Worksheets(1)</li>
<li>引用子对象：Workbooks("生产表.xls").Worksheets("1月")</li>
<li>引用活动对象：ActiveWorkbook.Worksheets("总表");VBA专门给活动对象赋予了一个特别的称谓，通常使用“Active”表示活动对象；ActiveWindow,ActiveWorkbook,ActiveSheet,ActiveCell,ActiveChart,当调用活动对象的子对象时，可以忽略活动对象名称，直接引用其子对象；</li>
<li>引用父对象：Range("a1").Parent.Name(用于获取工作表的名称)</li>


<li>利用with语句引用重复出现的对象；</li>
</ol>
</li>


<li>
Range对象
<ol>
<li>Range("A1")引用方式
<ol>

<li>引用单元格：Range("a1");Range("B"&i+5);</li>
<li>引用行与列：Range("B:B");Range("B:Z");Range("2:2");Range("2:5");Columns(1);Rows(2);</li>
<li>引用区域：Range("a1:c5");</li>
<li>引用多区域：Range("C4:C11,E4:E11);</li>
</ol>
</li>

<li>Cells(1,1)引用方式;</li>
<li>[a1]引用方式；</li>
<li>活动单元格：ActiveCell</li>
<li>下一个单元格：Next</li>
<li>屏幕坐标下的单元格：Window.RangeFromPoint</li>
<li>选区：Application.Selection、Window.RangeSelection</li>
<li>已用区域：Worksheet.UsedRange</li>
<li>当前区域：Range().CurrentRegion是指以包含当前单元格且以空行与空列的组合为边界的区域；</li>
<li>当前数组区域；</li>
<li>按条件引用区域：Range.SpecialCells(Type,Value)是指定位条件符合的单元格；如：<br />
ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants,7).Select
<li>模拟Ctrl+方向键产生的单元格:Range.End(Direction)
<ol>
<li>参数，常量，说明</li>
<li>xlToLeft,1,向左</li>
<li>xlToRight ,2,向右</li>
<li>xlUp,3,向上</li>
<li>xlDown,4,向下</li>
</ol>
</li>




<li>
按偏移量重置区域引用：Range.Offset(RowOffset,ColumnOffset)
<ol>
<li>Range("f6").offset(-3,-2)</li>
<li>Offset参数更多的是使用变量；</li>
<li>常配合End属性使用，如合并工作簿或工作表时，将所有工作表的数据复制到汇总表中，要求按先后顺序排列，不能覆盖上一次合并的内容，此时需要定位非空行的下一行，然后再粘贴数据，而此需求需要将End配合Offset使用。</li>
<li>Worksheets("二月").usedRange.Copy Worksheets("总表").Cells(Rows.Count,1).End(xlUp).Offset(1,0)</li>
</ol>
</li>




<li>
按宽度与高度重置区域：Range.Resize;Range("B2").Resize(2,3)</li>

<li>
引用多区域的合集：Union(Range("A1:B10"), Range("c1:c10"));</li>

<li>
引用多区域的交集：Intersect(Range("A1:B10"), Range("c1:c10"));</li>
<li>利用名称引用区域:ActiveWorkbook.Names.Add "成绩", "=$A$2:$A$10", Ture</li>
</ol>
<li>图形对象Shapes、DrawingObjects</li>
<li>表对象Sheets
<ol>
<li>xlChart</li>
<li>xlDialogSheet</li>
<li>xlWorksheet</li>
</ol>
</li>


<li>Selection对象：表示对操作区域的操作，可以用With语句，如<br />
  With Selection.Font <br />
&nbsp;&nbsp;.Size=22<br />
&nbsp;&nbsp;.ColorIndex = 6<br />
End With</li>
</ol>






<h3>Range对象和Worksheet对象都有Select（选定）和Activate（激活）方法。其区别和联系如下：</h3>
<p>一、从功能上来说，Select代表选定对象，Activate代表激活对象。</p>
<p>二、从数量上来说，Select可以选定多个对象，Activate只能激活一个对象。</p>
<p>三、对于单个对象，Select和Activate是一样的。</p>
<p>四、Activate的对象必定在Select对象之中。当选定了多个对象时，其中某个对象必定是激活的对象。在已经Select的对象中，可以任意指定Activate的对象。如果Activate了当前Select对象之外的对象，则相当于重新执行了一次Select并激活。</p>
<p>五、在每次重新Select之后，则系统会自动Activate其中的某个对象。</p>
<p>&nbsp;</p>
<p>select,selection</p>
<p>Activate,activecell</p>
<p>activecell.CurrentRegion.Select</p>
<p>&nbsp;</p>
<h4>单元格区域的端点选择（B5:G17）</h4>
<p>1 选取B列第一个非空单元格 </p>
<p>If Range(&quot;B1&quot;) = &quot;&quot; Then</p>
<p>&nbsp;&nbsp;Range(&quot;B1&quot;).End(xlDown).Selcet</p>
<p>Else</p>
<p>&nbsp;&nbsp;Range(&quot;B1&quot;).Selcet</p>
<p>End if </p>
<p>&nbsp;</p>
<p>2 选取B列最后一个非空单元格</p>
<p>Range(&quot;B65536&quot;.End(xlUp).Select</p>
<p>&nbsp;</p>
<p>3 选取11列最左边非空单元格</p>
<p>If Range(&quot;A11&quot;) = &quot;&quot; Then</p>
<p>&nbsp;&nbsp;Range(&quot;A11&quot;).End(xlToRight).Selcet</p>
<p>Else</p>
<p>&nbsp;&nbsp;Range(&quot;A11&quot;).Selcet</p>
<p>End if </p>
<p>&nbsp;</p>
<p>4 选取第17行最右边非空单元格</p>
<p>Range(&quot;IV17&quot;).End(xlToLeft).Select</p>
<p>&nbsp;</p>
<p>(end()方法单元格的选取，从空到非空，从非空到空；）</p>
<h4>已选取单元格区域范围和大小（B5:D14）</h4>
<p>1 返回选取区域的总行数和总列数</p>
<p>Selection.Rows.count</p>
<p>Selection.Columns.count</p>
<p>&nbsp;</p>
<p>2 返回选取区域的第一行的行号</p>
<p>Selection.Row </p>
<p>&nbsp;</p>
<p>3 返回选取区域左上角的单元格</p>
<p>Selection.Range(&quot;A1&quot;).Address</p>
<p>&nbsp;</p>
<p>4 返回选取区域右上角的单元格</p>
<p>Cells(Selection.Row,Selection.Column+Selection.Columns.Count-1).Address</p>
<p>&nbsp;</p>
<p>5 返回选取区域左下角的单元格</p>
<p>Cells(Selection.Row+Selection.Row.Count-1,Selection.Column).Address</p>
<p>&nbsp;</p>
<p>5 返回选取区域右下角的单元格</p>
<p>Selection.Cells(Selection.Cells.count).Address</p>
<p>&nbsp;</p>
<h4>选取全部单元格的方法</h4>
<p>1 Cells.select</p>
<p>2 Rows.select</p>
<p>3 Columns.select</p>
<p>&nbsp;</p>
<h4>选择特定单元格</h4>
<p>1 选取当前已使用的单元格：ActiveSheet.UsedRange.Select</p>
<p>2 选取的指定单元格相邻的区域：Range(&quot;address&quot;).CurrentRegion.Select</p>
<p>3 选取特定内容单元格：Range(&quot;address&quot;).SpecialCells(单元格类型变量)</p>
<p>&nbsp;</p>
<h4>移动和改变单元格选取范围</h4>
<p>Offset(A1,2,1,6,3)，表示，以A1为参照点，偏移(2,1),选取6行3列；</p>
<p>Range(&quot;A1&quot;).Offset(2,1).Resize(6,3).Select</p>
<h4>其它</h4>
<p>选择某一列的全部空行</p>
<p>Columns(1).specialCells(xlCellTypeBlanks).EntireRow</p>
<p>&nbsp;</p>

<p>利用定义名称获取对象</p>
<p>Sheets(1).Shapes(&quot;按钮 2&quot;).Width = Sheets(1).Shapes(&quot;按钮 1&quot;).Width * 2</p>
<p>利用集合中的索引号来调用对象。</p>
<p>Sheets(1).Shapes(i).Width = 100</p>
<p>前面的对象引用方式可以确保总能正确的引用对象，然而却是牺牲效率来实现的。当所引用的对象是当前活动对象时VBA提供了简化的引用方式。</p>
<p>在引用活动对象时是不需要罗列其上层对象的，而是直接使用“ActiveCell”或者“ActiveWorkbook”等等。</p>
<p>在写法上较后者更简洁，而且在执行效率上也有大大的优势。</p>
<p>With语句的功能是代码减肥，且加快快程序执行速度。不过它的前提条件是同一对象需要多次引用时。</p>

<p>如果在工作表事件中使用Me，则它代表当前工作表；如果在工作簿事件中使用Me，则它代表工作簿；如果在窗体中使用Me，则它代表窗体对象。</p>

<p>Range(&quot;ZZ1048576&quot;)――表示ZZ1048576单元格，在Excel 2003中是无效的引用，因为Excel 2003的最大行不超过65536行，最大列不超过IV列</p>

<h4>SpecialCells：按条件引用区域</h4>
<p>Range对象的SpecialCells方法可以返回一代表与指定类型和值匹配的区域。它的具体参数为：</p>
<p>表达式.SpecialCells(Type,Value)其中“表达式”表示单元格对象，“Type”参数表未单元格类型，“Value”参数是可选参数，只在“Type”参数为xlCellTypeConstants或xlCellTypeFormulas时用，用于确定结果中应包含哪几类单元格。</p>
<p>&nbsp;</p>
<p>Resize用于调整指定区域的大小，返回代表调整后的区域。它有具体语法为：Range.Resize(RowSize,ColumnSize)</p>
<p>其中参RowSize代表重置后的行数，ColumnSize代表重置后的列数。两个参数皆为可选参数，</p>
<p>&nbsp;</p>
<p>Range对象的Offset属性可以返回一个Range对象，代表位于指定单元格区域的一定的偏移量位置上的区域。其具体语法如下：</p>
<p>Range.Offset(RowOffset,ColumnOffset)</p>
<p>&nbsp;</p>
<p>Union：单元格的合集</p>
<p>单元格合集即将多个单元格或者区域并为一个区域。</p>
<p>在工作中，需要用到合集的地方较多，特别在查找目标单元格时。引用区域集合可用Application对象的Union方法，其具体语法为：</p>
<p>Intersect：单元格、区域的交集</p>
<p>交集是指两个或者是多个区域的重叠部分。</p>
<p>&nbsp;</p>
<p>End：引用源区域的区域尾端的单元格</p>
<p>如果活动单元格在一个较大的数据区域中间，按下快捷键【Ctrl+上箭头】、【Ctrl+下箭头】、【Ctrl+左箭头】、【Ctrl+右箭头】可以迅速将当前单元格移至已用区域的边缘；如果整个工作表均为空白则可以在最小行、最小列或者最大行、最大列之间切换；如果在空白区向数区域使用同方向的快捷键，则可以定位于该行（列）的第一个或者最后一个非空单元格。</p>
<p>Range对象的End属性正好对应于以上四个快捷键，可以实现最上端、最下端、最左端和最右端的切换。它的具体语法为：</p>
<p>Range.End(Direction)</p>
</div>
</body>
</html>
