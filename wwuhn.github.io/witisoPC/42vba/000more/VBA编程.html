<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<script type="text/javascript">
var userAgent = navigator.userAgent.toLowerCase();
var browser = 
	(browser = userAgent.match(/qqbrowser\/([\d.]+)/))?"qqbrowser/"+browser[1]:
	(browser = userAgent.match(/se\s+2.x/))?"sogou/2.x": //sougou
	(browser = userAgent.match(/msie\s+([\d.]+)/))?"msie/"+browser[1]: //ie
	(browser = userAgent.match(/chrome\/([\d.]+)/))?"chrome/"+browser[1]: //chrome
	(browser = userAgent.match(/firefox\/([\d.]+)/))?"firefox/"+browser[1]: //firefox
	(browser = userAgent.match(/version\/([\d.]+)\s+safari\/([\d.]+)/))?"safari/"+browser[1]: //safari
	(browser = userAgent.match(/opera\/([\d.]+)([\w\W]+)version\/([\d.]+)/))?"opera/"+browser[3]: //opera
	"other browser";
	var browser4 = browser.substr(0,2);
//实现回到页面顶部  
function goTopEx(){  
	var obj=document.getElementById("goTopBtn"); 
	var obj2=document.getElementById("shangy"); 
	var obj3=document.getElementById("xiay");
	var obj4=document.getElementById("goBottom");  
	
	function getScrollTop(){  
		if(browser4=="ch"){
			//chrome
			//chrome63.0.3239.132对DTD XHTML 1.0不再支持body.scrollTop属性，只支持documentElement.scrollTop 
			return document.documentElement.scrollTop; 
		}else{
			//IE、firefox
			return document.documentElement.scrollTop;  
		}  
	}
	function setScrollTop(value){ 
		if(browser4=="ch"){ 
			//chrome
			document.documentElement.scrollTop=value; 
		}else{  
			//IE、firefox
			document.documentElement.scrollTop=value;  
		} 
	}     
	window.onscroll=function(){getScrollTop()>50?obj.style.display="":obj.style.display="none";
	getScrollTop()>100?obj2.style.display="":obj2.style.display="none";
	document.body.clientHeight-getScrollTop()>650?obj3.style.display="":obj3.style.display="none";
	document.body.clientHeight-getScrollTop()>650?obj4.style.display="":obj4.style.display="none";
	}  
	obj.onclick=function(){  
		var goTop=setInterval(scrollMove,10);  
		function scrollMove(){  
				setScrollTop(getScrollTop()/1.1);  
				if(getScrollTop()<1)clearInterval(goTop);  
		}  
	}  
}  
function downn(){
	if(browser4=="ch"){
		//chrome
		window.scrollBy(0,document.body.clientHeight);
	}else{
		//IE、firefox
		window.scrollBy(0,document.documentElement.clientHeight*1000); 
	}
}
</script>
<script>
function changePage(){ 
	var page = document.getElementById("container");
	page.style.background="black";
	page.style.color="white";
	page.style.fontSize="22px";
	page.style.fontFamily="MV boli";
}
document.write('<div style="position:fixed; right: 10px; top:20px; color:#eee;">背景颜色<br><select name=bcolor id=bcolor onchange="javascript:document.body.style.background=this.options[this.selectedIndex].value;"><option style="background-color: #ffffff" value="#ffffff">白色</option><option style="background-color: #f6f6f6" value="#f6f6f6">银灰</option><option style="background-color: #e4ebf1" value="#e4ebf1">淡蓝</option><option style="background-color: #e6f3ff" value="#e6f3ff">蓝色</option> <option style="background-color: #eeeeee" value="#eeeeee">淡灰</option><option style="background-color: #eaeaea" value="#eaeaea">灰色</option>  <option style="background-color: #e4e1d8" value="#e4e1d8">深灰</option><option style="background-color: #e6e6e6" value="#e6e6e6">暗灰</option><option style="background-color: #eefaee" value="#eefaee">绿色</option><option style="background-color: #ffffed" value="#ffffed">明黄</option><option style="background-color: #333333" value="#333333">黑色</option></select><br>字体颜色<br><select name=txtcolor id=txtcolor onchange="javascript:document.getElementById(\'container\').style.color=this.options[this.selectedIndex].value;"> <option value="#000000">黑色</option><option value="#ff0000" style="color:red;">红色</option><option value="#006600" style="color:green;">绿色</option><option value="#0000ff" style="color:blue;">蓝色</option><option value="#660000" style="color:#006600;">棕色</option><option value="#ffffff">白色</option></select><br>字体大小<br><select name=fontsize id=fonttype onchange="javascript:document.getElementById(\'container\').style.fontSize=this.options[this.selectedIndex].value;"> <option value="12px" >小号</option> <option value="14px" >较小</option> <option value="19px" >中号</option> <option value="19px" >默认</option><option value="22px" >较大</option><option value="25px" >大号</option><option value="35px" >35px</option><option value="45px" >45px</option><option value="55px" >55px</option><option value="65px" >65px</option><option value="75px" >75px</option><option value="85px" >85px</option><option value="95px" >95px</option></select>><br>字体类型<br><select name=fonttype id=fonttype onchange="javascript:document.getElementById(\'container\').style.fontFamily=this.options[this.selectedIndex].value;"> <option value="宋体" >宋体</option> <option value="MV boli" style="font-family:MV boli">MV boli</option> <option value="隶书" style="font-family:隶书">隶书</option> <option value="黑体" style="font-family:黑体">黑体</option><option value="楷体" style="font-family:楷体">楷体</option><option value="幼圆" style="font-family:幼圆">幼圆</option><option value="华文中宋" style="font-family:华文中宋">华文中宋</option><option value="华文行楷" style="font-family:华文行楷">华文行楷</option><option value="微软雅黑" style="font-family:微软雅黑">微软雅黑</option><option value="Arial" style="font-family:Arial">Arial</option><option value="Vrinda" style="font-family:Vrinda">Vrinda</option><option value="Tahoma" style="font-family:Tahoma">Tahoma</option><option value="Courier" style="font-family:Courier">Courier</option><option value="Times" style="font-family:Times">Times</option><option value="Georgia" style="font-family:Georgia">Georgia</option><option value="Lucida" style="font-family:Lucida">Lucida</option></select><br><a onClick="changePage()" target="_self" id="changepage">黑底白字</a></div>');   
</script>
<style type="text/css">
#tbrowser a:linked container a:visited{
	font-size:18px;
	text-decoration:none;
}
a:link{
	text-decoration:none;
	}
#container{
	font-size:1.2em;
	margin:auto;
	font-family:"宋体";
	width:65.29%;
	line-height:1.6em;
}
P{
	margin-top:16px;
	margin-bottom:16px;
	text-indent:2em;
}
.uls{
	color:#CC6666;
	font-weight:bold;
}
.uls>ol{
	list-style:none;
	font-weight:normal;
	list-style:lower-latin;
	color:#000000;
	line-height:1.3em;
}
h3{
	font-size:1.1em;
	font-weight:bold;
	text-indent:0em;
	color:#990000;
}
h4{
	font-size:1.0em;
	font-weight:bold;
	text-indent:0em;
}

#goTopBtn, #goBottom, #shangy, #xiay, #ftsize1, #ftsize2, #ftsize3{
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    font-size: 12px;
    text-align: center;
    position: fixed;
	right: 10px;
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
	font-weight:bold;
}
#goTopBtn, #goBottom, #ftsize1, #ftsize3  {
    background-color:#999;
    color:#000;
}
#shangy, #xiay, #ftsize2{
    background-color: #bbb;
    color: #000;
}
#ftsize1{
	bottom:240px;
}
#ftsize2{
	bottom:214px;
}
#ftsize3{
	bottom:188px;
}

#goTopBtn{
    bottom: 105px;
}
#goBottom {
    bottom: 30px;
}
#shangy {
    bottom: 80px;
}
#xiay {
    bottom: 55px;
}
#goTopBtn:hover, #goBottom:hover, #shangy:hover, #xiay:hover, #ftsize1:hover, #ftsize2:hover, #ftsize3:hover{
	background-color:#ccc;
	border:#ccc 0px solid;
}
#goTopBtn a:link, #goBottom a:link, #xiay a:link, #shangy a:link, #ftsize1 a:link, #ftsize2 a:link, #ftsize3 a:link {
	text-decoration: none;
	color:white;
}
img{
	margin-right:2em;
	text-indent:2em;
	border:0;
}
.picsay{
	color:#930;
	font-size:90%;
	line-height:110%;
	margin-top:-12px;
	padding:0;
}
.remark{
	color:#930;
	font-size:90%;
	line-height:140%;
	margin-top:-12px;
	text-indent:0em;
	padding:0;
}
.ref{
	color:#930;
	font-size:95%;
	line-height:150%;
	margin-top:-12px;
	text-indent:2em;
	padding:0;
}
pre{
	font-size:120%;
	line-height:130%;
	padding:0;
	//background-color:#f6f6f6;
	//background-color:#fff5ee;
	//background-color:#ffe;
	background-color:#eee;
	padding:8px;
	}
.code0, .code2, .code4{
	font-size:95%;
	line-height:110%;
	margin-top:-12px;
	padding:0;
	//background-color:#D9D1CA;
	//background-color:#f6f6f6;
	//background-color:#fff5ee;
	background-color:#ffe;
}
.code0{
	color:red;
	text-indent:0em;
}
.code2{
	color:#930;
	text-indent:2em;
}
.code4{
	color:blue;
	text-indent:4em;
}
sub,sup{
	font-size:80%;
	color:red;
}
</style>
</head>

<body>

<div id="container">





<h3>VBA编程</h3>

<p>
</p>

<p>本章内容
</p>

<p>◆ VBA编程基础
</p>

<p>◆ 创建和设计VBA程序
</p>

<p>◆ VBA程序调试与运行
</p>

<p>一、VBA编程基础知识
</p>

<p>在执行简单的操作时，宏可以完成，如窗体的打开与关闭、工具栏的显示和隐藏等。对于稍复杂一些的任务，则可用Visual Basic for Application进行编程完成。
</p>

<p>1．VBA的数据类型
</p>

<p>下面对VBA中的数据类型、数据类型之间的转换、数据类型的对比进行介绍。
</p>

<p>⑴ 数据类型
</p>

<p>下表列出VBA中的基本数据类型。
</p>

<p>类型名声明符字节
</p>

<p>————————————————
</p>

<p>Byte（单字节型）           1
</p>

<p>Integer（整型）     %      2
</p>

<p>Long（长整型）      &      4
</p>

<p>Single（单精度型）  !      4
</p>

<p>Double（双精度型）  #      8
</p>

<p>Currency（货币型）  @      8
</p>

<p>String（字符型）    $     n*1
</p>

<p>Boolean（布尔型）          2
</p>

<p>Date（日期型）             8
</p>

<p>Variant（变体型）          x
</p>

<p>Object（对象型）           4
</p>

<p>————————————————
</p>

<p>其中，字节、整型、长整型、单精度、双精度、货币等数据类型都属于数值数据类型，可以进行各种数学运算。字符型数据类型用来声明字符串。布尔型数据类型用来表示一个逻辑值，为真时显示True，为假时显示Flase。日期型数据类型用来表示日期，日期常量必须用#括起来，如#2001/3/26#。变体型数据类型可以存放系统定义的任何数据类型，如数值、字符串、布尔及日期等，其数据类型由最近放入的值决定。
</p>

<p>用户可以使用Type语句定义任何数据类型。用户自定义数据类型可以包括数据类型数组，或当前定义的用户自定义类型的一种或多种元素。
</p>

<p>语法：
</p>

<p>[ Private | Public ] Type 类型名
</p>

<p>元素名 As 数据类型
</p>

<p>[ 元素名 As 数据类型 ]
</p>

<p>……
</p>

<p>End Type
</p>

<p>例如：定义班级中学生的基本情况数据类型如下：
</p>

<p>Public Type Students
</p>

<p>Name As String(8)
</p>

<p>Age  As Integer
</p>

<p>End Type
</p>

<p>声明变量：
</p>

<p>Dim Student As Students
</p>

<p>引用数据：
</p>

<p>Student.Name=”张三”
</p>

<p>Student.Age=15
</p>

<p>下面是详细参考内容
</p>

<p>◆ Boolean 数据类型
</p>

<p>Boolean 变量存储为 16 位（2 个字节）的数值形式，但只能是 True 或是 False。Boolean 变量的值显示为 True 或 False（在使用 Print 的时候），或者 #TRUE# 或 #FALSE#（在使用 Write # 的时候）。使用关键字 True 与 False 可将 Boolean 变量赋值为这两个状态中的一个。
</p>

<p>当转换其他的数值类型为 Boolean 值时，0 会转成 False，而其他的值则变成 True。当转换 Boolean 值为其他的数据类型时，False 成为 0，而 True 成为 -1。
</p>

<p>◆ Byte 数据类型
</p>

<p>Byte 变量存储为单精度型、无符号整型、8 位（1个字节）的数值形式，范围在 0 至 255 之间。
</p>

<p>Byte 数据类型在存储二进制数据时很有用。
</p>

<p>◆ Currency 数据类型
</p>

<p>Currency 变量存储为 64 位（8 个字节）整型的数值形式，然后除以 10,000 给出一个定点数，其小数点左边有 15 位数字，右边有 4 位数字。这种表示法的范围可以从 -922,337,203,685,477.5808 到 922,337,203,685,477.5807。Currency 的类型声明字符为at号 (@)。
</p>

<p>Currency 数据类型在货币计算与定点计算中很有用，在这种场合精度特别重要。
</p>

<p>◆ Date 数据类型
</p>

<p>Date 变量存储为 IEEE 64 位（8 个字节）浮点数值形式，其可以表示的日期范围从 100 年 1 月 1 日到 9999 年 12 月 31 日，而时间可以从 0:00:00 到 23:59:59。任何可辨认的文本日期都可以赋值给 Date 变量。日期文字须以数字符号 (#) 扩起来，例如，#January 1, 1993# 或 #1 Jan 93#。
</p>

<p>Date 变量会根据计算机中的短日期格式来显示。时间则根据计算机的时间格式（12 或 24 小时制）来显示。
</p>

<p>当其他的数值类型要转换为 Date 型时，小数点左边的值表示日期信息，而小数点右边的值则表示时间。午夜为 0 而中午为 0.5。负整数表示 1899 年 12 月 30 日之前的日期。
</p>

<p>◆ Decimal 数据类型
</p>

<p>Decimal 变量存储为 96 位（12 个字节）带符号的整型形式，并除以一个 10 的幂数。这个变比因子决定了小数点右面的数字位数，其范围从 0 到 28。变比因子为 0（没有小数位）的情形下，最大的可能值为 +/-79,228,162,514,264,337,593,543,950,335。而在有 28 个小数位的情况下，最大值为 +/-7.9228162514264337593543950335，而最小的非零值为 +/-0.0000000000000000000000000001。
</p>

<p>注意此时，Decimal 数据类型只能在 Variant中使用，也就是说，不能声明一变量为 Decimal 的类型。不过可用 Cdec 函数，创建一个子类型为 Decimal 的 Variant。
</p>

<p>◆ Double 数据类型
</p>

<p>Double（双精度浮点型）变量存储为 IEEE 64 位（8 个字节）浮点数值的形式，它的范围在负数的时候是从 -1.79769313486231E308 到 -4.94065645841247E-324，而正数的时候是从 4.94065645841247E-324 到 1.79769313486232E308。Double 的类型声明字符是数字符号 (#)。
</p>

<p>◆ Integer 数据类型
</p>

<p>Integer 变量存储为 16位（2 个字节）的数值形式，其范围为 -32,768 到 32,767 之间。Integer 的类型声明字符是百分比符号 (%)。
</p>

<p>也可以用 Integer 变量来表示枚举值。枚举值可包含一个有限集合，该集合包含的元素都是唯一的整数，每一个整数都在它使用时的上下文当中有其特殊意义。枚举值为在已知数量的选项中做出选择提供了一种方便的方法，例如，black = 0，white = 1 等等。较好的编程作法是使用 Const 语句将每个枚举值定义成常数。
</p>

<p>◆ Long 数据类型
</p>

<p>Long（长整型）变量存储为 32 位（4 个字节）有符号的数值形式，其范围从 -2,147,483,648 到 2,147,483,647。Long 的类型声明字符为和号 (&)。
</p>

<p>◆ Object 数据类型
</p>

<p>Object 变量存储为 32 位（4 个字节）的地址形式，其为对象的引用。利用 Set 语句，声明为 Object 的变量可以赋值为任何对象的引用。
</p>

<p>注意虽然以 Object 类型声明的变量足以适应包含对各种对象的引用，但是绑定到变量引用的对象总是在晚期（运行时）绑定。要强迫在早期（编译时间）绑定的话，须将对象的引用赋值给用特定类名称声明的变量。
</p>

<p>◆ Single 数据类型
</p>

<p>Single（单精度浮点型）变量存储为 IEEE 32 位（4 个字节）浮点数值的形式，它的范围在负数的时候是从 -3.402823E38 到 -1.401298E-45，而在正数的时候是从 1.401298E-45 到 3.402823E38。Single 的类型声明字符为感叹号 (!)。
</p>

<p>◆ String 数据类型
</p>

<p>字符串有两种：变长与定长的字符串。
</p>

<p>变长字符串最多可包含大约 20 亿 ( 2^31)个字符。
</p>

<p>定长字符串可包含 1 到大约 64K ( 2^16 ) 个字符。
</p>

<p>注意 Public 定长字符串不能在类模块中使用。
</p>

<p>String 之字符码的范围是 0 到 255。字符集的前 128 个字符（0 到 127）对应于标准的 U.S. 键盘上的字符与符号。这前 128 个字符与 ASCII 字符集中所定义的相同。后 128 个字符（128 到 255）则代表特殊字符，例如国际字符，重音符号，货币符号及分数。String 的类型声明字符为美元号 ($)。
</p>

<p>◆ 用户定义数据类型
</p>

<p>可以是任何用 Type 语句定义的数据类型。用户自定义类型可包含一个或多个某种数据类型的数据元素、数组或一个先前定义的用户自定义类型。例如：
</p>

<p>Type MyType
</p>

<p>MyName As String        '定义字符串变量存储一个名字。
</p>

<p>MyBirthDate As Date     '定义日期变量存储一个生日。
</p>

<p>MySex As Integer        '定义整型变量存储性别
</p>

<p>End Type                    '（0 为女，1 为男）
</p>

<p>◆ Variant 数据类型
</p>

<p>Variant 数据类型是所有没被显式声明（用如 Dim、Private、Public 或 Static等语句）为其他类型变量的数据类型。Variant 数据类型并没有类型声明字符。
</p>

<p>Variant 是一种特殊的数据类型，除了定长 String 数据及用户定义类型外，可以包含任何种类的数据。Variant 也可以包含 Empty、Error、Nothing 及 Null等特殊值。可以用 VarType 函数或 TypeName 函数来决定如何处理 Variant 中的数据。
</p>

<p>数值数据可以是任何整型或实型数，负数时范围从-1.797693134862315E308 到 -4.94066E-324，正数时则从 4.94066E-324 到 1.797693134862315E308。通常，数值 Variant 数据保持为其 Variant 中原来的数据类型。例如，如果把一个 Integer赋值给 Variant，则接下来的运算会把此 Variant 当成 Integer 来处理。然而，如果算术运数针对含 Byte、Integer、Long 或 Single 之一的Variant 执行，并当结果超过原来数据类型的正常范围时，则在 Variant 中的结果会提升到较大的数据类型。如 Byte 则提升到 Integer，Integer 则提升到 Long，而 Long和Single 则提升为 Double。当 Variant 变量中有 Currency、Decimal 及 Double 值超过它们各自的范围时，会发生错误。
</p>

<p>可以用 Variant 数据类型来替换任何数据类型，这样会更有适应性。如果 Variant 变量的内容是数字，它可以用字符串来表示数字或是用它实际的值来表示，这将由上下文来决定，例如：
</p>

<p>Dim MyVar As Variant
</p>

<p>MyVar = 98052
</p>

<p>在前面的例子中，MyVar 内有一实际值为 98052 的数值。像期望的那样，算术运算子可以对 Variant 变量运算，其中包含数值或能被解释为数值的字符串数据。如果用 + 运算子来将 MyVar 与其他含有数字的 Variant 或数值类型的变量相加，结果便是一算术和。
</p>

<p>Empty 值用来标记尚未初始化（给定初始值）的 Variant 变量。内含 Empty 的 Variant 在数值的上下文中表示 0，如果是用在字符串的上下文中则表示零长度的字符串 ("")。
</p>

<p>不应将 Empty 与 Null 弄混。Null 是表示 Variant 变量确实含有一个无效数据。
</p>

<p>在 Variant 中，Error 是用来指示在过程中出现错误时的特殊值。然而，不像对其他种类的错误那样，程序并不产生普通的应用程序级的错误处理。这可以让程序员，或应用程序本身，根据此错误值采取另外的行动。可以用 CVErr 函数将实数转换为错误值来产生 Error 值。
</p>

<p>⑵ 数据类型之间的转换
</p>

<p>在进行VBA编程过程中，用户可以将一种数据类型的数据转换成另一种特定类型的数据。如：
</p>

<p>A=Cstr(2000)，则将数值转换为字符型数据。下面列出这些转换函数：
</p>

<p>函数名目标类型
</p>

<p>——————————
</p>

<p>Cbyte       Byte
</p>

<p>Cint        Integer
</p>

<p>Clng        Long
</p>

<p>Csng        Single
</p>

<p>Cdbl        Double
</p>

<p>Ccur        Currency
</p>

<p>Cdate       Date
</p>

<p>Cvar        Varriant
</p>

<p>——————————
</p>

<p>⑶ 数据类型的对比
</p>

<p>在Access中，有4种不同的编辑环境需要用户指定数据类型——表设计视图、查询参数、VBA代码、SQL查询视图。下表列出数据类型与VBA数据类型对比。
</p>

<p>字段数据类型                    VBA数据类型
</p>

<p>——————————————————————
</p>

<p>Yes/No                              Boolean
</p>

<p>Number(Byte)                        Byte
</p>

<p>AutoNumber(Long Integer)            Long
</p>

<p>Currency                            Currency
</p>

<p>Date/Time                           Date
</p>

<p>Number(Double)                      Double
</p>

<p>OLE Object                          String
</p>

<p>AutoNumber/GVI（同步复制ID）        不支持
</p>

<p>Memro                               string
</p>

<p>Number(Single)                      Single
</p>

<p>Number(Integer)                     Integer
</p>

<p>Text                                String
</p>

<p>Hyper Link                          String
</p>

<p>不支持                              Variant
</p>

<p>——————————————————————
</p>

<p>2．常量
</p>

<p>定义常量来代替那些固定不变量的数字或字符串，可以提高代码的可读性和可维护性。VBA中有一部分常量是系统预先定义的，可以直接使用。用户也可以使用自己定义的常量，但在使用之前必须声明，以便分配内存空间。语法如下：
</p>

<p>[Public/Private] Const 常量名 [As 数据类型] = 表达式
</p>

<p>例如：
</p>

<p>Const Pi=3.14159265358979323
</p>

<p>Public Const A1 As Integer=6
</p>

<p>Const BornDay=#03/23/80#
</p>

<p>Private Const A2=”Abcdef258”
</p>

<p>常量有3个范围级别：过程级别（在过程中声明的）、私有模块级别（Private）、公共模块级别（Public）。
</p>

<p>Access支持3种类型的常量：
</p>

<p>◆ 符号常量：需要声明的常数都是符号常量。
</p>

<p>◆ 固有常量：是Access或引用对象库的一部分。
</p>

<p>◆ 系统定义常量：True、False、Null。
</p>

<p>其中，符号常量可以按上述方法声明；系统定义常量只有上述三个。而固有常量则比较复杂一些，它是系统自动定义的，它由应用程序列与控件提供。它采用两种方法来限定常数：通过前缀（如VBA对象库的常数都以Vb开头，如Vb Tile Horizontal）或通过库应用（[Libyan]|[mdul name] Constant）。
</p>

<p>用户可以使用对象浏览器来查看所有对象库中的固有常量列表。具体操作如下：
</p>

<p>◆ 单击数据库窗口【对象】栏下的【模块】按钮，再单击工具栏中的【代码】按钮，进入模块代码窗口。
</p>

<p>◆ 单击代码窗口工具栏中的【对象浏览器】窗口。
</p>

<p>◆ 要查看可以使用的常量，在【对象浏览器】窗口中的【工程/库】下拉列表框中选择【所有库】选项。此时，在窗口的【类】列表框中将显示所有引用对象库中的类。
</p>

<p>◆ 在【搜索文字】下拉列表框中输入“Constant”，然后单击【对象浏览器】工具栏上的【搜索】按钮，则会在【搜索结果】列表框中显示所有固有常量类型。所有的这些固有常量都可以在宏或VBA中使用，用户可以在任何时候，在任何允许使用符号常量或用户自定义常量的地方使用固有常量。
</p>

<p>Access中主要有以下几种类型的固有常量：操作常量、DAO常量、事件过程常量、关键字常量、Run Command 方法常量、安全常量、VBA常量和Var Type函数常量。
</p>

<p>下面是VBA定义的一些常数，使程序设计变得更为简单。下列常数可在程序代码中的任何地方代替实际值：
</p>

<p>◆ Calendar 常数
</p>

<p>常数值 描述
</p>

<p>vbCalGreg   0   指出使用的是阳历。
</p>

<p>vbCalHijri  1   指出使用的是伊斯兰历法。
</p>

<p>◆ CallType 常数
</p>

<p>常数值 描述
</p>

<p>vbMethod 1 指出已经调用了一个方法。
</p>

<p>vbGet 2 指出一个Property Get 过程。
</p>

<p>vbLet 4 指出一个 Property Let 过程。
</p>

<p>vbSet 8 指出一个 Property Set 过程。
</p>

<p>◆ Color 常数
</p>

<p>常数值描述
</p>

<p>vbBlack 0x0 黑色
</p>

<p>vbRed 0xFF 红色
</p>

<p>vbGreen 0xFF00 绿色
</p>

<p>vbYellow 0xFFFF 黄色
</p>

<p>vbBlue 0xFF0000 蓝色
</p>

<p>vbMagenta 0xFF00FF 紫红色
</p>

<p>vbCyan 0xFFFF00 青色
</p>

<p>vbWhite 0xFFFFFF 白色
</p>

<p>◆ Compiler 常数
</p>

<p>Visual Basic for Applications 定义了一些不能与 #If...Then...#Else 指令一起使用的常数。这些常数除了其范围是全局的；也就是说，除了可在工程中到处应用，在功能上与 #If...Then...#Else 指令定义的常数相同。
</p>

<p>在 16 位开发平台上，编译常数定义如下：
</p>

<p>常数值描述
</p>

<p>Win16 True 指出开发环境是 16 位。
</p>

<p>Win32 False 指出开发环境不是 32 位。
</p>

<p>在 32 位开发平台上，编译常数定义如下：
</p>

<p>常数值描述
</p>

<p>Vba6  True  指出开发环境是 Visual Basic for Applications, version 6.0。
</p>

<p>Vba6  False  指出开发环境不是Visual Basic for Applications, version 6.0。
</p>

<p>Win16 False 指出开发环境不是 16 位。
</p>

<p>Win32 True 指出开发环境是 32 位。
</p>

<p>Mac False 指出开发环境不是 Macintosh。
</p>

<p>Win16 False 指出开发环境不是 16位的。
</p>

<p>Win32 False 指出开发环境不是 32位的。
</p>

<p>Mac True 指出开发环境是 Macintosh。
</p>

<p>注意这些常数是由 Visual Basic 提供的，所以不能在任何层次中用相同名称定义自己的常数。
</p>

<p>◆ Date 常数
</p>

<p>常数值描述
</p>

<p>vbUseSystem 0 使用 NLS API 设置。
</p>

<p>vbSunday 1 星期日（缺省）
</p>

<p>vbMonday 2 星期一
</p>

<p>vbTuesday 3 星期二
</p>

<p>vbWednesday 4 星期三
</p>

<p>vbThursday 5 星期四
</p>

<p>vbFriday 6 星期五
</p>

<p>vbSaturday 7 星期六
</p>

<p>◆ Dir、GetAttr 和 SetAttr 常数
</p>

<p>常数值描述
</p>

<p>vbNormal 0 正常的（Dir 和 SetAttr 的缺省值）
</p>

<p>vbReadOnly 1 只读的
</p>

<p>vbHidden 2 隐藏的
</p>

<p>vbSystem 4 系统文件
</p>

<p>vbVolume 8 卷标
</p>

<p>vbDirectory 16 目录或文件夹
</p>

<p>vbArchive 32 文件自上一次备份后已经改变
</p>

<p>vbAlias 64 在 Macintosh上，标识符是一个别名。
</p>

<p>◆ IMEStatus 常数
</p>

<p>常数值描述
</p>

<p>vbIMEModeNoControl 0 没有安装 IME（缺省）
</p>

<p>vbIMEModeOn 1 打开 IME
</p>

<p>vbIMEModeOff 2 关闭 IME
</p>

<p>vbIMEModeDisable 3 无效的 IME
</p>

<p>vbIMEModeHiragana 4 完整宽度 Hiragana 模式
</p>

<p>vbIMEModeKatakana 5 完整宽度 Katakana 模式
</p>

<p>vbIMEModeKatakanaHalf 6 半宽度 Katakana 模式
</p>

<p>vbIMEModeAlphaFull 7 完整宽度 Alphanumeric 模式
</p>

<p>vbIMEModeAlpha 8 半宽度 Alphanumeric 模式
</p>

<p>◆ Instr、StrComp 常数
</p>

<p>常数值描述
</p>

<p>VbUseCompareOption  -1 使用Option Compare语句的设置进行比较。
</p>

<p>VbBinaryCompare 0 进行二进制的比较。
</p>

<p>VbTextCompare 1 进行文字的比较。
</p>

<p>vbDatabaseCompare 2 用于 Microsoft Access(仅限于Windows)，进行以数据库所含信息为基础的比较。
</p>

<p>◆ Keycode 常数
</p>

<p>常数值描述
</p>

<p>vbKeyLButton 0x1 鼠标左键
</p>

<p>vbKeyRButton 0x2 鼠标右键
</p>

<p>vbKeyCancel 0x3 CANCEL 键
</p>

<p>vbKeyMButton 0x4 鼠标中键
</p>

<p>vbKeyBack 0x8 BACKSPACE 键
</p>

<p>vbKeyTab 0x9 TAB 键
</p>

<p>vbKeyClear 0xC CLEAR 键
</p>

<p>vbKeyReturn 0xD ENTER 键
</p>

<p>vbKeyShift 0x10 SHIFT 键
</p>

<p>vbKeyControl 0x11 CTRL 键
</p>

<p>vbKeyMenu 0x12 MENU 键
</p>

<p>vbKeyPause 0x13 PAUSE 键
</p>

<p>vbKeyCapital 0x14 CAPS LOCK 键
</p>

<p>vbKeyEscape 0x1B ESC 键
</p>

<p>vbKeySpace 0x20 SPACEBAR 键
</p>

<p>vbKeyPageUp 0x21 PAGE UP 键
</p>

<p>vbKeyPageDown 0x22 PAGE DOWN 键
</p>

<p>vbKeyEnd 0x23 END 键
</p>

<p>vbKeyHome 0x24 HOME 键
</p>

<p>vbKeyLeft 0x25 LEFT ARROW 键
</p>

<p>vbKeyUp 0x26 UP ARROW 键
</p>

<p>vbKeyRight 0x27 RIGHT ARROW 键
</p>

<p>vbKeyDown 0x28 DOWN ARROW 键
</p>

<p>vbKeySelect 0x29 SELECT 键
</p>

<p>vbKeyPrint 0x2A PRINT SCREEN 键
</p>

<p>vbKeyExecute 0x2B EXECUTE 键
</p>

<p>vbKeySnapshot 0x2C SNAPSHOT 键
</p>

<p>vbKeyInsert 0x2D INSERT 键
</p>

<p>vbKeyDelete 0x2E DELETE 键
</p>

<p>vbKeyHelp 0x2F HELP 键
</p>

<p>vbKeyNumlock 0x90 NUM LOCK 键
</p>

<p>A 至 Z 键与 A – Z 字母的 ASCII 码相同：
</p>

<p>常数值描述
</p>

<p>vbKeyA 65 A 键
</p>

<p>vbKeyB 66 B 键
</p>

<p>vbKeyC 67 C 键
</p>

<p>vbKeyD 68 D 键
</p>

<p>vbKeyE 69 E 键
</p>

<p>vbKeyF 70 F 键
</p>

<p>vbKeyG 71 G 键
</p>

<p>vbKeyH 72 H 键
</p>

<p>vbKeyI 73 I 键
</p>

<p>vbKeyJ 74 J 键
</p>

<p>vbKeyK 75 K 键
</p>

<p>vbKeyL 76 L 键
</p>

<p>vbKeyM 77 M 键
</p>

<p>vbKeyN 78 N 键
</p>

<p>vbKeyO 79 O 键
</p>

<p>vbKeyP 80 P 键
</p>

<p>vbKeyQ 81 Q 键
</p>

<p>vbKeyR 82 R 键
</p>

<p>vbKeyS 83 S 键
</p>

<p>vbKeyT 84 T 键
</p>

<p>vbKeyU 85 U 键
</p>

<p>vbKeyV 86 V 键
</p>

<p>vbKeyW 87 W 键
</p>

<p>vbKeyX 88 X 键
</p>

<p>vbKeyY 89 Y 键
</p>

<p>vbKeyZ 90 Z 键
</p>

<p>0 至 9 键与数字 0 – 9 的 ASCII 码相同：
</p>

<p>常数值描述
</p>

<p>vbKey0 48 0 键
</p>

<p>vbKey1 49 1 键
</p>

<p>vbKey2 50 2 键
</p>

<p>vbKey3 51 3 键
</p>

<p>vbKey4 52 4 键
</p>

<p>vbKey5 53 5 键
</p>

<p>vbKey6 54 6 键
</p>

<p>vbKey7 55 7 键
</p>

<p>vbKey8 56 8 键
</p>

<p>vbKey9 57 9 键
</p>

<p>下列常数代表数字键盘上的键：
</p>

<p>常数值描述
</p>

<p>vbKeyNumpad0 0x60 0 键
</p>

<p>vbKeyNumpad1 0x61 1 键
</p>

<p>vbKeyNumpad2 0x62 2 键
</p>

<p>vbKeyNumpad3 0x63 3 键
</p>

<p>vbKeyNumpad4 0x64 4 键
</p>

<p>vbKeyNumpad5 0x65 5 键
</p>

<p>vbKeyNumpad6 0x66 6 键
</p>

<p>vbKeyNumpad7 0x67 7 键
</p>

<p>vbKeyNumpad8 0x68 8 键
</p>

<p>vbKeyNumpad9 0x69 9 键
</p>

<p>vbKeyMultiply 0x6A MULTIPLICATION SIGN (*) 键
</p>

<p>vbKeyAdd 0x6B PLUS SIGN (+) 键
</p>

<p>vbKeySeparator 0x6C ENTER 键
</p>

<p>vbKeySubtract 0x6D MINUS SIGN (–) 键
</p>

<p>vbKeyDecimal 0x6E DECIMAL POINT (.) 键
</p>

<p>vbKeyDivide 0x6F DIVISION SIGN (/) 键
</p>

<p>下列常数代表功能键：
</p>

<p>常数值描述
</p>

<p>vbKeyF1 0x70 F1 键
</p>

<p>vbKeyF2 0x71 F2 键
</p>

<p>vbKeyF3 0x72 F3 键
</p>

<p>vbKeyF4 0x73 F4 键
</p>

<p>vbKeyF5 0x74 F5 键
</p>

<p>vbKeyF6 0x75 F6 键
</p>

<p>vbKeyF7 0x76 F7 键
</p>

<p>vbKeyF8 0x77 F8 键
</p>

<p>vbKeyF9 0x78 F9 键
</p>

<p>vbKeyF10 0x79 F10 键
</p>

<p>vbKeyF11 0x7A F11 键
</p>

<p>vbKeyF12 0x7B F12 键
</p>

<p>vbKeyF13 0x7C F13 键
</p>

<p>vbKeyF14 0x7D F14 键
</p>

<p>vbKeyF15 0x7E F15 键
</p>

<p>vbKeyF16 0x7F F16 键
</p>

<p>◆ Miscellaneous 常数
</p>

<p>常数等于描述
</p>

<p>vbCrLf Chr(13) + Chr(10) 回车符与换行符结合
</p>

<p>vbCr Chr(13) 回车符
</p>

<p>vbLf Chr(10) 换行符
</p>

<p>vbNewLine Chr(13) + Chr(10) or, on the Macintosh, Chr(13) 平台指定的新行字符；适用于当前平台
</p>

<p>vbNullChar Chr(0) 值为 0 的字符
</p>

<p>vbNullString 值为 0 的字符串用来调用外部过程；与长度为零的字符串 ("") 不同
</p>

<p>vbObjectError -2147221504 用户定义的错误号应当大于该值，例如：
</p>

<p>Err.Raise Number = vbObjectError + 1000
</p>

<p>vbTab Chr(9) Tab 字。
</p>

<p>vbBack Chr(8) 退格字符
</p>

<p>vbFormFeed Chr(12) 在 Microsoft Windows or on the Macintosh 中没有作用
</p>

<p>vbVerticalTab Chr(11) 在 Microsoft or on the Macintosh Windows 中没有作用
</p>

<p>◆ MsgBox 常数
</p>

<p>常数值描述
</p>

<p>vbOKOnly 0 只有 OK 按钮（缺省值）
</p>

<p>vbOKCancel 1 OK 和 Cancel 按钮
</p>

<p>vbAbortRetryIgnore 2 Abort、Retry，和 Ignore 按钮
</p>

<p>vbYesNoCancel 3 Yes、No，和 Cancel 按钮
</p>

<p>vbYesNo 4 Yes 和 No 按钮
</p>

<p>vbRetryCancel 5 Retry 和 Cancel 按钮
</p>

<p>vbCritical 16 关键消息
</p>

<p>vbQuestion 32 警告询问
</p>

<p>vbExclamation 48 警告消息
</p>

<p>vbInformation 64 通知消息
</p>

<p>vbDefaultButton1 0 第一个按钮是缺省的（缺省值）
</p>

<p>vbDefaultButton2 256 第二个按钮是缺省的
</p>

<p>vbDefaultButton3 512 第三个按钮是缺省的
</p>

<p>vbDefaultButton4 768 第四个按钮是缺省的
</p>

<p>vbApplicationModal 0 应用程序形态的消息框（缺省值）
</p>

<p>vbSystemModal 4096 系统强制返回的消息框
</p>

<p>vbMsgBoxHelpButton 16384 添加Help按钮到消息框
</p>

<p>VbMsgBoxSetForeground 65536 指定消息框窗口作为前景窗口
</p>

<p>vbMsgBoxRight 524288 文本是右对齐的
</p>

<p>vbMsgBoxRtlReading 1048576 指定在希伯来语和阿拉伯语系统中，文本应当显示为从右到左读
</p>

<p>MsgBox 返回值
</p>

<p>常数值描述
</p>

<p>vbOK 1 按下 OK 按钮
</p>

<p>vbCancel 2 按下 Cancel 按钮
</p>

<p>vbAbort 3 按下 Abort 按钮
</p>

<p>vbRetry 4 按下 Retry 按钮
</p>

<p>vbIgnore 5 按下 Ignore 按钮
</p>

<p>vbYes 6 按下 Yes 按钮
</p>

<p>vbNo 7 按下 No 按钮
</p>

<p>◆ QueryClose 常数
</p>

<p>常数值描述
</p>

<p>vbFormControlMenu 0 用户从窗体上的Control 菜单选择Close 命令。
</p>

<p>vbFormCode 1 Unload 语句被从代码中调用。
</p>

<p>vbAppWindows 2 当前 Microsoft Windows 操作环境会话结束。
</p>

<p>vbAppTaskManager 3 Windows Task Manager 正在关闭应用程序。
</p>

<p>◆ Shell 常数
</p>

<p>常数值 描述
</p>

<p>vbHide 0 窗口是隐藏的，并且焦点被传递给隐藏窗口。
</p>

<p>vbNormalFocus 1 窗口拥有焦点，并且恢复到原来的大小与位置。
</p>

<p>vbMinimizedFocus 2 窗口缩小为图符并拥有焦点。
</p>

<p>vbMaximizedFocus 3 窗口最大化并拥有焦点。
</p>

<p>vbNormalNoFocus 4 窗口被恢复到最近一次的大小与位置。当前活动窗口仍为活动窗口。
</p>

<p>vbMinimizedNoFocus 6 窗口缩小为图符。当前活动窗口仍为活动窗口。
</p>

<p>◆ StrConv 常数
</p>

<p>Constant 值描述
</p>

<p>vbUpperCase 1 将字符串转换成大写字符。
</p>

<p>vbLowerCase 2 将字符串转换成小写字符。
</p>

<p>vbProperCase 3 将字符串中每个词的第一个字母转换成大写。
</p>

<p>vbWide 4 将字符串中的窄（单字节）字符转换成宽（双字节）字符。适用于远东地区。
</p>

<p>vbNarrow 8 将字符串中的宽（双字节）字符转换成窄（单字节）字符。适用于远东地区。
</p>

<p>vbKatakana 16 将字符串中的 Hiragana 字符转换成 Katakana 字符；只适用于日文地区。
</p>

<p>vbHiragana 32 将字符串中的 Katakana 字符转换成 Hiragana 字符；只适用于日文地区。
</p>

<p>vbUnicode 64 利用缺省的系统代码页将字符串转换成 Unicode (在Macintosh 中不可用。)。
</p>

<p>vbFromUnicode 128 将字符串由 Unicode 转换成缺省的系统代码页 (在Macintosh 中不可用。)。
</p>

<p>◆系统颜色常数
</p>

<p>常数值描述
</p>

<p>vbScrollBars 0x80000000 滚动条颜色
</p>

<p>vbDesktop 0x80000001 桌面颜色
</p>

<p>vbActiveTitleBar 0x80000002 活动窗口的标题栏颜色
</p>

<p>vbInactiveTitleBar 0x80000003 非活动窗口的标题栏颜色
</p>

<p>vbMenuBar 0x80000004 菜单背景色
</p>

<p>vbWindowBackground 0x80000005 窗口背景色
</p>

<p>vbWindowFrame 0x80000006 窗口框架颜色
</p>

<p>vbMenuText 0x80000007 菜单文本颜色
</p>

<p>vbWindowText 0x80000008 窗口文本颜色
</p>

<p>vbTitleBarText 0x80000009 标题、调整框和滚动箭头的文本颜色
</p>

<p>vbActiveBorder 0x8000000A 活动窗口边框颜色
</p>

<p>vbInactiveBorder 0x8000000B 非活动窗口边框颜色
</p>

<p>vbApplicationWorkspace 0x8000000C 多文档界面 (MDI) 应用程序的背景色
</p>

<p>vbHighlight 0x8000000D 控件中选中项目的背景色
</p>

<p>vbHighlightText 0x8000000E 控件中选中项目的文本颜色
</p>

<p>vbButtonFace 0x8000000F 命令按钮表面阴影颜色
</p>

<p>vbButtonShadow 0x80000010 命令按钮边缘阴影颜色
</p>

<p>vbGrayText 0x80000011 灰色（无效）文本
</p>

<p>vbButtonText 0x80000012 下压按钮文本颜色
</p>

<p>vbInactiveCaptionText 0x80000013 非活动标题文本颜色
</p>

<p>vb3DHighlight 0x80000014 3-D 显示元素的突出显示颜色
</p>

<p>vb3DDKShadow 0x80000015 3-D 显示元素的最深阴影颜色
</p>

<p>vb3DLight 0x80000016 vb3Dhighlight 之外最亮的 3-D 颜色
</p>

<p>vbInfoText 0x80000017 工具提示文本颜色
</p>

<p>vbInfoBackground 0x80000018 工具提示背景色
</p>

<p>◆ VarType 常数
</p>

<p>常数值描述
</p>

<p>vbEmpty 0 未初始化（缺省值）
</p>

<p>vbNull 1 不含任何有效数据
</p>

<p>vbInteger 2 Integer
</p>

<p>vbLong 3 长整数
</p>

<p>vbSingle 4 单精度浮点数
</p>

<p>vbDouble 5 双精度浮点数
</p>

<p>vbCurrency 6 Currency
</p>

<p>vbDate 7 Date
</p>

<p>vbString 8 String
</p>

<p>vbObject 9 对象
</p>

<p>vbError 10 错误
</p>

<p>vbBoolean 11 Boolean
</p>

<p>vbVariant 12 Variant（只用于变体的数组类型）
</p>

<p>vbDataObject 13 数据访问对象
</p>

<p>vbDecimal 14 Decimal
</p>

<p>vbByte 17 Byte
</p>

<p>vbUserDefinedType 36 包含用户定义类型的变量
</p>

<p>vbArray 8192 数组
</p>

<p>3．变量
</p>

<p>程序中的变量为临时在座单元，可存放文字、数值、日期和对象属性。每个变量都有一个名字，程序通过变量名对变量进行存取操作。
</p>

<p>⑴ VBA的变量命名规则
</p>

<p>变量名必须以英文字母开头。
</p>

<p>变量名长度不可以超过255个字符。
</p>

<p>除英文字母、数字、下划线外，其他字符尽量避免使用。
</p>

<p>变量名不能与VBA本身的函数过程、语句以及方法同名。
</p>

<p>变量名在同一作用域内不能相同。
</p>

<p>VBA变量不区分大小写。为了便于识别数据类型，在给变量或常量命名时，常常采用给变量名或常量名加前缀的方法。在VBA中，有一些约定俗成的常量和变量的命名前缀。如下表：
</p>

<p>数据类型前缀
</p>

<p>——————————
</p>

<p>Byte            Byt
</p>

<p>Integer         Int
</p>

<p>Long            Lng
</p>

<p>Single          Sng
</p>

<p>Double          Dbl
</p>

<p>Currency        Cur
</p>

<p>String          Str
</p>

<p>Boolean         Bln
</p>

<p>Date            Date
</p>

<p>Variant         Vnt
</p>

<p>Object          Obj
</p>

<p>用户自定义      Udt
</p>

<p>——————————
</p>

<p>⑵ 变量声明
</p>

<p>VBA变量声明有两种方法：
</p>

<p>◆ 隐性声明。如果没有指定变量的类型而使用变量，则此变量默认为Variant类型。这种声明方式不但增加了程序运行的负担，而且极容易出现数据运算问题，造成程序出错。
</p>

<p>◆ 显性声明。语法：Dim 变量名 [As 类型]    如：
</p>

<p>Dim X
</p>

<p>Dim W As Integer
</p>

<p>Dim A As String, B As Currency, C As Integer
</p>

<p>注意：如果这样声明：Dim x,y,z As Integer，则x,y为Variant类型。
</p>

<p>⑶ 变量的应用范围
</p>

<p>变量有三个范围级别
</p>

<p>◆ 过程级别。在过程内，只有在声明此变量的过程中才可使用的变量称为局部变量。用户可以使用Dim 或 Static关键字来定义。如：
</p>

<p>Dim x As Single
</p>

<p>Static y As single
</p>

<p>用Dim 定义的局部变量只有在它所在的过程运行时才会有值，而Static定义的局部变量在整个程序运行期间均有值，所以它可以作为中间变量保存结果。
</p>

<p>◆ 私有模块级别
</p>

<p>在程序中，公共模块中的变量对于所有模块的所有过程均可用，而私有模块中的变量只对所属模块过程可用。
</p>

<p>用户可以在窗体、报表和标准模块顶部的声明部分用Dim或Private定义模块级的变量。由Dim语句在声明部分所声明的变量，其范围默认为私有的。
</p>

<p>◆ 公共模块级别
</p>

<p>如果将一个变量声明为公共模块级变量，那么他就可以为工程所有过程调用。它通过Public来声明。
</p>

<p>⑷ 变量的生存期
</p>

<p>在给变量声明了应用范围后，变量就有了一个生存周期，即变量保留数值的时间。具体地说，就是变量第一次（声明时）出现到消失时的持续时间。
</p>

<p>Dim语句声明的过程级别变量将把数值保留到退出此过程为止。如果该过程调用了其他过程，则在这些过程运行的同时，属于调用者过程的变量将保留它的值。
</p>

<p>如果用户希望保存某个过程局部变量的值，可以用Static声明。如果过程级别的变量是用Static关键字来声明的，则只要有代码正在运行，此变量就会保留它的值；而当所有代码都完成运行后，变量将不再起作用，所以它的生成周期和模块级别变量是一样的。
</p>

<p>模块级别的变量与静态变量是不同的，在标准模块或类模块中变量会保留它的值直到停止款运行代码。在对象类模块中，只要仍有一个属于此对象类的实例存在，变量就会一直保留它的值。模块级别的变量会一直占用内存资源，直到重新设置它们的值，所以应只有必要时才使用它们。
</p>

<p>如果在Sub或Function语句前面加上Static，则此过程中所有级别的变量值在调用期间将保留。
</p>

<p>4．数组
</p>

<p>⑴ 声明数组
</p>

<p>格式：Public/Private/Static/Dim 数组名（[下标] To 上界） [As 数据类型]
</p>

<p>例如：Public Workers(8) As Integer
</p>

<p>Dim Workers(8) As Integer
</p>

<p>Static Workers(8) As Integer
</p>

<p>上述例子中，下标默认为0，上界为8，共9个元素。也可以人为指定下标，如：
</p>

<p>Dim Workers(1 To 8) As Integer
</p>

<p>通常可以通过一个For循环处理数组：
</p>

<p>Static Numbers(1 To 15) As Integer
</p>

<p>Dim I As Integer
</p>

<p>For I=1 To 15
</p>

<p>Numbers(I)=30
</p>

<p>Next I
</p>

<p>⑵ 二维数组和多维数组
</p>

<p>可以如下定义二维数组和多维数组：格式：
</p>

<p>Dim 数组名（[下标] To 上界，[[下标] To 上标,……]） [As 数据类型]
</p>

<p>例如：
</p>

<p>Static Aa(19,19) As Integer
</p>

<p>Static Aa(1 To 20,1 To 20) As Integer
</p>

<p>下面将值20赋给上述数组：
</p>

<p>Dim I As Integer,J As Integer
</p>

<p>Static Aa(19,19) As Integer
</p>

<p>For I=0 To 19
</p>

<p>For J=0 To 19
</p>

<p>Aa(I,J)=20
</p>

<p>Next J
</p>

<p>Next I
</p>

<p>多维数组的语法结构同二维数组大致一样，仅在声明时多了几项。
</p>

<p>⑶ 动态数组
</p>

<p>如果在程序运行之前不能肯定数组的大小，可以使用动态数组，建立动态数组的步骤如下：
</p>

<p>声明空维表：Dim Array()
</p>

<p>然后用ReDim语句配置数组个数。ReDim语句声明只能用在过程中，它是可执行语句，可以改变数组中元素的个数，但不能改变数组的维数。每次用ReDim配置数组时，原有数组的值全部清零。请看如下例子：
</p>

<p>Dim Aa() As Integer
</p>

<p>Dim I As Integer,J As Integer
</p>

<p>ReDim I Aa(7,5)
</p>

<p>For I=0 To 7
</p>

<p>For J=0 To 5
</p>

<p>Aa(I,J)=I*J
</p>

<p>Next J
</p>

<p>Next I
</p>

<p>ReDim I Aa(9,2)
</p>

<p>For I=0 To 9
</p>

<p>For J=0 To 2
</p>

<p>Aa(I,J)=2*(I*J)
</p>

<p>Next J
</p>

<p>Next I
</p>

<p>5．运算符
</p>

<p>⑴ 算术运算符
</p>

<p>加+   减-   乘*   除/   整除/   乘方^   求余Mod
</p>

<p>⑵ 连接运算符
</p>

<p>连接运算就是将两个表达式连接在一起。+和&都能完成这个工作，但应尽量使用&以。如：
</p>

<p>A1=#7/1/97#
</p>

<p>A2=”香港回归祖国”
</p>

<p>A3=A1&A2
</p>

<p>则变量A3的值为“97-7-1香港回归祖国”
</p>

<p>⑶ 比较运算符
</p>

<p>大于>   小于<   大于等于>=  小于等于<=  等于=   不等于<>
</p>

<p>⑷ 逻辑运算符
</p>

<p>非Not   与And   或Or    异或Xor     逻辑相等（同或）Eqv     隐含（逐位比较）Imp
</p>

<p>下面是真值表
</p>

<p>A
</p>

<p>B
</p>

<p>Not A
</p>

<p>A Or B
</p>

<p>A And B
</p>

<p>A Xor B
</p>

<p>A Eqv B
</p>

<p>A Imp B
</p>

<p>0
</p>

<p>0
</p>

<p>1
</p>

<p>0
</p>

<p>0
</p>

<p>0
</p>

<p>1
</p>

<p>1
</p>

<p>0
</p>

<p>1
</p>

<p>1
</p>

<p>1
</p>

<p>0
</p>

<p>1
</p>

<p>0
</p>

<p>1
</p>

<p>1
</p>

<p>0
</p>

<p>0
</p>

<p>1
</p>

<p>0
</p>

<p>1
</p>

<p>0
</p>

<p>0
</p>

<p>1
</p>

<p>1
</p>

<p>0
</p>

<p>1
</p>

<p>1
</p>

<p>0
</p>

<p>1
</p>

<p>1
</p>

<p>⑸ 运算符的优先级
</p>

<p>运算符的优先级顺序为：算术运算、连接运算、比较运算、逻辑运算。
</p>

<p>6．条件语句
</p>

<p>VBA支持以下3种条件判断语句：
</p>

<p>⑴ If…Then
</p>

<p>If<条件> Then <程序代码>
</p>

<p>例如：If I<5 Then Print“$”
</p>

<p>又如：If (I<5 And I>0) Then Print “$”
</p>

<p>⑵ If…Then…Else
</p>

<p>If<条件1> Then
</p>

<p><程序代码1>
</p>

<p>[Else If<条件2> Then
</p>

<p><程序代码2>]
</p>

<p>…
</p>

<p>[Else
</p>

<p><程序代码N+1>]
</p>

<p>End If
</p>

<p>例如：
</p>

<p>If Money>10000 Then
</p>

<p>Tax=Money*0.2
</p>

<p>Else If Money>1000 Then
</p>

<p>Tax=Money*0.15
</p>

<p>Else
</p>

<p>Tax=Money*0.1
</p>

<p>End If
</p>

<p>⑶ Select Case
</p>

<p>当条件表达式仅有一个测试变量时，使用Select Case结构更有效。其语法如下：
</p>

<p>Select Case<测试条件>
</p>

<p>Case <结果值1>
</p>

<p><程序代码1>
</p>

<p>[Case <结果值2>
</p>

<p><程序代码2>]
</p>

<p>…
</p>

<p>[Case Else
</p>

<p><程序代码N>]
</p>

<p>End Select
</p>

<p>例如：
</p>

<p>Select Case X
</p>

<p>Case 1
</p>

<p>Print “One”
</p>

<p>Case 2
</p>

<p>Print “Two”
</p>

<p>Case 3
</p>

<p>Print “Three”
</p>

<p>Case 4
</p>

<p>Print “Best”
</p>

<p>Case Else
</p>

<p>Print “Bad”
</p>

<p>End Select
</p>

<p>7．循环语句
</p>

<p>⑴ Do…Loop
</p>

<p>通过Do来执行循环，有如下四种格式。其中While是条件为真时循环，Until是条件为假时循环。
</p>

<p>格式一：
</p>

<p>Do While<条件表达式>
</p>

<p><循环代码>
</p>

<p>Loop
</p>

<p>例如：
</p>

<p>Sub Command1.Click()
</p>

<p>Dim I As Intger
</p>

<p>I=1
</p>

<p>Do While I<=20
</p>

<p>Print I
</p>

<p>I=I+1
</p>

<p>Loop
</p>

<p>End End
</p>

<p>格式二：
</p>

<p>Do
</p>

<p><循环代码>
</p>

<p>Loop While<条件表达式>
</p>

<p>Sub Command1.Click()
</p>

<p>Dim I As Intger
</p>

<p>I=1
</p>

<p>Do
</p>

<p>Print I
</p>

<p>I=I+1
</p>

<p>Loop While I<=20
</p>

<p>End End
</p>

<p>格式三：
</p>

<p>Do Until<条件表达式>
</p>

<p><循环代码>
</p>

<p>Loop
</p>

<p>例如：
</p>

<p>Sub Command1.Click()
</p>

<p>Dim I As Intger
</p>

<p>I=1
</p>

<p>Do Until I<=20
</p>

<p>Print I
</p>

<p>I=I+1
</p>

<p>Loop
</p>

<p>End End
</p>

<p>格式四：
</p>

<p>Do
</p>

<p><循环代码>
</p>

<p>Loop Until<条件表达式>
</p>

<p>Sub Command1.Click()
</p>

<p>Dim I As Intger
</p>

<p>I=1
</p>

<p>Do
</p>

<p>Print I
</p>

<p>I=I+1
</p>

<p>Loop Until I<=20
</p>

<p>End End
</p>

<p>⑵ For…Next
</p>

<p>格式：
</p>

<p>For 变量=初值 To 终值学者[Step 步长]
</p>

<p><循环体>
</p>

<p>Next [变量]
</p>

<p>例子：
</p>

<p>For I=1 To 10 Step 1
</p>

<p>Print 2^I
</p>

<p>Next I
</p>

<p>⑶ While…Wend
</p>

<p>格式：
</p>

<p>While<条件表达式>
</p>

<p><循环体>
</p>

<p>Wend
</p>

<p>例子：
</p>

<p>N=1
</p>

<p>While N<=5
</p>

<p>Beep
</p>

<p>Wend
</p>

<p>⑷ 循环的退出
</p>

<p>可以通过Exit退出循环。例如：
</p>

<p>Private Sub Command1_Click()
</p>

<p>Dim I, J As Integer
</p>

<p>J = Form!Text2.Value
</p>

<p>For I = 1 To 100
</p>

<p>If I = J Then
</p>

<p>Exit For
</p>

<p>End If
</p>

<p>Next I
</p>

<p>MsgBox "你输入的值是: " & I
</p>

<p>End Sub
</p>

<p>8．模块与过程
</p>

<p>⑴ 模块
</p>

<p>模块作为Access的对象之一，主要用来存放用户编写的VBA代码，如同窗体是存放控件对象的容器一样，模块是代码的容器。
</p>

<p>整个模块窗口分为两个部分：通用区和过程区。通常模块由以下一些部分组成：
</p>

<p>◆ 声明部分用户可以在这部分定义常量、变量、用户自定义类型和外部过程，在模块中，声明部分与过程部分是分割开来的。用户在声明部分中设定的常量和变量是全局性的，声明部分中的内容可以被模块中的所有过程调用。
</p>

<p>◆ 事件过程事件过程是一种自动执行的过程，用来对由用户或程序代码启动的事件或系统触发的事件做出响应。事件过程包括函数过程和子过程。
</p>

<p>从与其他对象的关系来看，模块又可分为两种基本类型：
</p>

<p>◆ 类模块类模块是指包含新对象定义的模块。
</p>

<p>◆ 标准模块标准模块是指存放整个数据库都可用的子程序和函数的模块。标准模块包括通用过程和常用过程，通用过程不与任何对象相关联，常用过程可以在数据库的任何地方运行。
</p>

<p>⑵ 过程
</p>

<p>一个过程就是一个VBA代码单元，它包含一系列的语句和方法，以便执行或计算数值。
</p>

<p>过程有两种：一种是子过程，另一种是函数过程。
</p>

<p>子过程用来执行一个操作或一系列操作，但是它不返回值。函数过程将返回一个值，并可传递参数。
</p>

<p>二、创建VBA程序
</p>

<p>1．VBA的编程环境
</p>

<p>通过单击数据库窗口【对象】栏下的【模块】按钮，选择需要编写或修改的模块，即弹出一个编写VBA程序的窗口，如下图：
</p>

<p>2．编写VBA语句
</p>

<p>VBA语句是一个完整的结构单元，它代表一种操作、声明或定义。一条语句通常占一行，用户也可以使用冒号在一行中包含多条语句。如果一条语句过长，用户可以使用行继续符（下划线）结束，在下一行的接着写。
</p>

<p>VBA中语句分为三种：
</p>

<p>◆ 声明语句：在声明语句中，用户可以给变量、常数或程序取名称，并且指定数据类型。
</p>

<p>◆ 赋值语句：用于指定变量或变量的值，指定变量为某一表达式。
</p>

<p>◆ 执行语句：在VBA语句中，一条执行语句可以执行初始化操作，也可以执行一个方法或函数，并且可以循环或从代码块中分支执行。
</p>

<p>3．创建事件过程
</p>

<p>下面是一个综合性的例子：
</p>

<p>代码如下：
</p>

<p>Option Compare Database
</p>

<p>Private Sub Command10_Click()
</p>

<p>X = InputBox("Please enter X")
</p>

<p>Select Case X
</p>

<p>Case "1"
</p>

<p>MsgBox "One"
</p>

<p>Case "2"
</p>

<p>MsgBox "Two"
</p>

<p>Case "3"
</p>

<p>MsgBox "Three"
</p>

<p>Case "4"
</p>

<p>MsgBox "Best"
</p>

<p>End Select
</p>

<p>End Sub
</p>

<p>Private Sub Command11_Click()
</p>

<p>Dim I As Integer, J As Integer
</p>

<p>I = 21
</p>

<p>J = 21
</p>

<p>Form_MyForm1!Label5.Caption = ""
</p>

<p>Do While I <= 20
</p>

<p>Form_MyForm1!Label5.Caption = Form_MyForm1!Label5.Caption & I & ","
</p>

<p>I = I + 1
</p>

<p>Loop
</p>

<p>Form_MyForm1!Label16.Caption = ""
</p>

<p>Do
</p>

<p>Form_MyForm1!Label16.Caption = Form_MyForm1!Label16.Caption & J & ","
</p>

<p>J = J + 1
</p>

<p>Loop While J <= 20
</p>

<p>End Sub
</p>

<p>Private Sub Command12_Click()
</p>

<p>Dim I As Integer, J As Integer
</p>

<p>I = 1
</p>

<p>J = 1
</p>

<p>Form_MyForm1!Label5.Caption = ""
</p>

<p>Do Until I > 20
</p>

<p>Form_MyForm1!Label5.Caption = Form_MyForm1!Label5.Caption & I & ","
</p>

<p>I = I + 1
</p>

<p>Loop
</p>

<p>Form_MyForm1!Label16.Caption = ""
</p>

<p>Do
</p>

<p>Form_MyForm1!Label16.Caption = Form_MyForm1!Label16.Caption & J & ","
</p>

<p>J = J + 1
</p>

<p>Loop Until J > 20
</p>

<p>End Sub
</p>

<p>Private Sub Command13_Click()
</p>

<p>Dim I As Integer, J As Integer
</p>

<p>J = InputBox("请输入要查找的值")
</p>

<p>For I = 1 To 100
</p>

<p>If I = J Then
</p>

<p>Exit For
</p>

<p>End If
</p>

<p>Next I
</p>

<p>If I <= 100 Then
</p>

<p>MsgBox ("找到！")
</p>

<p>Else
</p>

<p>MsgBox ("未找到！")
</p>

<p>End If
</p>

<p>End Sub
</p>

<p>Private Sub Command2_Click()
</p>

<p>Static Numbers(1 To 15) As Integer
</p>

<p>Dim I As Integer
</p>

<p>Form_MyForm1!Label5.FontSize = 16
</p>

<p>Form_MyForm1!Label5.BackColor = 8404992
</p>

<p>Form_MyForm1!Label5.Caption = ""
</p>

<p>For I = 1 To 15
</p>

<p>Numbers(I) = I
</p>

<p>Form_MyForm1!Label5.Caption = Form_MyForm1!Label5.Caption & Numbers(I) & " "
</p>

<p>Form_MyForm1!Text0.Value = Numbers(I)
</p>

<p>Next I
</p>

<p>End Sub
</p>

<p>Private Sub Command6_Click()
</p>

<p>Dim I As Integer, J As Integer
</p>

<p>Static Aa(19, 19) As Integer
</p>

<p>Form_MyForm1!Label5.BackColor = 4194432
</p>

<p>Form_MyForm1!Label5.FontSize = 9
</p>

<p>Form_MyForm1!Label5.Caption = ""
</p>

<p>For I = 0 To 19
</p>

<p>For J = 0 To 19
</p>

<p>Aa(I, J) = 20
</p>

<p>Form_MyForm1!Label5.Caption = Form_MyForm1!Label5.Caption & Aa(I, J) & " "
</p>

<p>Next J
</p>

<p>Next I
</p>

<p>End Sub
</p>

<p>Private Sub Command7_Click()
</p>

<p>Dim Aa() As Integer
</p>

<p>Dim I As Integer, J As Integer
</p>

<p>ReDim Aa(7, 5)
</p>

<p>Form_MyForm1!Label5.Caption = ""
</p>

<p>For I = 0 To 7
</p>

<p>For J = 0 To 5
</p>

<p>Aa(I, J) = I * J
</p>

<p>Form_MyForm1!Label5.Caption = Form_MyForm1!Label5.Caption & Aa(I, J) & " "
</p>

<p>Next J
</p>

<p>Form_MyForm1!Label5.Caption = Form_MyForm1!Label5.Caption & " ,"
</p>

<p>Next I
</p>

<p>ReDim Aa(9, 2)
</p>

<p>Form_MyForm1!Label16.Caption = ""
</p>

<p>For I = 0 To 9
</p>

<p>For J = 0 To 2
</p>

<p>Aa(I, J) = 2 * I * J
</p>

<p>Form_MyForm1!Label16.Caption = Form_MyForm1!Label16.Caption & Aa(I, J) & " "
</p>

<p>Next J
</p>

<p>Form_MyForm1!Label16.Caption = Form_MyForm1!Label16.Caption & " ,"
</p>

<p>Next I
</p>

<p>End Sub
</p>

<p>Private Sub Command8_Click()
</p>

<p>Dim a, b, c
</p>

<p>a = InputBox("Please enter a")
</p>

<p>b = InputBox("Please enter b")
</p>

<p>c = a Xor b
</p>

<p>Form_MyForm1!Text0.Value = c
</p>

<p>End Sub
</p>

<p>Private Sub Command9_Click()
</p>

<p>Dim Money As Currency
</p>

<p>Money = InputBox("Please enter Money")
</p>

<p>If Money > 10000 Then
</p>

<p>Tax = Money * 0.2
</p>

<p>ElseIf Money > 1000 Then
</p>

<p>Tax = Money * 0.15
</p>

<p>Else
</p>

<p>Tax = Money * 0.1
</p>

<p>End If
</p>

<p>cont = MsgBox("应缴税金为" & Tax & "确定按是，不确定按否查看帮助", 4 + 48)
</p>

<p>If cont = 6 Then
</p>

<p>Else
</p>

<p>MsgBox ("不理解也得理解！！！")
</p>

<p>End If
</p>

<p>End Sub
</p>

<p>4．创建过程
</p>

<p>事件过程是VBA编程的核心，但有时还需要利用VBA中的两类通用过程：Function过程和Sub过程，对事件过程加以改进，以提高代码的可读性和可维护性。
</p>

<p>⑴ Function过程
</p>

<p>如果用户需要在窗体或报表中重复使用某一表达式，可以使用一个函数过程代替这个表达式。
</p>

<p>例如：
</p>

<p>Function Summ(x, y) As Integer
</p>

<p>Summ = x + y
</p>

<p>End Function
</p>

<p>Private Sub Command2_Click()
</p>

<p>Dim a As Integer, b As Integer, c As Integer
</p>

<p>a = InputBox("请输入a")
</p>

<p>b = InputBox("请输入b")
</p>

<p>c = Summ(a, b)
</p>

<p>MsgBox ("c=a+b=" & a & "+" & b & "=" & c)
</p>

<p>Form_MyForm2!Label5.Caption = "c=a+b=" & a & "+" & b & "=" & c
</p>

<p>End Sub
</p>

<p>⑵ Sub过程
</p>

<p>Sub过程的定义与Function过程的定义类似，它们的重要区别在于，Sub过程没有返回值，不能用于表达式中。
</p>

<p>Function Summ(x, y) As Integer
</p>

<p>Summ = x + y
</p>

<p>End Function
</p>

<p>Sub subSumm()
</p>

<p>Dim a As Integer, b As Integer, c As Integer
</p>

<p>a = InputBox("请输入a")
</p>

<p>b = InputBox("请输入b")
</p>

<p>c = Summ(a, b)
</p>

<p>MsgBox ("c=a+b=" & a & "+" & b & "=" & c)
</p>

<p>Form_MyForm2!Label16.Caption = "c=a+b=" & a & "+" & b & "=" & c
</p>

<p>End Sub
</p>

<p>Private Sub Command2_Click()
</p>

<p>Call subSumm
</p>

<p>End Sub
</p>

<p>三、VBA程序对数据库的操作
</p>

<p>1．Microsoft Jet和ODBCDirect工作区模型
</p>

<p>⑴ Microsoft Jet工作区
</p>

<p>VB可以简单地打开一个现存的数据库，或是自己建立一个新的数据库。数据库类型可以是Microsoft Jet数据库（.mdb）、ISAM（索引查找访问模式，如Paradox数据库），也可以是通过 Microsoft Jet数据库引擎连接的ODBC数据库。
</p>

<p>可以利用对象变量或DDL特性来改变数据库结构。例如下面的代码把一个新的字段对象加入到现存的数据库表中：
</p>

<p>Dim dbs As Database,tdf As TableDef,fld As Field
</p>

<p>Set dbs = OpenDatabase(“BiBlio.mdb”)
</p>

<p>Set tdf = dbs.TableDefs(“Authors”)
</p>

<p>Set fld = tdf.CreateField(“Address”,dbText,20)
</p>

<p>Tdf.Fields.Append Fld
</p>

<p>VB具有进行数据处理、事务处理、数据备份、安全处理等工作的强大功能。
</p>

<p>⑵ ODBCDirect工作区模型
</p>

<p>ODBCDirect工作区模型主要通过连接数据库、查询设计、
</p>

<p>2．使用DAO操作数据
</p>

<p>打开数据库：
</p>

<p>Private Sub Command7_Click()
</p>

<p>Dim dbExam As Database
</p>

<p>Set dbExam = OpenDatabase("d:/st.mdb", True, True)
</p>

<p>MsgBox ("The dataBase [" & dbExam.Name & "] is now open")
</p>

<p>End Sub
</p>

<p>字段值增一
</p>

<p>Private Sub Command8_Click()
</p>

<p>Dim dbExam As Database
</p>

<p>Dim strSql As String
</p>

<p>strSql = "UPDATE st1 SET Age=Age+1"
</p>

<p>Set dbExam = OpenDatabase("d:/Access教程/st.mdb")
</p>

<p>dbExam.Execute strSql
</p>

<p>MsgBox ("St数据库中的St1表的Age字段已增一更新")
</p>

<p>dbExam.Close
</p>

<p>End Sub
</p>

<p>根据提示更新数据
</p>

<p>Private Sub Command9_Click()
</p>

<p>Dim dbExam As Database
</p>

<p>Dim strSql As String
</p>

<p>Dim i As Integer
</p>

<p>i = InputBox("Please enter i")
</p>

<p>strSql = "UPDATE st1 SET Age=Age+" & i
</p>

<p>Set dbExam = OpenDatabase("d:/Access教程/st.mdb")
</p>

<p>dbExam.Execute strSql
</p>

<p>MsgBox ("St数据库中的St1表的Age字段已更新" & i)
</p>

<p>dbExam.Close
</p>

<p>End Sub
</p>

<p>添加记录之一
</p>

<p>Private Sub Command10_Click()
</p>

<p>Dim dbExam As Database
</p>

<p>Dim intCommand As Integer
</p>

<p>Set dbExam = OpenDatabase("st.mdb")
</p>

<p>Set rstExam = dbExam.OpenRecordset("st1", dbOpenDynaset)
</p>

<p>With rstExam
</p>

<p>.AddNew
</p>

<p>!Name = "八八先生"
</p>

<p>!Age = 88
</p>

<p>!Tel = "8888888"
</p>

<p>intCommand = MsgBox("正在添加新记录，继续吗？", vbYesNo)
</p>

<p>If intCommand = vbYes Then
</p>

<p>.Update
</p>

<p>MsgBox ("st1表已增加一条记录")
</p>

<p>Else
</p>

<p>.CancelUpdate
</p>

<p>MsgBox ("已放弃增加记录")
</p>

<p>End If
</p>

<p>End With
</p>

<p>dbExam.Close
</p>

<p>End Sub
</p>

<p>添加记录之二
</p>

<p>Private Sub Command11_Click()
</p>

<p>Dim dbExam As Database
</p>

<p>Dim intCommand As Integer
</p>

<p>Dim Na As String
</p>

<p>Dim Ag As Integer
</p>

<p>Dim Te As String
</p>

<p>Set dbExam = OpenDatabase("st.mdb")
</p>

<p>Set rstExam = dbExam.OpenRecordset("st1", dbOpenDynaset)
</p>

<p>Na = Text17.Value
</p>

<p>Ag = Text2.Value
</p>

<p>Te = Text4.Value
</p>

<p>With rstExam
</p>

<p>.AddNew
</p>

<p>!Name = Na
</p>

<p>!Age = Ag
</p>

<p>!Tel = Te
</p>

<p>intCommand = MsgBox("正在添加新记录，继续吗？", vbYesNo)
</p>

<p>If intCommand = vbYes Then
</p>

<p>.Update
</p>

<p>MsgBox ("st1表已增加一条记录")
</p>

<p>Else
</p>

<p>.CancelUpdate
</p>

<p>MsgBox ("已放弃增加记录")
</p>

<p>End If
</p>

<p>End With
</p>

<p>dbExam.Close
</p>

<p>End Sub
</p>

<p>提取字段值
</p>

<p>Private Sub Command12_Click()
</p>

<p>Dim dbExam As Database
</p>

<p>Dim intCommand As Integer
</p>

<p>Dim Na As String
</p>

<p>Dim Ag As Integer
</p>

<p>Dim Te As String
</p>

<p>Set dbExam = OpenDatabase("st.mdb")
</p>

<p>Set rstExam = dbExam.OpenRecordset("st1", dbOpenDynaset)
</p>

<p>Form_MyForm2!Label16.Caption = ""
</p>

<p>With rstExam
</p>

<p>.MoveFirst
</p>

<p>While rstExam.EOF <> True
</p>

<p>Na = !Name
</p>

<p>Ag = !Age
</p>

<p>Te = !Tel
</p>

<p>Form_MyForm2!Label16.Caption = Form_MyForm1!Label16.Caption & Na & "," & Ag & "," & Te & "/"
</p>

<p>.MoveNext
</p>

<p>Wend
</p>

<p>End With
</p>

<p>dbExam.Close
</p>

<p>End Sub
</p>

<p>删除记录
</p>

<p>Private Sub Command13_Click()
</p>

<p>Dim dbExam As Database
</p>

<p>Dim intCommand As Integer
</p>

<p>Set dbExam = OpenDatabase("st.mdb")
</p>

<p>Set rstExam = dbExam.OpenRecordset("st1", dbOpenDynaset)
</p>

<p>With rstExam
</p>

<p>.MoveLast
</p>

<p>intCommand = MsgBox("正在删除最后一条记录，继续吗？", vbYesNo)
</p>

<p>If intCommand = vbYes Then
</p>

<p>.Delete
</p>

<p>MsgBox ("st1表已删除一条记录")
</p>

<p>Else
</p>

<p>MsgBox ("已放弃删除记录")
</p>

<p>End If
</p>

<p>End With
</p>

<p>dbExam.Close
</p>

<p>End Sub
</p>



<p style='float:right;'>本页共1051段，26706个字符，44953 Byte(字节)</p>﻿




</div>


<div>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.4em";' target="_self" style="color:#fff;" title="大：1.4em"><div id="ftsize1" style="color:#fff;">大</div></a>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.2em";' target="_self" style="color:#fff;" title="中：1.2em"><div id="ftsize2" style="color:#fff;">中</div></a>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.0em";' target="_self" style="color:#fff;" title="小：1em"><div id="ftsize3" style="color:#fff;">小</div></a>

<a target="_self" style="color:#fff;"><div style="display:none; color:#fff;" id="goTopBtn">&and;</div></a>
<a onclick="shangy()" target="_self" style="color:#fff;"><div style="display:none; color:#fff;" id="shangy">&uarr;</div></a>
<a onclick="xiay()" target="_self" style="color:#fff;"><div id="xiay" style="color:#fff;">&darr;</div></a>
<a onclick="downn()" target="_self" style="color:#fff;"><div id="goBottom" style="color:#fff;">&or;</div></a>
<script type=text/javascript>
	goTopEx();
	function xiay(){
		window.scrollBy(0,window.innerHeight-10);
	}
	function shangy(){
		window.scrollBy(0,-window.innerHeight+10);
	}
	var obj3=document.getElementById("xiay");
	var obj4=document.getElementById("goBottom");
	function getHeight(){  
		if(browser4=="ch"){
			//谷歌浏览器
			return document.body.clientHeight; 
		}else{
			//IE、firefox等浏览器 
			return document.documentElement.clientHeight;  
		}  
	}
	getHeight()<window.innerHeight+50?obj3.style.display="none":obj3.style.display="";
	getHeight()<window.innerHeight+50?obj4.style.display="none":obj4.style.display="";
	if(browser4!="ch"){	//firefox需要尝一下才显示向下图标
		xiay();
		shangy();
	}
</script>
</div>

</body>
</html>
