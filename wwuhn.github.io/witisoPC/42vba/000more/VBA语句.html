<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>VBA代码和程序</title> <meta http-equiv="content-type" content="text/html; charset=utf-8">
</meta></head>

<style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 100px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 70px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
 img{
 border:0;
 }#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	text-align:left;
	line-height:1.3em;
	table-layout:fixed;
}

#tbrowser th,#tbrowser td{
border:1px solid #ddd;
font-size:1em;
color:#000000;
text-align:left;
font-family: "宋体";
padding-left:3px;
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;
text-align:left;
/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/
text-align:left;
/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;
text-align:left;
/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;
text-align:left;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;
text-align:left;
line-height:18px;
font-size:16px;
color:#777;
}
.floatr{
float:right;
padding-right:5px;
}

#tbrowser th a:link {
	text-decoration: none;
	color:white;
}
#tbrowser th a:hover {
	text-decoration: none;
	color:white;
}
#tbrowser th a:active {
	text-decoration: none;
	color:white;
}
#tbrowser th a:visited {
	text-decoration: none;
	color:white;
}
#tbrowser caption{
font-size:1.2em;
text-align:left;
}
#tbrowser thead td{
font-size:0.8em;
text-align:left;
}div{
margin:auto;
width:74%;
border:0px blue solid;
}
p{
margin:0px;
text-indent:2em;
line-height:28px;
margin-top:8px;}
.data{
border:1px blue solid;

clear:both;
height:150px;
padding:2px;
margin-top:12px;

}
#tbrow{
border-collapse:collapse;
margin:auto;
width:88%;
}
#tbrow td{
border:0px solid blue;
}
.li{
list-style-type:decimal;
}
</style>


<body>

<div class="container">

<p>学习VBA，最重要的是语法，其它的对象、属性等等不需要花费太多时间去记忆，可以借助VBA内部的“自动成员列表”来完成输入。VBA中涉及的语法很多，其中常见有输入输出语句、循环语句、条件语句、With语句及防错语句。如何驾驭好这些语句对于程序员来说一个非常重要的课题。</p>
<p>1 输入、输出语句</p>
<p>1.1 MsgBox()语句； </p>
<p>a 返回运算结果</p>

  <p>b 询问执行方式</p>
  <p>c 提示执行步骤</p>
  <p>d 告知错误原因</p>
  <p>1.2 Debug.print</p>
  <p>也可以实现信息输出，不过通常开发人员使用。它只能在VBE中的立即窗口显示信息，而终端用户是不需要进入VBE界面的。</p>
  <p>If Not Range(&quot;A1&quot;).comment Is Nothing Then</p>
  <p>if IsNull(Range(&quot;A1:E10&quot;).MergeCells) Then  </p>
  <p>&nbsp;</p>
  <p>1.3 Inputbox函数是VBA中用于数据输入的函数，它可以在一对话框来中显示提示，等待用户输入信息或按下按钮，返回用户输入的String类型字符串。</p><p>Inputbox通常用于为用户提供录入窗口，然后将返窗口中的录入字符串按代码指定方式导入到相应的窗口或者根据输入值来决定后续的操作。</p>
  <p>条件判断语句在VBA中也是使用率非常高的语句。?用户在Excel中录制宏时无法如何都无法产生条件语句，必须通过VBE界面手工编写代码，那么了解它的语法就显得犹为重要了。</p>
  <p>循环语句（又称控制结构），它可能重复执行一系列代码，从而批量地完成工作任务。循环语句在实际工作中应用极广，且因为循环语句不可能利用录制宏产生，所以必须潜心掌握它的所语法与结构。</p>
  <h3>语句</h3>
<ol>

<li>条件分支语句：将代码分成几部分，按条件执行其中的部分；<br />
循环语句：将代码根据约定的条件执行n次；</li>
<li>If condition Then<br />
  &nbsp;&nbsp;...<br />
  
  Else<br />
  &nbsp;&nbsp;...<br />
  End If<br />
  
  三类条件，指定两类，两类以外的属于另一类；</li>
<li>
Select Case expression<br />
Case expression or value<br />
&nbsp;&nbsp;...<br />
Case expression or value<br />
&nbsp;&nbsp;...<br />
&nbsp;&nbsp;...<br />
Case Else<br />
&nbsp;&nbsp;...<br />
End Select<br />
</li>


<li>Case Else不能使用And和Or运算号，只能使用逗号实现or运算的同等功能，但没有其它办法实现And的功能；If then支持And和or运算符；</li>
<li>条件语句If Then和Select Case语句可以就会所有多条件判断的应用，但是它们都不是函数，不能直接返回值；IIf及Choose函数可以弥补这个缺陷，它们可以根据条件返回指定的值；</li>

<li>For Next语句使原来的单一操作得批量执行；</li>
<li>For counter=start to end [Step step]<br />
&nbsp;&nbsp;[statements]<br />
[Exit For]<br />
&nbsp;&nbsp;[statements]<br />
Next [counter]</li>


<li>For Each...Next用于对象或循环，即针对一个数组或集合中的每个元素重复执行一组语句；对象集合中有多少个元素，代码就可以执行多少次；如：<br />
for Each VarFontSt In Range(A1:J10)<br />
&nbsp;&nbsp;VarFontSt.Font.ColorIndex = 7<br />
&nbsp;&nbsp;VarFontSt.Font.Size = 16<br />
Next VarFontSt</li>
<li>
Do While condition ... Loop<br />
Do Until condition ... Loop<br />
Do ... Loop while condition<br />
Do ... Loop Until condition</li>
<li>
Select Case expression<br />
Case (is) expression or value<br />
&nbsp;&nbsp;...<br />
Case (is) expression or value : Exit For<br />

Case (is) expression or value<br />
&nbsp;&nbsp;...<br />
&nbsp;&nbsp;...<br />
Case Else<br />
&nbsp;&nbsp;...<br />
End Select<br />
</li>
</ol>
<h3>其它</h3>
<ol><li>with用于指定对象，对with语句内，被指定了的对象的属性或方法可以直接从&quot;.&quot;开始；</li>
  <li>错误转移语句：on Error GoTo 100<br />
    ...<br />
      100:<br />
</li><li>On Error Resume Next<br />
...<br />
Next<br />
中间的代码如果有错误时，可以忽略，而不会中断； 
</li>
</ol>

<p>插入12个工作表的代码</p>

For i = 1 To 12<br />
Sheets.Add<br />
ActiveSheet.Name = i &amp; &quot;月&quot;<br />
Next i</div>
</body>
</html>
