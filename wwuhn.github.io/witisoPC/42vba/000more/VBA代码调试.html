<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>VBA代码调试</title> <meta http-equiv="content-type" content="text/html; charset=utf-8">
</meta></head>

<style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 100px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 70px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
 img{
 border:0;
 }#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	text-align:left;
	line-height:1.3em;
	table-layout:fixed;
}

#tbrowser th,#tbrowser td{
border:1px solid #ddd;
font-size:1em;
color:#000000;
text-align:left;
font-family: "宋体";
padding-left:3px;
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;
text-align:left;
/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/
text-align:left;
/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;
text-align:left;
/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;
text-align:left;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;
text-align:left;
line-height:18px;
font-size:16px;
color:#777;
}
.floatr{
float:right;
padding-right:5px;
}

#tbrowser th a:link {
	text-decoration: none;
	color:white;
}
#tbrowser th a:hover {
	text-decoration: none;
	color:white;
}
#tbrowser th a:active {
	text-decoration: none;
	color:white;
}
#tbrowser th a:visited {
	text-decoration: none;
	color:white;
}
#tbrowser caption{
font-size:1.2em;
text-align:left;
}
#tbrowser thead td{
font-size:0.8em;
text-align:left;
}div{
margin:auto;
width:74%;
border:0px blue solid;
}
p{
margin:0px;
text-indent:2em;
line-height:18px;
margin-top:8px;}
.data{
border:1px blue solid;

clear:both;
height:150px;
padding:2px;
margin-top:12px;

}
#tbrow{
border-collapse:collapse;
margin:auto;
width:88%;
}
#tbrow td{
border:0px solid blue;
}
.li{
list-style-type:decimal;
}
</style>


<body>

<div class="container">



<h3>代码调试</h3>


<ol>
	<li>逐句运行：F8，将工作簿窗口和VBE窗口并排显示；模块→在代码窗口右上角的过程下拉框中选择所需执行的过程，按F8，当前运行的语句显示为黄色，继续按F8,即可以执行一行，持续按F8；;</li>
	<li>设置断点：F9；断点就是在程序中设置VBA代码暂时停止运行的位置，程序进入中断模式，此时在立即窗口和本地窗口可以查看变量以及对象的属性值。</li>
	<li>立即窗口：执行单行的语句或显示Debug.pring所打印的表达式的值；按Ctrl+G打开，在窗口中输入过程名，按Enter，即可运行该过程。可用于程序调试中，可以运行单行的语句或调用过程，也可以用问号表示某变量或常量的值，如?thisworkbook.Name。</p>

<p>Debug.Print?&quot;A等于&quot;?&amp;?A</p>

<p>在“立即窗口”中显示该内容；</li>
<li>本地窗口：单步调试时，在中断状态下可以非常方便地查看当前运行的过程中所包含的变量的值和对象的状态；</li>
  <li>清除所有断点：调试→清除所有断点</li>
  <li>On Error Resume Next：忽略错误而继续执行后续语句；</p>

<p>代码如果有错误时，可以忽略，而不会中断；</li>
  <li></li>
</ol>


<p>On Error GoTo 0语句表示禁止当前过程中任何已启动的错误处理程序。</p> 
<p>假设在过程中有On Error GoTo line和On Error Resume Next语句，那么本语句可以使用On Error GoTo line和On Error Resume Next失效。所以On Error GoTo 0语句不会单独使用。</p> 
<p>如果在过程中使用了或者On Error GoTo line和On Error Resume Next语句，限制了程序出错时该如何处理，而在后续的过程中如果不再需要按该规则执行，则可以在适当的地方插入On Error GoTo 0语句，表示清除前面的错误处理机制。</p>
<h4>使用Debug对象</h4>
<p>有两个方法，Print和Assert；</p>
<p>Print方法可以在不暂停程序运行的情况下监控某个变量在代码执行过程中的变化。Print方法在立即窗口显示文本。</p>
<p>Assert方法只有在Visual Basic编辑器中起作用，此方法和if语句类似，它判断一个条件是否成立，但是if语句不会暂停程序的执行。如果此方法的参数不成立，程序将在该语句暂停并进入中断模式。</p>

<p></p>

<p></p>
<h4>立即窗口调试</h4>
<p>Sub immediateTest()</p>

<p>Dim sh As Variant</p>

<p>Dim strTmp As String</p>

<p>For Each sh In Sheets</p>

<p>If strTmp = &quot;&quot; Then</p>

<p>strTmp = sh.Name</p>

<p>Else</p>

<p>strTmp = strTmp &amp; vbCrLf &amp; sh.Name</p>

<p>End If</p>

<p>Next</p>

<p>MsgBox strTmp</p>

<p>End Sub</p>
<p>'程序逐句运行到第5行代码时，在[立即窗口]中输入“?sheets.count”后按Enter键，将在下一行打印工作表总数。</p>

<p>'输入“?sh.name”后按Enter键，将在下一行打印出循环中的工作表名称;</p>

<p>'也可以调用自定义函数而打印出函数返回的值，如“?AssertTest(10,5)”</p>
<p>&nbsp;</p>
<p>'立即窗口改变变量的值查看运行情况</p>

<p>Sub test2()</p>

<p>Dim i As Integer</p>

<p>For i = 1 To 100</p>

<p>Debug.Print i * i</p>

<p>Next i</p>

<p>End Sub</p>
<p>'逐句运行到i＝2时，可以在立即窗口中输入i=88，断续逐句运行（F9），可以查看打印结果；</p>
<p>&nbsp;</p>
<p>'立即窗口也可以直接运行一行VBA语句；</p>

<p>'For Each sh In Sheets: Debug.Print sh.Name: Next</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h4>监视窗口调试</h4>
<p>Sub watchTest()</p>

<p>Dim Iradius As Integer</p>

<p>Dim k As Integer</p>

<p>For Iradius = 1 To 10</p>

<p>Debug.Print GetCircleArea(Iradius)</p>

<p>If Iradius &gt; 7 Then</p>

<p>k = 1</p>

<p>End If</p>

<p>Next Iradius</p>

<p>End Sub</p>

<p></p>
<p>Function GetCircleArea(ByVal Iradius As Integer) As Double</p>

<p>GetCircleArea = Iradius * Iradius * 3.1415926</p>

<p>End Function</p>
<p>'可以监视指定的表达式，如GetCircleArea(Iradius)，Iradius=5；</p>
<p></p>
<p>'调试→添加监视，监视类型：当监视值为真时中断</p>
<p>删除监视：监视窗口中选择→del</p>
<p></p>
<p></p>

<p></p>
</div>
</body>
</html>
