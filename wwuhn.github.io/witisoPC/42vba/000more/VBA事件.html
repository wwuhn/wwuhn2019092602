<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>VBA事件</title> <meta http-equiv="content-type" content="text/html; charset=utf-8">
</meta></head>

<style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 100px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 70px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
 img{
 border:0;
 }#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	text-align:left;
	line-height:1.3em;
	table-layout:fixed;
}

#tbrowser th,#tbrowser td{
border:1px solid #ddd;
font-size:1em;
color:#000000;
text-align:left;
font-family: "宋体";
padding-left:3px;
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;
text-align:left;
/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/
text-align:left;
/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;
text-align:left;
/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;
text-align:left;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;
text-align:left;
line-height:18px;
font-size:16px;
color:#777;
}
.floatr{
float:right;
padding-right:5px;
}

#tbrowser th a:link {
	text-decoration: none;
	color:white;
}
#tbrowser th a:hover {
	text-decoration: none;
	color:white;
}
#tbrowser th a:active {
	text-decoration: none;
	color:white;
}
#tbrowser th a:visited {
	text-decoration: none;
	color:white;
}
#tbrowser caption{
font-size:1.2em;
text-align:left;
}
#tbrowser thead td{
font-size:0.8em;
text-align:left;
}div{
margin:auto;
width:74%;
border:0px blue solid;
}
p{
margin:0px;
text-indent:2em;
line-height:28px;
margin-top:8px;}
.data{
border:1px blue solid;

clear:both;
height:150px;
padding:2px;
margin-top:12px;

}
#tbrow{
border-collapse:collapse;
margin:auto;
width:88%;
}
#tbrow td{
border:0px solid blue;
}
.li{
list-style-type:decimal;
}
</style>


<body>

<div class="container">



<p>事件也称为自动化过程，它不需要人工调用。而且事件发生时代码也随之执行，可见对象的事件赋予了对象更灵活的一些特性，从而使应用更智能。</p>
<p>对象除了有方法外，还具有事件。属性是指对象的某些特征，而方法是指对这个对象执行某些操作，是一个动词，那么事件是什么呢？假设汽车是一个对象，那么汽车的大小、价格、体积、颜色是它的属性，而启动汽车这个动作则属于它的方法。当启动汽车时，则发生了启动事件，停止汽车时也会触发停止事件。我们可以在这些事件发生时让它自动执行某些操作，例如发动汽车时自动开始计算里程，也可以同时设置开启雨刮器这类操作；对于Excel VBA，打开工作簿这是一个事件，可以在这个事件发生时自动执行某些宏，还不是手动通过或快捷键或对话框去运行它；</p>
<p>具体到VBA中，工作簿对象WorkBook的名称、主题、路径、是否保存等是它的属性，而工作簿对象的开启、保存、新建、关闭等动作则属于它的方法，而关闭、保存、开启、新建等同时又是工作簿对象的事件。</p>
<p>我们可以为事件预置一些操作，当发生这些事件时，事件过程中的命令可以自动执行。如新建工作簿时预设页面打印的边距、页脚等；</p>
<p>简而言之，Excel VBA的事件就是可被VBA识别的某些操作，可以在这些操作发生时调用开发者指定的命令，从而完成工作需求。但是VBA并没有对所有对象都设置事件。</p>
<p>在VBA中，工作簿、工作表、窗体、控件、图表等等都支持事件，通过事件可以实现办公自动化。每个VBA爱好者都需要深入地理解事件的分类，及每个事件在引发条件、实现功能，从而提升工作效率。</p>
<p>事件在Excel中执行某个操作时引发预定义的动作。事件过程则是一个事件发生时所引发由用户编写的Sub过程。事件类型无法自定义，但事件发生后引发的动作却可以人为控制。</p>
<p>例如在工作表中有一个Change事件，它表示工作表任意单元格的值改变时所引有的事件，如果用户利用鼠标、键盘或者程序去试图修改工作表中任何单元格，那么就会引发名为Change的事件。用户无添加一个工作表本身没有的事件，如鼠标移过事件，却可以随意定制Change事件触的过程。</p>
<p>Excel支持上百种事件，如果需要进行分类通常按代码的存放位置和事件的级别来区分。表8-1中即7个类别的事件及其代码存放位置列表。</p>
<h4>表8-1事件分类</h4>
<p>事件级别代码存放位置引发对象</p>
<p>应用程序级
  类模块
  任何工作簿</p>
<p>工作簿级Thisworkbook
  当前工作簿</p>
<p>工作表级工作表（Sheet1、Sheet2等等)当前工作表</p>
<p>图表级图表（Chart1、Chart2等等）当前图表</p>
<p>窗体级UserForm
  当前窗体</p>
<p>ActiveX控件
  工作表或者窗体中
  当前控件</p>
<p>类模块
  类模块
  用户定义的对象<br />
</p>


<h4>事件是区分层次的，不同层次的事件在执行顺序上有先后之别。</h4>
<h4>Excel的事件可以手工启用和禁用。</h4>
<p>在VBA中，通过Application对象的EnableEvents属性来控制，将EnableEvents属性设置为True即启用事件，设为False即为禁用事件。完整的代码如下：</p>
<p>Application.EnableEvents=True Application.EnableEvents=False</p>
<p>通常在以下两种情况下需要禁用事件：临时关闭事件</p>
<p>防止事件进入死循环</p>

<h4>事件代码的彔入方式</h4>
<p>事件过程是一个非常特殊的Sub过程。它的代码可以手工逐字录入，但效率极差且出错机率高。</p>
<p>VBA为程序员提供了一个高效而准确录入代码的便捷方式——借用对象与过程下拉框自动产生事件代码外壳。</p>
<p>假设需要录入工作表级“Worksheet_FollowHyperlink”事件的代码，那么可以参照以下步骤：</p>
<p>（1）从工作表标签处右键单击工作表名称，从菜单中选择【查看代码】；</p>
<p>（2）在代码窗口顶中的“对象”下拉列表中选择“Worksheet”，此时代码窗口会产生以下代码：</p>
<p>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</p>
<p>End Sub</p>
<p>因为“Worksheet_SelectionChange”事件是Excel工作表的默认事件，只要选择对象后它就会自动产对“Worksheet_SelectionChange”事件的外壳。此时忽略它，单击右边的“过程”下拉列表，其中罗列了所有工作表事件的过程。</p>
<p>（3）当选择“FollowHyperlink”过程名后，代码窗口将自动产生“Worksheet_FollowHyperlink”事件代码的外壳，此时再删除“Worksheet_SelectionChange”事件相关的代码即可。</p>
<p>此方式录入代码时准确度比手工录入代码会高很多，特别是有很多参数的事件过程代码。例如图像控件的鼠标移过事件：</p>
<p>Private Sub Image1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)</p>
<p>End Sub</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div>
</body>
</html>
