<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>

<script type="text/javascript">
var userAgent = navigator.userAgent.toLowerCase();
var browser = 
	(browser = userAgent.match(/qqbrowser\/([\d.]+)/))?"qqbrowser/"+browser[1]:
	(browser = userAgent.match(/se\s+2.x/))?"sogou/2.x": //sougou
	(browser = userAgent.match(/msie\s+([\d.]+)/))?"msie/"+browser[1]: //ie
	(browser = userAgent.match(/chrome\/([\d.]+)/))?"chrome/"+browser[1]: //chrome
	(browser = userAgent.match(/firefox\/([\d.]+)/))?"firefox/"+browser[1]: //firefox
	(browser = userAgent.match(/version\/([\d.]+)\s+safari\/([\d.]+)/))?"safari/"+browser[1]: //safari
	(browser = userAgent.match(/opera\/([\d.]+)([\w\W]+)version\/([\d.]+)/))?"opera/"+browser[3]: //opera
	"other browser";
	var browser4 = browser.substr(0,2);
//实现回到页面顶部  
function goTopEx(){  
	var obj=document.getElementById("goTopBtn"); 
	var obj2=document.getElementById("shangy"); 
	var obj3=document.getElementById("xiay");
	var obj4=document.getElementById("goBottom");  
	
	function getScrollTop(){  
		if(browser4=="ch"){
			//谷歌浏览器  
			return document.documentElement.scrollTop; 
		}else{
			//IE、firefox等浏览器 
			return document.documentElement.scrollTop;  
		}  
	}
	function setScrollTop(value){ 
		if(browser4=="ch"){ 
			//谷歌浏览器  
			document.documentElement.scrollTop=value; 
		}else{  
			//IE、firefox等浏览器
			document.documentElement.scrollTop=value;  
		} 
	}     
	window.onscroll=function(){getScrollTop()>50?obj.style.display="":obj.style.display="none";
	getScrollTop()>100?obj2.style.display="":obj2.style.display="none";
	document.body.clientHeight-getScrollTop()>650?obj3.style.display="":obj3.style.display="none";
	document.body.clientHeight-getScrollTop()>650?obj4.style.display="":obj4.style.display="none";
	}  
	obj.onclick=function(){  
		var goTop=setInterval(scrollMove,10);  
		function scrollMove(){  
				setScrollTop(getScrollTop()/1.1);  
				if(getScrollTop()<1)clearInterval(goTop);  
		}  
	}  
}  
function downn(){
	if(browser4=="ch"){
		//谷歌浏览器  
		window.scrollBy(0,document.body.clientHeight);
	}else{
		//IE、firefox等浏览器  
		window.scrollBy(0,document.documentElement.clientHeight*1000); 
	}
}
</script>
<script>
document.write('<div style="position:fixed; right: 10px; top:20px; color:#eee;">背景颜色<br><select name=bcolor id=bcolor onchange="javascript:document.body.style.background=this.options[this.selectedIndex].value;"><option style="background-color: #ffffff" value="#ffffff">白色</option><option style="background-color: #f6f6f6" value="#f6f6f6">银灰</option><option style="background-color: #e4ebf1" value="#e4ebf1">淡蓝</option><option style="background-color: #e6f3ff" value="#e6f3ff">蓝色</option> <option style="background-color: #eeeeee" value="#eeeeee">淡灰</option><option style="background-color: #eaeaea" value="#eaeaea">灰色</option>  <option style="background-color: #e4e1d8" value="#e4e1d8">深灰</option><option style="background-color: #e6e6e6" value="#e6e6e6">暗灰</option><option style="background-color: #eefaee" value="#eefaee">绿色</option><option style="background-color: #ffffed" value="#ffffed">明黄</option><option style="background-color: #333333" value="#333333">黑色</option></select><br>字体颜色<br><select name=txtcolor id=txtcolor onchange="javascript:document.getElementById(\'container\').style.color=this.options[this.selectedIndex].value;"> <option value="#000000">黑色</option><option value="#ff0000">红色</option><option value="#006600">绿色</option><option value="#0000ff">蓝色</option><option value="#660000">棕色</option><option value="#ffffff">白色</option></select><br>字体大小<br><select name=fonttype id=fonttype onchange="javascript:document.getElementById(\'container\').style.fontSize=this.options[this.selectedIndex].value;"> <option value="12px" >小号</option> <option value="14px" >较小</option> <option value="19px" >中号</option> <option value="19px" >默认</option><option value="22px" >较大</option><option value="25px" >大号</option><option value="35px" >35px</option><option value="45px" >45px</option><option value="55px" >55px</option><option value="65px" >65px</option><option value="75px" >75px</option><option value="85px" >85px</option><option value="95px" >95px</option></select></div>');   
</script>
<style type="text/css">
#tbrowser a:link，#container a:visited{
	font-size:18px;
	text-decoration:none;
}
a:link{
	text-decoration:none;
	}
#container{
	font-size:1.2em;
	margin:auto;
	font-family:"宋体";
	width:65.29%;
	line-height:1.6em;
}
P{
	margin-top:16px;
	margin-bottom:16px;
	text-indent:2em;
}
.uls{
	color:#CC6666;
	font-weight:bold;
}
.uls>ol{
	list-style:none;
	font-weight:normal;
	list-style:lower-latin;
	color:#000000;
	line-height:1.3em;
}
h2{
	font-size:20px;
	font-weight:bold;
	margin-top:15px;
	margin-bottom:0px;
	text-indent:0em;
}

#goTopBtn, #goBottom, #shangy, #xiay, #menuPage, #lPage, #fPage, #ftsize1, #ftsize2, #ftsize3{
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    font-size: 12px;
    text-align: center;
    position: fixed;
	right: 10px;
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
	font-weight:bold;
}
#goTopBtn, #goBottom, #menuPage, #lPage, #fPage, #ftsize1, #ftsize3{
    background-color:#999;
    color:#000;
}
#shangy, #xiay, #lPage, #fPage, #ftsize, #ftsize2{
    background-color: #bbb;
    color: #000;
}
#fPage{
	bottom: 236px;
	height:42px;
	white-space:nowrap;
	overflow:hidden;
	//writing-mode:tb-rl;
}

#menuPage{
	bottom: 198px;
	height:27px;
	white-space:nowrap;
	overflow:hidden;
}
#lPage{
	bottom: 145px;
	height:42px;
	white-space:nowrap;
	overflow:hidden;
}
#ftsize1{
	bottom:360px;
}
#ftsize2{
	bottom:334px;
}
#ftsize3{
	bottom:308px;
}

#goTopBtn{
    bottom: 105px;
}
#goBottom {
    bottom: 30px;
}
#shangy {
    bottom: 80px;
}
#xiay {
    bottom: 55px;
}


#goTopBtn:hover, #goBottom:hover, #shangy:hover, #xiay:hover, #menuPage:hover, #lPage:hover, #fPage:hover, #ftsize1:hover, #ftsize2:hover, #ftsize3:hover{
	background-color:#ccc;
	border:#ccc 0px solid;
}
#goTopBtn a:link, #goBottom a:link, #xiay a:link, #shangy a:link, #menuPage a:link, #ftsize1 a:link, #ftsize2 a:link, #ftsize3 a:link, #menuPage a:visited, #lPage a:link, #fPage a:link, #lPage a:visited, #fPage a:visited {
	text-decoration: none;
	color:white;
}
img{
	margin-right:2em;
	text-indent:2em;
	border:0;
}
.picsay{
	color:#930;
	font-size:90%;
	line-height:110%;
	margin-top:-12px;
	padding:0;
}
.remark{
	color:#930;
	font-size:90%;
	line-height:140%;
	margin-top:-12px;
	text-indent:0em;
	padding:0;
}
.ref{
	color:#930;
	font-size:95%;
	line-height:150%;
	margin-top:-12px;
	text-indent:2em;
	padding:0;
}
.code0, .code2, .code4{
	font-size:90%;
	line-height:110%;
	margin-top:-12px;
	padding:0;
}
.code0{
	color:red;
	text-indent:0em;
}
.code2{
	color:#930;
	text-indent:2em;
}
.code4{
	color:blue;
	text-indent:4em;
}
sub,sup{
	font-size:80%;
	color:red;
}
</style>

</head>

<body>

<div id="container">



<h4>﻿在VBA中使用数组（表格区域与数组的相互映射）</h4>

<p>使用数组一次可以处理多个变量。数组的维数可以是一维，也可以是二维（最多可以定义60维）。</p>

<p>Excel工作表就是一个天然的二维数组。工作表的行、列对应二维数组的行、列。</p>

<p>工作表数据区域与二维数组对元素的定位就相当于坐标定位，如工作表区域的cells()写法就是就是对应工作表的某一行，某一列。</p>

<p>在excel中，数据可以直接使用[{}]赋值，列元素用逗号,分隔，行元素用分号;分隔。</p>

<p>一维数组可以与行或列相互映射，二维数据可以与一个单元格区域相互映射。所谓相互映射，也就是说数组可以通过单元格区域定义，而定义格区域也可以通过数组赋值。</p>

<p>单元格区域可以通过地址引用，同样的，数组可以很方便地通过索引（下标）引用（字典通过key引用）。</p>

<p>通过数组，多了一种数据处理的方式，并且速度更快（将单元格区域映射为数组，相当于把单元格区域的数据搬入到了内存），更灵活（可以利用数组处理的内置函数）。</p>

<p>目录</p>

<p>1 一维数组与二维数组</p>

<p>2 数组的开始下标（最小下标）和结束下标（最大下标）</p>

<p>3 单元格区域映射到数组</p>

<p>4 利用索引号（下标）获取数组中的元素</p>

<p>5 数组转置</p>

<p>6 动态数组</p>

<p>6 数组的声明与赋值</p>

<p>7 数组与字符串</p>

<p>8 数组的最值、求和、个数统计</p>

<p>9 数组的查询和拆分</p>

<p>10 与数组相关的其它函数</p>

<p>1 一维数组与二维数组</p>

<p>1.1 一维数组与行</p>

<p>Sub 一维数组与行()</p>

<p>Dim arr()</p>

<p>arr = [{1,2,3,4}] '直接整体赋值时，上面的声明不能指定维数</p>

<p>Range("A3").Resize(1, UBound(arr)) = arr</p>

<p>End Sub</p>

<p>1.2 一维数组与列</p>

<p>Sub 数组()</p>

<p>Dim arr()</p>

<p>arr = [{1,"b",3,4}]</p>

<p>Range("A5").Resize(UBound(arr), 1) = Application.WorksheetFunction.Transpose(arr)</p>

<p>End Sub</p>

<p>1.3 二维数组</p>

<p>Sub 二维数组()</p>

<p>arr = [{11,12,13;21,22,23;31,32,33}]</p>

<p>Range("B5").Resize(UBound(arr, 2), UBound(arr)) = arr</p>

<p>End Sub</p>

<p>2 数组的开始下标（最小下标）和结束下标（最大下标）</p>

<p>UBound(arr)表示数组arr索引号的结束下标（最大下标，Largest Subscript），LBound(arr)表示索引号的开始上标（最小下标，smallest Subscript）。UBound(arr) －LBound(arr) + 1 即表示一维数组的长度(或多维数组第一维的长度)。如果一维数组的索引号从1开始，即LBound(arr)等于1，则UBound(arr)即表示一维数组的长度。</p>

<p>LBound(ArrayName[,dimension])</p>

<p>ArrayName - 必需的参数。该参数对应于数组的名称。</p>

<p>Dimension - 一个可选参数。 这需要一个与数组的维度相对应的整数值。如果是“1”，则返回第一维的下界; 如果是“2”，则返回第二维的下界，依此类推。</p>

<p>二维数组的行数：UBound(arr,1) －LBound(arr,1) + 1</p>

<p>（可以写为：UBound(arr) －LBound(arr) + 1）</p>

<p>二维数组的列数：UBound(arr,2) －LBound(arr,2) + 1</p>

<p>3 单元格区域映射到数组</p>

<p>如将Range("A1:E4")映射到数组arr：</p>

<p>Sub 单元格区域映射到数组()</p>

<p>arr = Range("A1").Resize(4, 5)</p>

<p>Range("A6").Resize(UBound(arr), UBound(arr, 2)) = arr</p>

<p>End Sub</p>

<p>将单元格区域的数据保存到数组以后，数据在内存中处理，速度更快。</p>

<p>4 利用索引号（下标）获取数组中的元素</p>

<p>数组元素的值可以通过下标获取。</p>

<p>Sub 二维数组()</p>

<p>arr = [{11,12,13;21,22,23;31,32,33}]</p>

<p>Range("B5").Resize(UBound(arr, 2), UBound(arr)) = arr</p>

<p>cells(1,1) = arr(2,2) 'arr(2, 2)对应22</p>

<p>End Sub</p>

<p>5 数组转置</p>

<p>正如单元格区域可以转置一样，数组也可以同样操作。</p>

<p>Sub 数组转置()</p>

<p>Dim arr</p>

<p>arr = [{1,2,3,4}]</p>

<p>arr2 = Application.WorksheetFunction.Transpose(arr)</p>

<p>Range("A5").Resize(UBound(arr), 1) = arr2</p>

<p>End Sub</p>

<p>以上操作相当于一维转二维，一维转为一个n行1列的二维数组。</p>

<p>同样的，二维数组也可以进行相同的操作。</p>

<p>6 数组的声明与赋值</p>

<p>声明一维数组：</p>

<p>dim arr(i to j) as variant</p>

<p>声明二维数组：</p>

<p>dim arr(i to j, n to m) as variant</p>

<p>上面的i，n必须是正整数，表示索引号（下标）开始值（最小值）。i可以通过Lbound(arr)获得，n可以通过Lbound(arr,2)获得；</p>

<p>如果i,n是零，可以略写为：dim arr(j) as variant，dim arr( j, m) as variant</p>

<p>j，m必须是正整数，表示索引号（下标）的结束值（最小值）。j可以通过Ubound(arr)区得，m可以通过Ubound(arr,2)获得；</p>

<p>当然，声明时也可以不考虑维数，如dim arr() as variant</p>

<p>Sub 二维数组的声明与赋值()</p>

<p>Dim arr(1 To 3, 1 To 4) '表示行、列的索引号都是从1开始，声明一个3行4列的数组</p>

<p>For i = 1 To 3</p>

<p>For j = 1 To 4</p>

<p>arr(i, j) = i * 10 + j</p>

<p>Next j</p>

<p>Next i</p>

<p>Range("A1").Resize(UBound(arr), UBound(arr, 2)) = arr</p>

<p>End Sub</p>

<p>用缺省索引号开始值的声明：</p>

<p>Sub 一维数组的声明与赋值()</p>

<p>Dim arr(3) '表示索引号从0-3的4个元素，等同于arr(0 to 3)</p>

<p>For i = 0 To 3</p>

<p>arr(i) = i + 10</p>

<p>Next i</p>

<p>Range("A1").Resize(1, UBound(arr) + 1) = arr</p>

<p>End Sub</p>

<p>关于列索引号的开始上标的默认值，如果采用缺少上标的声明，则开始上标的默认值是0.。如果没有声明直接使用数组变量，则上标的默认值是1。</p>

<p>另外，如果在声明时没有声明数据类型，或声明的是variant数据类型，在对数组元素分别赋值时，可以是不同的数据类型。</p>

<p>Sub 不同类型的数组元素()</p>

<p>Dim arr(5)</p>

<p>arr(0) = "1" 'Number as String</p>

<p>arr(1) = "VBScript 'String"</p>

<p>arr(2) = 100 'Number</p>

<p>arr(3) = 2.45 'Decimal Number</p>

<p>arr(4) = #10/7/2013# 'Date</p>

<p>arr(5) = #12:45:00 PM# 'Time</p>

<p>Range("A1").Resize(1, UBound(arr) + 1) = arr</p>

<p>End Sub</p>

<p>也可以利用VBA的内置函数Array()声明常量数组：</p>

<p>arr = Array(Array("a", 10), Array("b", 20), Array("c", 30))</p>

<p>[a1] = arr(1)(1)</p>

<p>6 动态数组</p>

<p>上面使用的都是静态数组，静态数组在执行期间不可以改变其上界（最后一个元素的索引号），而动态数组可以随时修改其上界。</p>

<p>有dim语句定义了一个静态数组后，可以用Redim 语句或者Redim Preserve 对定义的静态数组重新定义大小。</p>

<p>Redim 语句或者Redim Preserve语句的作用是为了动态数组变量重新分配内存空间，包括指定的维数及声明其上界。但Redim语句重置数组变小，会使数组中的值丢失；而Redim Preserve语句重置数组的变小时可以保留原数组中的值。可以使用Redim语句反复地改变数组的元素及维数的数目，但是不能将一个数组定义为某种数据类型后，再使用Redim将该数组改成为其他数据类型，除非是variant所包含的数组。具体看以下数组：</p>

<p>Sub 重置数组()</p>

<p>Dim arr1(), arr2()</p>

<p>arr1 = [A1:D11].Value</p>

<p>arr2 = [A1:D11].Value</p>

<p>ReDim arr1(1 To 2, 1 To 3) '重置数组大小为2行3列的二维数组,数组的中的值丢失</p>

<p>ReDim Preserve arr2(1 To 11, 1 To 3) '重置数组大小为11行3列的二维数组</p>

<p>MsgBox arr1(2, 3) '结果显示为空</p>

<p>MsgBox arr2(2, 3) 'C2单元格的数值</p>

<p>End Sub</p>

<p>7 数组与字符串</p>

<p>数组与字符串可以使用split()函数和join()函数相互转换。</p>

<p>7.1 利用Split()函数将字符串分割为一个数组</p>

<p>Split函数可以将字符串按指定的分隔符转换成下标为0的一维数组（下标为0，并且不受Option Base语句的影响）。它的语法如下:</p>

<p>Split(expression[,delimiter[,count[,compare]]])</p>

<p>expression 必选参数包含字符串和分隔符的字符串表达式。</p>

<p>delimiter 可选参数用于标识字符串边界的字符串字符。如果忽略，则使用空格字符（""）作为分隔符</p>

<p>count 一个可选参数。要返回的子字符串的数量，如果指定为-1，则返回所有子字符串。</p>

<p>如：</p>

<p>Sub splitstr()</p>

<p>Sheets("数组与字符串").Select</p>

<p>s = "红,red,橙,orange,黄,yellow,绿,green,青,cyan,蓝,blue,紫,purple"</p>

<p>arr = VBA.Split(s, ",")</p>

<p>Range("A11").Resize(1, UBound(arr)) = arr</p>

<p>End Sub</p>

<p>7.2 利用Join()函数将数组元素合并为一个字符串</p>

<p>Join函数可用于连接数组中的所有字串符，从而创建一个新的字串符，可随意指定分隔符，其语法如下：</p>

<p>Join（sourcearray ［，delimiter]）</p>

<p>sourcearray 代表数组，参数delimiter代表分隔符</p>

<p>如：</p>

<p>Sub joinstr()</p>

<p>a = Array("Red", "Blue", "Yellow")</p>

<p>b = Join(a)</p>

<p>b = Join(a, "$")</p>

<p>arr = Range("A1:B7")</p>

<p>For i = 1 To UBound(arr)</p>

<p>Range("d" & i) = Join(Array(arr(i, 1), arr(i, 2)), "-")</p>

<p>Next i</p>

<p>End Sub</p>

<p>7.3 利用Filter()函数筛选数组元素</p>

<p>Sub itemFilter()</p>

<p>arr = Array("A056", "A079", "B003", "A007", "B017")</p>

<p>arrf = Filter(arr, "A0")</p>

<p>MsgBox ("The Filter array: " & Join(arrf))</p>

<p>End Sub</p>

<p>单元格A1的值即显示为：A056 A079 A007</p>

<p>8 数组的最值、求和、个数统计</p>

<p>Application.Max(arr) 最大值</p>

<p>Application.Min(arr) 最小值</p>

<p>Application.Large(arr, 2) 求出第二大值</p>

<p>Application.Small(arr, 2) 求出第二小值</p>

<p>Application.Sum(arr) 求和</p>

<p>Application.Count(arr) 统计数组元素（数字）的个数</p>

<p>Application.Counta(arr) 统计数组元素（数字+文本）的个数</p>

<p>COUNT函数和COUNTA函数都是计算非空单元格个数。区别在于：</p>

<p>COUNT函数在计算非空单元格的个数时，将把数字型的数字计算进去，错误值、文字、逻辑值、空值将被忽略；</p>

<p>如果要统计含有错误值、文字、逻辑值，则使用COUNTA函数。</p>

<p>9 数组的查询和拆分</p>

<p>9.1 Mach()查询数组</p>

<p>Match()函数可以查询一个指定值在一组数中的位置，它也可以用于VBA数组的查询。如：</p>

<p>Sub query()</p>

<p>arr = Array(1, 35, 4, 13)</p>

<p>MsgBox Application.Match(4, arr, 0) '查询数值4在数组Arr中的位置</p>

<p>End Sub</p>

<p>9.2 Index拆分数组</p>

<p>数组的拆分在VBA中是一个难题，如果是按行拆分数组，除了用循环外也只能借用API函数完成了。幸好我们可以借用工作表函数index达到按列拆分数组，即多列构成的数组，你可以任意拆分出一列构成新的数组。方法是：Application.Index(数组, 列数) ，例：</p>

<p>Sub Index拆分数组()</p>

<p>arr2 = Range("A1:B4") ‘把单元格区域A1：B4的值装入数组arr2</p>

<p>arr3 = Application.Index(arr2, , 2) '把数组第2列拆分出来装入新数组arr3中，新数组为二维数组</p>

<p>MsgBox arr3(2, 1) '取出新数组第2行的值</p>

<p>End Sub</p>

<p>10 与数组相关的其它函数</p>

<p>IsArray()函数返回一个布尔值，指示指定的输入变量是否是数组变量。</p>

<p>Erase()函数用于重置固定大小数组的值并释放动态数组的内存。</p>

<p>Erase ArrayName</p>

<p>固定数值数组，数组中的每个元素重置为零。</p>

<p>固定字符串数组，数组中的每个元素被重置为零长度""。</p>

<p>对象数组，数组中的每个元素被重置为特殊值Nothing。</p>

<p>-End-</p>



本页共193段，5840个字符，10809 Byte(字节)﻿

</div>

<div>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.4em";' target="_self" style="color:#fff;" title="大：1.4em"><div id="ftsize1" style="color:#fff;">大</div></a>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.2em";' target="_self" style="color:#fff;" title="中：1.2em"><div id="ftsize2" style="color:#fff;">中</div></a>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.0em";' target="_self" style="color:#fff;" title="小：1em"><div id="ftsize3" style="color:#fff;">小</div></a>

<a id="fPagea" href="index.html" target="_self"><div id="fPage" style="color:#fff;">上<br>一<br>章</div></a>
<a href="index.html" target="_self"><div id="menuPage" style="color:#fff;">目<br>录</div></a>
<a id="LPagea" href="javascript:void(null)" target="_self"><div id="lPage" style="color:#fff;">下<br>一<br>章</div></a>

<a target="_self" style="color:#fff;"><div style="display:none; color:#fff;" id="goTopBtn">&and;</div></a>
<a onclick="shangy()" target="_self" style="color:#fff;"><div style="display:none; color:#fff;" id="shangy">&uarr;</div></a>
<a onclick="xiay()" target="_self" style="color:#fff;"><div id="xiay" style="color:#fff;">&darr;</div></a>
<a onclick="downn()" target="_self" style="color:#fff;"><div id="goBottom" style="color:#fff;">&or;</div></a>
<script type=text/javascript>
	goTopEx();
	function xiay(){
		window.scrollBy(0,window.innerHeight-10);
	}
	function shangy(){
		window.scrollBy(0,-window.innerHeight+10);
	}
	var obj3=document.getElementById("xiay");
	var obj4=document.getElementById("goBottom");
	function getHeight(){  
		if(browser4=="ch"){
			//谷歌浏览器  
			return document.body.clientHeight; 
		}else{
			//IE、firefox等浏览器 
			return document.documentElement.clientHeight;  
		}  
	}
	getHeight()<window.innerHeight+50?obj3.style.display="none":obj3.style.display="";
	getHeight()<window.innerHeight+50?obj4.style.display="none":obj4.style.display="";
	if(browser4!="ch"){	//firefox需要尝一下才显示向下图标
		xiay();
		shangy();
	}
	//上一页、下一页按钮，需要文件名是数字
	var strUrl=window.location.href;
	var arrUrl=strUrl.split("/");
	var thispage=arrUrl[arrUrl.length-1];
	var thispage2=thispage.split(".");
	var thispage3=thispage2[thispage2.length-2];
	if(thispage3 == 0){
		var obj5=document.getElementById("fPage");
		obj5.style.display="none";
	}else{
		var fpage = thispage3 - 1;
		fpage = fpage +".html";
		document.getElementById("fPagea").href=fpage;
	}
	if(thispage3 == 31){
		var obj6=document.getElementById("lPage");
		obj6.style.display="none";
	}else{
		var fpage = parseInt(thispage3) + 1;
		fpage = fpage +".html";
		document.getElementById("LPagea").href=fpage;
	}

</script>
</div>

</body>
</html>