<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>VBA和宏</title> <meta http-equiv="content-type" content="text/html; charset=utf-8">
</meta></head>

<style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 100px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 70px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
 img{
 border:0;
 }#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	text-align:left;
	line-height:1.3em;
	table-layout:fixed;
}

#tbrowser th,#tbrowser td{
border:1px solid #ddd;
font-size:1em;
color:#000000;
text-align:left;
font-family: "宋体";
padding-left:3px;
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;
text-align:left;
/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/
text-align:left;
/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;
text-align:left;
/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;
text-align:left;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;
text-align:left;
line-height:18px;
font-size:16px;
color:#777;
}
.floatr{
float:right;
padding-right:5px;
}

#tbrowser th a:link {
	text-decoration: none;
	color:white;
}
#tbrowser th a:hover {
	text-decoration: none;
	color:white;
}
#tbrowser th a:active {
	text-decoration: none;
	color:white;
}
#tbrowser th a:visited {
	text-decoration: none;
	color:white;
}
#tbrowser caption{
font-size:1.2em;
text-align:left;
}
#tbrowser thead td{
font-size:0.8em;
text-align:left;
}div{
margin:auto;
width:74%;
border:0px blue solid;
}
p{
margin:0px;
text-indent:2em;
line-height:28px;
margin-top:8px;}
.data{
border:1px blue solid;

clear:both;
height:150px;
padding:2px;
margin-top:12px;

}
#tbrow{
border-collapse:collapse;
margin:auto;
width:88%;
}
#tbrow td{
border:0px solid blue;
}
.li{
list-style-type:decimal;
}
</style>


<body>

<div class="container">



<h3>宏</h3>


<ol>
<li>宏录制器是Office提供的一种软件工具，它能够将用户的操作过程记录下来，并自动将所记录的操作转换成为VBA程序代码。</li>
<li>不管是word或excel,都可以利用录制宏，得到相应的程序，其中该用哪些语句、函数一看便知，在此基础上进行加工，就可以得到更加完善的程序。加工的方式主要是添加变量，添加判断和循环的逻辑控制语句；</li>
<li>开发工具→录制宏→…开发工具→停止录制；（默认保存在模块1中）</li>
<li>宏录制后，根据需要添加或删除部分代码，通常包括添加变量、修改区域地址、路径、加入循环语句、判断语句或防错语句；</li>
<li>录制宏时，VBA会产生操作对象的名称、属性、方法，但是不能使用变量，不能产生循环语句和条件语句；</li>
<li>宏代码：每一段录制的宏代码都是可执行的程序，在VBA中称为一个过程。每个过程都是以Sub开头，并且以End Sub结尾。在开头Sub之后以空格隔开的紧跟的过程名称，也就是宏的名称。</li>
<li>宏代码保存的位置：VBE中的模块中；</li>
<li>录制一个宏后，会自动添加一个模块；</li>
</ol>


<h4>Excel通用宏</h4>
<p>个人宏工作簿是一个自动启动的Excel文件，你可以用这个Excel文件保存经常使用的数据或者宏，例如你可以将你经常要使用到的例子或者反复使用的宏保存到个人宏工作簿中，这就相当于一个宏模板。个人宏工作簿可以为.xlsb格式，默认为Personal.xlsb文件，也可以直接创建.xlsx文件作为个人宏工作簿</p>
<p>在一个打开的工作簿中录制宏，即点击状态栏左下角的宏录制命令，在录制新宏对话框中选择保存在个人宏工作簿。同时你也可以在Visual Basic编辑器中看到Personal.xlsb的工程。
</p>
<p>你也可以直接在XLStart文件夹建立.xlsx文件。</p>
<p>在如果你把Office程序安装在默认的C盘下，且是在Vista系统中安装的Excel 2007，则文件位置建立在：
C:\Users\用户名\AppData\Roaming\Microsoft\Excel\XLSTART   用户名指的是你登录系统的帐号
或C:\Program Files\Microsoft Office\Office12\XLSTART</p>
<p>若是在XP系统中安装Excel 2007 ，则文件位置建立在：
C:\Documents and Settings\用户名\Application Data\Microsoft\Excel\XLStart   用户名指的是你登录系统的帐号
或C:\Program Files\Microsoft Office\Office12\XLSTART</p>
<h4>在word 2007中如何利用Normal模板共用宏 
</h4>
<p>开发工具→宏→管理器→复制按钮，即可将选中的宏复制到normal.dotm(共用模板)；</p>
<p>此时打开的VBE的工程管理器窗口即可以看到多了一个normal.dotm的工程，也可以在其中看到保存的模块；</p>


<p>&nbsp;</p>
</div>
</body>
</html>
