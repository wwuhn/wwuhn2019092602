<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript">
function goTopEx(){
	var obj=document.getElementById("goTopBtn");
	function getScrollTop(){
			return document.documentElement.scrollTop;
		}
	function setScrollTop(value){
			document.documentElement.scrollTop=value;
		}    
	window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
	obj.onclick=function(){
		var goTop=setInterval(scrollMove,10);
		function scrollMove(){
				setScrollTop(getScrollTop()/111);
				if(getScrollTop()<1)clearInterval(goTop);
			}
	}
}

 
 function goTopEx(){
        var obj=document.getElementById("goTopBtn");
        function getScrollTop(){
                return document.documentElement.scrollTop;
            }
        function setScrollTop(value){
                document.documentElement.scrollTop=value;
            }    
        window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
        obj.onclick=function(){
            var goTop=setInterval(scrollMove,10);
            function scrollMove(){
                    setScrollTop(getScrollTop()/111);
                    if(getScrollTop()<1)clearInterval(goTop);
                }
        }
    }


</script>
<title>VC组合框ComboBox</title>

<style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.6em;
}
P{
margin:16px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;
}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 105px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 30px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
	writing-mode:tb-rl;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 #shangy {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 80px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
#xiay {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 55px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 
img{
border:0;
}
.picsay{
color:#930;
font-size:90%;
line-height:110%;
margin-top:-12px;
padding:0;
}
.code0{
color:red;
font-size:90%;
line-height:110%;
margin-top:-12px;
padding:0;
text-indent:0em;
}
.code2{
color:#930;
font-size:90%;
line-height:110%;
margin-top:-12px;
padding:0;
text-indent:2em;
}
.code4{
color:blue;
font-size:90%;
line-height:110%;
margin-top:-12px;
padding:0;
text-indent:4em;
}
</style>
</head>

<body>

<div class="container">

      <p>1.先将资源进行变量关联，假如ComboBox关联到m_Combo1,Edit Box关联到m_Edit1,关联时注意选择类型：CComboBox m_Combo1; CString m_Edit1;
      </p>

      <p>2.ComboBox的数值如果是在设计该控件就添加进去的就不需要另外添加，否则，就在对话框的初始化的函数(OnInitDialog)中进行年份的添加。如下：<br />
        BOOL CXXXDlg::OnInitDialog()<br />
        {<br />
         
        CDialog::OnInitDialog();<br />
         
        m_Combo1.AddString(&quot;2001年&quot;);<br />
         
        m_Combo1.AddString(&quot;2002年&quot;);<br />
         
        return TRUE;<br />
        }</p>

      <p>3.添加ComboBox 的消息CBN_SELCHANGE处理函数<br />
        如下：<br />
        void CXXXXDlg::OnSelchangeCombo1() <br />
        {<br />
 
int sel=m_Combo1.GetCurSel();//得到当前选择的索引值        <br />
 
m_Combo1.GetLBText(sel,m_Edit1);//当前索引的对应文本放在m_Edit1        <br />
 
UpdateData(false);//更新，将关联变量的值更新到控件上        <br />
        }</p>
 
<p>1.关于CComboBox在对话框中没有下拉项目的问题</p>
<p>答: 资源编辑器中对话框中CComboBox组件的垂直范围拉大了下,就看见字体了。先点击右边向下的箭头，然后会出现上下可调的双向箭头，拖拉即可。</p>
<p>2、如果 ComboBox 的 Sorted 属性设置为 true，</p>
<p>则新添加项将按字母顺序插入到列表中。</p>
<p>否则，在列表的结尾处插入项。</p>
<p>3. CCOMBOBOX如何使它只读，不能编辑</p>
<p>答: 属性，type中选择&quot;drop list&quot;即可。</p>
<p></p>
<p>4. 我要让界面一显示，就能在Combo框中显示默认的数据</p>
<p>答: 你要在OnInitDialog里面加上我上面所提到的SetCurSel()函数就行了.</p>
<p></p>
<p>5、要立即响应选择框的改变（即选择框一改变选项，就立刻将结果传递进去）！<br />
  响应他的哪个消息比较好？</p>
<p>如果是只能选择的响应ON_CBN_SELCHANGE</p>
<p>如果是可以编辑的，那么要立刻响应编辑就是ON_CBN_EDITCHANGE</p>
<p></p>
<p>5. 如何把选好的内容赋给变量</p>
<p>答: 先给CCOMBOBOX设置一个CString关联变量,再添加事件处理函数CBN_ Selchange.使用UpdateData(FALSE)就行了.</p>
<p>void CTest2Dlg::OnSelchangeCombo2() <br />
  {<br />
  UpdateData(1);<br />
  CString m_pathstr;<br />
  int sel=m_fpath.GetCurSel();//得到当前选择的索引值<br />
  m_fpath.GetLBText(sel,m_pathstr);//当前索引的对应文本放在m_Edit1<br />
  UpdateData(0); <br />
  }</p>
<p>void CTest2Dlg::OnButton1() <br />
  {<br />
  UpdateData(1);<br />
  CString m_pathstr;<br />
  ((CComboBox*)GetDlgItem(IDC_COMBO2))-&gt;GetWindowText(m_pathstr);<br />
  m_text = m_pathstr;<br />
  UpdateData(0); <br />
  }</p>
<p>6. 在CComboBox组合框中，条目的对齐方式是左对齐，能设置为对中或者右对齐吗？</p>
<p>答: 没有直接的方法,你必须自己对齐, 比如最大长度是10</p>
<p>int i;</p>
<p>String.Format(&quot;%10d&quot;, i);</p>
<p>CComboBox-&gt;AddString</p>
<p>7、介绍一下列表框几种常用的消息映射宏： </p>
<p>ON_CBN_DBLCLK 鼠标双击 <br />
  ON_CBN_DROPDOWN 列表框被弹出 <br />
  ON_CBN_KILLFOCUS / ON_CBN_SETFOCUS 在输入框失去/得到输入焦点时产生 <br />
  ON_CBN_SELCHANGE 列表框中选择的行发生改变 <br />
  ON_CBN_EDITUPDATE 输入框中内容被更新 <br />
  使用以上几种消息映射的方法为定义原型如：afx_msg void memberFxn( );的函数，<br />
  并且定义形式如ON_Notification( id, memberFxn )的消息映射。<br />
  如果在对话框中使用组合框，Class Wizard会自动列出相关的消息，并能自动产生消息映射代码。</p>
<p></p>
<p></p>
8、设置当前项或得到当前是第几项<br />
 <br />
 m_ComboBox1.SetCurSel(N); //SetCurSel函数可改变标签<a target="_blank" href="http://www.programbbs.com/com/" rel="nofollow">控件</a>当前选定的项目<br />
//这个N可以是-1，表示无选择，0表示第一项，1表示第二项。。<br />
 m_ComboBox1.GetCurSel(); //得到当前是第几项.0是第一项，1是第二项
<p></p>
<p>//*****************************************************************</p>
<p>以下为ComboBox控件的常用属性设置及常用函数介绍</p>
<p></p>
<p>CComboBox控件又称作组合框控件,其有三种形态可供选择,</p>
<p></p>
<p>1.简单组合框(Simple)</p>
<p></p>
<p>2.下拉组合框(Drop-down)</p>
<p></p>
<p>3.下拉列表式组合框(Drop-down list).</p>
<p></p>
<p>CComboBox控件的常用设置属性说明:</p>
<p>type属性:里面一共有三个选项.就是其三种形式, 我们常用的是后两种形态,其区别就是Dropdown的编辑区为可编辑控件,而droplist为静态控件.</p>
<p></p>
<p>Data属性:当程序初始化的时候,下拉列表将显示其属性里面的内容,内容用分号分隔.其属性只支持后2中形式,</p>
<p></p>
<p>Sort 属性:对添加到下拉列表框中的数据自动进行排序,如果你不想他改变你的显示序列,把他设置成False.</p>
<p>控件是一个窗口.其基类是为CWnd.所以CComboBox也可以使用CWnd的一些函数,它自己的函数有30几种.我写了一个示范程序,演示了一些常用的函数,你可以参考其代码看到其功能.</p>
<p></p>
<p>注:m_cbox 为CComboBox控件的关联变量,m_end为EDIT控件的关联变量 </p>
<p></p>
<p>1.GetCount() 函数:用以获得列表框中的选项数目. int GetCount() const;(此乃函数原型,我会列在每条的后面) 下面的例子是程序中各个按钮里面的代码</p>
<p>int i;</p>
<p>CString str;</p>
<p>i=m_cbox.GetCount();</p>
<p>str.Format (&quot;%d&quot;,i);</p>
<p>m_end=&quot;一共有&quot;+str+&quot;个数据&quot;;</p>
<p>UpdateData(FALSE);</p>
<p></p>
<p>2.GetCurSel() 函数:用以得到用户选中下拉列表框中数据的索引值.返回的值是重0开始的,如果没有选择任何选项将会返回-1 Int GetCurSel() const</p>
<p>int i;</p>
<p>CString str;</p>
<p>i=m_cbox.GetCurSel ();</p>
<p>str.Format (&quot;%d&quot;,i+1);</p>
<p>if (i==-1) m_end=&quot;你什么都没有选&quot;;</p>
<p>else m_end=&quot;你选的是第&quot;+str+&quot;项&quot;;</p>
<p>UpdateData(FALSE);</p>
<p></p>
<p>3.SetCurSel函数:选取列表框中的一个选项,索引从0开始,-1为什么都不选.当你需要把列表框中已经选取的内容清空时就可以使用这个函数;</p>
<p>if(m_i&lt;3) m_cbox.SetCurSel (m_i++);//m_i为int型变量 用以计数</p>
<p>else {</p>
<p>m_cbox.SetCurSel (-1);</p>
<p>m_i=0;</p>
<p>}</p>
<p></p>
<p>4.SetEditSel函数:设置编辑区中蓝色选中字段的长度, BOOL SetEditSel( intnStartChar,</p>
<p>int nEndChar ); nStartChar是起始的位置,当设置为-1时为不选择任何字段,nEndChar是结束位置.还有一个对应的函数GetEditSel是取得其位置,在此不详解.</p>
<p>m_cbox.SetEditSel (3,5);//在编辑框中打入一串数字在按此按钮就能看到效果</p>
<p>//其作用就是选中第3到第5个字符作为热点</p>
<p></p>
<p>5.Clear()   Cut() Paste() Copy()   这四个函数我放在一起说,因为他们都是针对编辑框中选定的文字进行编辑的函数,很多初学者很不明白这4个函数,使用这些函数没有作用,其实不然,这些函数对于在编辑框中的内容不进行处理,他真正处理的是你用鼠标选中的内容,对于Clear()函数很多书中解释都是有误的,很多书中对他的解释是清除当前选中的文本,我认为这样的解释是有歧异的,真正的解释是把你刚选中的文本释放掉,也就是不选,而不是把选中的删除,真正的删除选中的文本的函数是Cut(),Copy()是复制选中的文本,Paste()是粘贴到光标处.其演示就不写在程序中,有兴趣的朋友可以自己试试.</p>
<p></p>
<p>6.LimitText()函数.其作用是限制在编辑框中键入的文本长度,BOOL LimitText(int nMaxChars); 当nMaxChars为0时,不是不能输入,而是长度最大化为65535字节</p>
<p></p>
<p>  7.GetLBText()函数.其原型为void GetLBText( int nIndex, CString&amp;rString   ).nIndex为列表框中数据的索引值,rString   为字符串,其作用就是把索引号为nIndex的数据放到rString变量中.与其对应的GetLBTextLen(intnIndex)函数就是得到索引号为nIndex中数据的长度</p>
<p>m_cbox.GetLBText (2,m_end); // GetLBText按钮</p>
<p>UpdateData(0);</p>
<p>CString str; //GetLBTextLen按钮</p>
<p>int i=m_cbox.GetLBTextLen (2);</p>
<p>str.Format (&quot;%d&quot;,i);</p>
<p>m_end=str;</p>
<p>UpdateData(FALSE);</p>
<p>  8.AddString() DeleteString() InsertString() ResetContent()   四个函数放在一起,他们都是针对下拉列表框的处理函数, AddString(LPCTSTR lpszString)   是在列表框的尾巴添加一条数据,参数为字符串. DeleteString(UINT nIndex)为删除指定索引为nIndex的数据.   InsertString(int   nIndex, LPCTSTR lpszString)在索引nIndex处插入IpszString的内容.   ResetContent()是清除列表框中所有的内容.</p>
<p>9.SetDroppedWidth(UINT nWidth) 函数.用于设定下拉列表框的最小宽度,当下拉列表框中的数据很长不能完全显示时,我们可以使用这个函数把列表框的宽度设置的大些.同样GetDroppedWidth()是返回列表框的宽度.</p>
<p>&nbsp;</p>
<p>如何限定组合框的文本框输入字符串的最大长度<br />
  现在是必须拉长组合框的文本框才能输入更长的字符串，不拉长的话只能输入与文本框长度一样的字符串，想输入更长的字符串就不响应了，有什么解决办法吗？谢谢大侠</p>
<p>extern CEdit* pmyEdit;<br />
  <br />
  // Limit the number of characters to be the maximum number visible.<br />
  <br />
  // Get the text metrics for the edit; needed for the<br />
  // average character width.<br />
  TEXTMETRIC tm;<br />
  CDC* pDC = pmyEdit-&gt;GetDC();<br />
  pDC-&gt;GetTextMetrics(&amp;tm);<br />
  pmyEdit-&gt;ReleaseDC(pDC);<br />
  <br />
  CRect r;<br />
  pmyEdit-&gt;GetRect(&amp;r);<br />
  pmyEdit-&gt;LimitText(r.Width()/tm.tmAveCharWidth);</p>
<p></p>
</div>
<a name="bottom" id="bottom"></a>
<DIV style="DISPLAY: none" id=goTopBtn>&and;</DIV>
<div id="goBottom"><a href="#bottom" target="_self">&or;</a></div>
<SCRIPT type=text/javascript>goTopEx();</SCRIPT>
</body>
</html>
<script language="javascript"> 
bg_evensssss("tbrowser","#fff","#F5F5F5","#FFFFCC","#FFDDFF");/*#FFFF84*/
</script>

<!--
_____________________________________________________________________________________

1 段落替换：
\s*<br />\s*
------------------
</p>

<p>
_____________________________________________________________________________________
2 汉字中间的空格替换：
([^\s\*^{}"^u4e00-u9fa5])\s+([^\s\*^{}"^u4e00-u9fa5])
------------------
$1$2
_____________________________________________________________________________________
3 段落前的空格替换
[\s*</p>\s*]
[\s*<p>\s*]
------------------
</p>

<p>

<p class="picsay">
<p class="picsay">
<p class="code0">
<p class="code2">
<p class="code4">
_____________________________________________________________________________________
-->