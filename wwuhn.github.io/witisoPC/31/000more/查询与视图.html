<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <script type="text/javascript">
 
 function goTopEx(){
        var obj=document.getElementById("goTopBtn");
        function getScrollTop(){
                return document.documentElement.scrollTop;
            }
        function setScrollTop(value){
                document.documentElement.scrollTop=value;
            }    
        window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
        obj.onclick=function(){
            var goTop=setInterval(scrollMove,10);
            function scrollMove(){
                    setScrollTop(getScrollTop()/111);
                    if(getScrollTop()<1)clearInterval(goTop);
                }
        }
    }


</script>
<script type="text/javascript">
 
 function goTopEx(){
        var obj=document.getElementById("goTopBtn");
        function getScrollTop(){
                return document.documentElement.scrollTop;
            }
        function setScrollTop(value){
                document.documentElement.scrollTop=value;
            }    
        window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
        obj.onclick=function(){
            var goTop=setInterval(scrollMove,10);
            function scrollMove(){
                    setScrollTop(getScrollTop()/111);
                    if(getScrollTop()<1)clearInterval(goTop);
                }
        }
    }


</script>
<title>查询与视图</title>

<style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 105px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 30px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
	writing-mode:tb-rl;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 #shangy {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 80px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
#xiay {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 55px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 
 img{
 border:0;
 }
 
\s*</p>

<p>\s*
 
 
</p>

<p>
</style>
</head>

<body>

<div class="container">
<p>SQL语言是关系数据库的标准查询语言；</p>

<p>数据查询是SQL语言中最重要、最核心的功能。SQL的数据查询操作是通过select查询命令实现的；</p>

<p>数据库用表、视图、查询进行数据的储存和加工处理；报表、表单利用其做为数据源；菜单用作程序操作或数据处理、显示、输入、输出的界面；</p>

<p>查询和视图都是从一个或多个相关的表中提取数据，查询是以只读的方式来访问表文件，视图以读写的方式来访问，使用视图可以从表中提取一组记录，改变这些记录的值，并将更新结果写入这些源表中，从而实现对源表的更新；</p>

<p>视图和查询能够进行数据的筛选、排序、分组，布局则定义报表的打印格式，当在某数据库中建立并完成相关视图或查询的定制后，就可以进行报表或标签的创建工作了。</p>

<p>输入表中的数据只是原始数据，加工可以是排序、筛选、或者汇总、求平均值等操作；这就是相应的查询、视图；以此为基础可以形成报表，类似于相应的excel表输入数据后进行相应的加工形成报表；ERP的功能除了数据共享、控制冗余外，就是相应的自己形成报表的功能；</p>

<p>快速、准确地进行数据查询，是衡量数据库管理系统性能的一个重要方面。查询是VF支持的一种数据库对象；视图是一个定制的虚拟表，兼有表和查询的特点。可以是本地的、远程的或带参数的。</p>

<p>查询</p>

<p>查询可以对数据源进行各种组合，有效地筛选记录，管理和统计数据，对结果进行排序，并以用户需要的方式显示查询结果。查询结果输出的类型可以是浏览窗口、报表、表、标签、图形等；</p>

<p>查询的主体是SQL select语句和输出定向有关的语句。</p>

<p>查询：人们将数据存入数据库表之后，还需要在需要时将数值取出来使用，尽管可以使用browse命令来查询整张表，但是当数据特别多时，人们往往需要从库中一个或几个表中查询到符合需要的一部分数据。</p>

<p>关系数据库是用数学方法处理数据的，关系间可以进行各种运算，以支持对数据库的各种操作，对关系数据库进行查询时，就需要对关系进行一定的关系运算。关系的基本运算有两类：一类是传统的集合运算（并、差、交等）；另一类是专门的关系运算（选择、投影、联接），有些查询需要几个基本运算的组合。</p>

<p>SQL</p>

<p>在VF中，SQL支持数据定义、查询、操纵功能，由于VF在安全控制方面的缺陷，SQL没有提供数据控制功能；VF支持的SQL命令有creat table,create cursor,alter table,select from,delete from,insert  into+B35,update</p>

<p>利用SQL命令建立的数据表同样可以完成在表设计器中设计表的所有功能；</p>

<p>数据插入：</p>

<p>insert into &lt;表名&gt; {(&lt;字段名清单&gt;)]  values (&lt;表达式清单&gt;);</p>

<p>insert into &lt;表名&gt; array&lt;数组名&gt;或 from  memvar;</p>

<p>视图：</p>

<p>建立一个查询男学生基本情况（属于成绩管理数据库）的视图，并按学号升序排列；</p>

<p>1 打开成绩管理数据库，选择文件菜单中的新建命令，选择视图，单击新建文件，打开视图设计器；</p>

<p>2 在弹出的添加表或视图对话框中加入学生档案表，进入视图设计器；</p>

<p>3 在字段选项卡的可用字段中选择学生档案表的全部字段，并添加到选定字段中；</p>

<p>4 在筛选选项卡中，指定查询条件为：学生档案.性别=&quot;男&quot;；</p>

<p>5 在排序依据选项卡中指定排序的字段为：学生档案.学号,升序。</p>

<p>6 单击工具栏中的运行按钮运行查询，并观察查询结果；</p>

<p>7 保存为“男同学基本情况表”；</p>

<p>8 单击视图工具栏上的SQL按钮，查看系统生成的SQL命令：(如果建立相同的查询，点击查询工具栏上的SQL按钮，生成的SQL代码一样)</p>

<p>select *</p>

<p>from 成绩管理!学生档案</p>

<p>where 学生档案.B28性别=&quot;男&quot;</p>

<p>order by 学生档案.学号</p>

<p></p>

<p>9 建立视图的SQL语句：</p>

<p>create view viewname as;</p>

<p>selec…</p>

<p></p>

<p>视图的打开和关闭：（与表类似，但查询的打开是用do命令）</p>

<p>open database 成绩管理</p>

<p>use 男同学基本情况</p>

<p>browse</p>

<p>use</p>

<p>使用SQL语句操作视图</p>

<p>select * from 男同学基本情况表</p>

<p>使用远程视图，无需将所有记录下载到本地计算机即可提取远程ODBC服务器上的数据子集；用户可以在本地机上操作这些选定的记录，然后把更改或添加的值返回到远程数据源中；</p>

<p>建立远程视图前要建立“连接”文件，然后在定义时输入连接名或数据源名称；</p>

<p></p>

<p>查询是一种相对独立且功能强大、结果多样的数据库资源，利用查询可以实现对数据库中数据的浏览、筛选、排序、检索、统计及加工等操作；利用查询可以为其他数据库提供新的数据表，可以从单个表中提取有用的数据，也可以从多个表中提取综合信息。</p>

<p>使用查询和使用视图一样，比使用数据表和数据库更方便、快捷和安全。</p>

<p>视图和查询相比，视图虽然比查询多了一个更新功能，但是查询的输出格式的多样化又是视图所不及的，使用查询很重要的是如何确定查询结果的输出格式。</p>

<p>虽然视图是一个“虚表”，但是也可以利用视图更新数据表中的数据。因为视图可以限定数据表中数据的使用范围，因此，也就限定了可更新的数据，数据表中其他的数据就不会被破坏，由此可以提高数据维护的安全性。</p>

<p>查询的本质是一条SQL语句；</p>

<p>视图定义：</p>

<p>create view v_student AS;</p>

<p>select 姓名,性别,籍贯 from student</p>

<p>VF中的视图是一个定制的虚拟表，可以是本地的、远程的、带参数的。视图可引用一个或多个表，或者引用其他视图。</p>

<p>在VF中视图是可以更新的，但是这种更新是否反映在基本表中则取决于视图更新属性的设置。在关系数据库中，视图自己并不拥有数据，它的数据实际上来自于基本表。所以，虽然视图可以像表一样更新进行各种查询，但是插入、更新和删除操作在视图上却有一定的限制。在一般情况下，当一个视图是由单个表导出时，插入、更新和删除操作都一定要慎重进行。</p>

<p>查询设计器和视图设计器的主要不同表现在于:询设计器没有&quot;更新条件&quot;选项卡，有&quot;查询去向&quot;选项</p>

<p>27) 使用菜单操作方法打开一个在当前目录下已经存在的查询文件zgjk.qpr后，在命令窗口生成的命令是  。</p>

<p>A) OPEN QUERY zgjk.qpr B) MODIEY QUERY zgjk.qpr</p>

<p>C) DO QUERY zgjk.qpr D) CREATE QUERY zgjk.qpr</p>

<p>视图允许的操作</p>

<p>在数据库中使用use命令打开或关闭视图；</p>

<p>在浏览器窗口中显示或修改视图中的记录</p>

<p>使用SQL语句操作视图</p>

<p>在文本框 、表格控件、表单或报表中使用视图作为数据源等；</p>
<p>

</div>
<a name="bottom" id="bottom"></a>
<DIV style="DISPLAY: none" id=goTopBtn>&and;</DIV>
<div id="goBottom"><a href="#bottom" target="_self">&or;</a></div>
<SCRIPT type=text/javascript>goTopEx();</SCRIPT>
</body>
</html>
<script language="javascript"> 
bg_evensssss("tbrowser","#fff","#F5F5F5","#FFFFCC","#FFDDFF");/*#FFFF84*/
</script>
