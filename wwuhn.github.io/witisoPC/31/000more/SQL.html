<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script language="javascript"> 
//bg_even("表格ID属性名","奇数行背景色","偶数行背景色","鼠标经过背景色","点击后背景色");
function bg_even(o,a,b,c,d){
        var t=document.getElementById(o).getElementsByTagName("tr");
        for(var i=0;i<t.length;i++){
                t[i].style.backgroundColor=(t[i].sectionRowIndex%2==0)?a:b;
                t[i].onclick=function(){
                        if(this.x!="1"){
                                this.x="1";
                                this.style.backgroundColor=d;
                        }else{
                                this.x="0";
                                this.style.backgroundColor=(this.sectionRowIndex%2==0)?a:b;
                        }
                }
                t[i].onmouseover=function(){
                        if(this.x!="1")this.style.backgroundColor=c;
                }
                t[i].onmouseout=function(){
                        if(this.x!="1")this.style.backgroundColor=(this.sectionRowIndex%2==0)?a:b;
                }
        }
}
</script> 
<script type="text/javascript">
 
 function goTopEx(){
        var obj=document.getElementById("goTopBtn");
        function getScrollTop(){
                return document.documentElement.scrollTop;
            }
        function setScrollTop(value){
                document.documentElement.scrollTop=value;
            }    
        window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
        obj.onclick=function(){
            var goTop=setInterval(scrollMove,10);
            function scrollMove(){
                    setScrollTop(getScrollTop()/111);
                    if(getScrollTop()<1)clearInterval(goTop);
                }
        }
    }


</script>
<script type="text/javascript">
 
 function goTopEx(){
        var obj=document.getElementById("goTopBtn");
        function getScrollTop(){
                return document.documentElement.scrollTop;
            }
        function setScrollTop(value){
                document.documentElement.scrollTop=value;
            }    
        window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
        obj.onclick=function(){
            var goTop=setInterval(scrollMove,10);
            function scrollMove(){
                    setScrollTop(getScrollTop()/111);
                    if(getScrollTop()<1)clearInterval(goTop);
                }
        }
    }


</script>
<title>sql</title>

 <style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}
P{
margin:8px;
text-indent:2em;
}
.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:15px;
margin-bottom:0px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color:#eee;
    color:#000;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 100px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    background-color: #eee;
    color: #fff;
    font-size: 12px;
    text-align: center;
    position: fixed;
    _position: absolute;
 
    right: 10px;
    bottom: 70px;
    _bottom: "auto";
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
 img{
 border:0;
 }#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	text-align:left;
	line-height:1.3em;
	table-layout:fixed;
}

#tbrowser th,#tbrowser td{
border:1px solid #ddd;
font-size:1em;
color:#000000;
text-align:left;
font-family: "宋体";
padding-left:3px;
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
padding:5px 0px;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;
text-align:left;
/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/
text-align:left;
/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;
text-align:left;
/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;
text-align:left;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;
text-align:left;
line-height:18px;
font-size:16px;
color:#777;
}
.floatr{
float:right;
padding-right:5px;
}

#tbrowser th a:link {
	text-decoration: none;
	color:white;
}
#tbrowser th a:hover {
	text-decoration: none;
	color:white;
}
#tbrowser th a:active {
	text-decoration: none;
	color:white;
}
#tbrowser th a:visited {
	text-decoration: none;
	color:white;
}
#tbrowser caption{
font-size:1.2em;
text-align:left;
}
#tbrowser thead td{
font-size:0.8em;
text-align:left;
}
 </p>

<p>
 
 
</p>

<p>
 </style>
</head>

<body> 
<div class="container">
<!--
<table id="tbrowser">
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
-->

<!--
height="*\w*"
width="*\w*"
</p>
<p>
-->

<p>是一种说明性的编程语言；对于C之类的过程语言，你编写程序时需要指明得出结果所需的每个步骤，使用SQL这种说明性语言，只需描述想要的内容中，无需了解存取路径，只需提出what to do，而无需指明how to do;是一种面向集合的操作方式，只用于9个动词。因此，标准的SQL没有传统的流程控制结构，如if-then-else、for等语句；</p>
<p>它是交互式式或嵌入式语言。在交互式SQL环境中，用户输入的SQL命令直接发送到数据库管理系统，得到结果后立即显示。DBMS的服务器同时拥有图形和命令行工具，用一接受用户输入的SQL语句或包含SQL程序（脚本）的文本文件。</p>
<p>在开发数据库应用程序时，可以将SQL语句“嵌入”到编写程序所用的宿主语言(host language)中。宿主语言通常是一种通用语言（如C++、Java）或脚本语言(如PHP或Python).如一个PHP CGI脚本可以用SQL语句来查询MySQL数据库，MySQL交查询的结果返回给PHP变量，以便进一步分析或显示在网页上。 </p>
<p>但在DBMS、宿主语言或操作环境中，语法上略有差异。</p>
<p>SQL表示“结构化查询语言”是一种变通的误解。它不是结构化的，不只用于查询，不是一种过程语言；</p>
<p>查询只是SOL语言的重要组成部分，但不是全部，除了查询功能处，还包括数据定义（对表、表结构的操作），create,drop alter;数据操作：对表记录的操作,insert,delete,update；数据控制：grant,revoke(Vf不提供SQL的数据控制功能）。数据查询:select;目前所有的关系型数据库管理系统如oracle,SQL Server,DB2,VFP都支持SQL；</p>
<p>其实就是对表、对表中列、行的操作；</p>
<p>1 创建、更改和删除表；</p>
<p>2 插入、更新和删除行；</p>
<p>3 查询（从n表中）选择列，筛选列；</p>
<table id="tbrowser">
<col width="30%" />
<col width="10%" />
<col width="60%" />
  <tr height="19">
    <td width="402" height="19">数据定义语句:对表或表结构的操作</td>
    <td width="518">Create</td>
    <td width="518">&nbsp;</td>
  </tr>
  <tr height="19">
    <td height="19">&nbsp;</td>
    <td>Alter</td>
    <td>&nbsp;</td>
  </tr>
  <tr height="19">
    <td height="19">&nbsp;</td>
    <td>Drop</td>
    <td>&nbsp;</td>
  </tr>
  <tr height="19">
    <td height="19">数据操作语句:对表记录的操作</td>
    <td>Insert</td>
    <td>&nbsp;</td>
  </tr>
  <tr height="19">
    <td height="19">&nbsp;</td>
    <td>Update</td>
    <td>&nbsp;</td>
  </tr>
  <tr height="19">
    <td height="19">&nbsp;</td>
    <td>Delete</td>
    <td>&nbsp;</td>
  </tr>
  <tr height="19">
    <td height="19">数据查询语句</td>
    <td>Select</td>
    <td>&nbsp;</td>
  </tr>
  <tr height="19">
    <td height="19">数据控制语句</td>
    <td>Grant</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>SQl中是不区分字母大小写的，对一地SQL关键字一般用大写，对于子句也一般另起一行；。</p>

<p>SQL的三级模式：</p>

<p>外模式：视图</p>

<p>模式：基本表</p>

<p>内模式：存储文件 </p>
<table id="tbrowser">
  <col width="64" />
  <col width="54" />
  <col width="47" />
  <col width="76" />
  <col width="64" />
  <col width="83" />
  <tr height="19">
    <td height="19" width="64">DDL</td>
    <td width="54">create</td>
    <td width="47">talbe</td>
    <td width="76">tablename</td>
    <td width="64">　</td>
    <td width="83">　</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>alter</td>
    <td>table</td>
    <td>tablename</td>
    <td>add</td>
    <td>fieldname</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>alter</td>
    <td>fieldname</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>set check</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>set default</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>drop check</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>drop default</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>rename</td>
    <td>column</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
    <td>drop</td>
    <td>column</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>drop</td>
    <td>table</td>
    <td>tablename</td>
    <td>　</td>
    <td>　</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19">DML</td>
    <td>insert</td>
    <td>into</td>
    <td colspan="3">target[(field1[,field2[,…]])]</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td colspan="3">values(values1[,values2[,…]])</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td colspan="2">update </td>
    <td>tablename</td>
    <td>　</td>
    <td>　</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>set</td>
    <td colspan="3">cloumn_name=eExpression1[,column_name=eExpression2…]</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>　</td>
    <td colspan="3">where filtercondition</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>delete</td>
    <td>from</td>
    <td colspan="3">tablename[where    condition]</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>select</td>
    <td>item</td>
    <td>　</td>
    <td>　</td>
    <td>　</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td>from</td>
    <td>tablename</td>
    <td>　</td>
    <td>　</td>
  </tr>
  <tr height="19">
    <td height="19">　</td>
    <td>　</td>
    <td colspan="2">where condition</td>
    <td>　</td>
    <td>　</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td colspan="3">create table score(</td>
    <td></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td colspan="4">课程代码 c(3) primary key,</td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td colspan="3">课程名称 c(20),</td>
    <td></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td colspan="3">学分 n(1,0))</td>
    <td></td>
    <td></td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td width="54"></td>
    <td width="47"></td>
    <td width="76"></td>
    <td width="64"></td>
    <td width="83"></td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td></td>
    <td colspan="4">性别 c(2) check（性别=&quot;男&quot;,or    性别=&quot;女&quot;)</td>
  </tr>
  <tr height="19">
    <td height="19"></td>
    <td></td>
    <td colspan="2">简历 G null</td>
    <td></td>
    <td></td>
  </tr>
</table>
<p>update tablename set column_name=eExpresion1  [,column_name2=eExpression2…]</p>

<p>where filterCondiotn [,filterconditon…]</p>

<p></p>

<p>replace [&lt;scope&gt;]&lt;recordname1&gt; with  &lt;expression1&gt;[addictive] [,&lt;recordname2&gt; with  &lt;expression2&gt;[addictive]</p>

<p>[for&lt;condition&gt;][while&lt;condition&gt;]</p>

<p></p>
<h4>Select</h4>
<p>Select的选择项可以是表文件中的一个字段，也可以是一个常量，也可以是一个表达式，对于字段和表达式还可以使用下列函数：avg\sum\count\min\max;</p>
<table id="tbrowser">
  <col width="402" />
  <col width="518" />
  <tr height="19">
    <td height="19" width="402"><strong>SELECT</strong> [all ｜ Distinct][top Expr [percent]]</td>
    <td width="518">&nbsp;</td>
  </tr>
  <tr height="29">
    <td height="29">[alias.] <strong>Columns</strong> [as column_name]</td>
    <td width="518">指定查询中包含的字段(列)、常数、表达式；</td>
  </tr>
  <tr height="19">
    <td height="19"><strong>From</strong> [databasename!] <strong>table</strong>s [[as]local_alias]</td>
    <td width="518">指定查询所用的表的名称，可以是多个；</td>
  </tr>
  <tr height="19">
    <td height="19">[[inner]    ｜ Left [outer] ｜ Right [outer] ! Full [outer] Join    databaseName!]</td>
    <td width="518">指定两个表的内在关系；</td>
  </tr>
  <tr height="19">
    <td height="19">[on    joincondition…]</td>
    <td width="518">指定表的连接条件</td>
  </tr>
  <tr height="19">
    <td height="19" colspan="2">&nbsp;</td>
    </tr>
  <tr height="19">
    <td height="19">[<strong>WHERE</strong>    joincondition [and    joinCondition…</td>
    <td width="518">指定查询条件</td>
  </tr>
  <tr height="19">
    <td height="19">[and ! Or filterCondition [and ! Or filterCondition…]]]</td>
    <td width="518">　</td>
  </tr>
  <tr height="19">
    <td height="19">[<strong>GROUP</strong> by groupColumn    [,GroupColumn…]]</td>
    <td width="518">根据某一列或某几列的值将查询结果中的各行进行分组；</td>
  </tr>
  <tr height="19">
    <td height="19">[having filterCondition]</td>
    <td width="518">指定包含在查询结果中的组必须满足的条件</td>
  </tr>
  <tr height="19">
    <td height="19">[<strong>UNION</strong> [all] selectCommand]</td>
    <td width="518">将一个SELECT的查询结果与另一个查询结果联接在一起；</td>
  </tr>
  <tr height="19">
    <td height="19">[<strong>ORDER</strong> by    order_item [asc ! Desc][,order_item    [asc ! Desc]…]]</td>
    <td width="518">根据某列或某几列中的数据查询结果进行排序；</td>
  </tr>
  <tr height="19">
    <td height="19">[<strong>INTO</strong> [array arrayname ｜ Cursor    cursorName</td>
    <td width="518">指定查询结果的去向；</td>
  </tr>
  <tr height="19">
    <td height="19">[nofilter ｜    Readwrite] ｜ Table tableName[additive]</td>
    <td width="518">　</td>
  </tr>
  <tr height="19">
    <td height="19">! To printer    [prompt] ! To screen]][prefference    name][noconsole][plain][nowait]</td>
    <td width="518">　</td>
  </tr>
  <tr height="19">
    <td height="19">[database databasename [name long TableName]]]]</td>
    <td width="518">　</td>
  </tr>
</table>
<p>into array:将查询结果保存到数组中，该数组为二维数组，数组的列对应记录字段，数据的行对应记录；</p>

<p>into cursor:将查询结果保存到临时表中，查询执行后，存放查询结果的表成为当前表。临时表除不能被修改外，其他特点与普通表一样。应用程序被关闭时，临时表自动被删除。</p>

<p>into table tableName:将查询结果保存到永久表中；</p>

<p>to file:将查询结果保存到文本文件中；</p>

<p>to print[prompt]:将查询结果输出到打印机；prompt表示打印之前显示打印机设置对话框</p>

<p>from子句：列出所有从中检索数据的表，如果没有打开表，VF自动打开表，查询结束后关闭。</p>

<p>select子句：指定包括在查询结果中的项，一个项可以是以下内容（各元素用逗号分开）：</p>

<p>1 通配符：*</p>

<p>2 表中的字段名称；</p>

<p>3 foxpro函数；</p>

<p>4 select中可用的列函数；</p>

<p>5 用户自定义的函数；</p>

<p>6 常数；</p>

<p>若在select子句中的字段名是唯一的，则不必在字段名前加别名修饰，SQL能自动找到这些字段。若字段名是非唯一的（即同一字段名出现在from子句中的两个或两个以上表中），则必须使用字段所在表的别名修饰该字段。</p>

<p>select中可使用的通配符：*，如上述；%，_;*只能用在select字句中，后面的%和_只能用在where子句中，和like一起使用，%表示一个字符串，而_表示一个字符。如：select 客户名 from 客户表 where 客户名 like &quot;山东%银行&quot;</p>

<p>as可以创建列的别名；</p>

<p>Distinct消除重复行：如：select distinct 客户名称 from 销售明细表；</p>

<p>where子句筛选行；</p>

<p>说明选择记录的条件，可以包含多个选择条件，各条件间用and\or连接而构成较长的逻辑表达式；</p>
<p>like匹配模式</p>
<p>between进行范围筛选；</p>
<p>in进行列表筛选；</p>
<p>is null测试空值； </p>
<p>ORDER BY排序列； </p>
<p>and,or和not组合及求反条件；</p>

<p>select * form 工资表 where 员工名称  in(select 员工名称 from 员工表 where 学历=&quot;大专&quot;</p>

<p>使用宏替换：</p>

<p>如现有一个查询表单，用户自己可以输入查询条件，则[开始]按钮的click过程：</p>

<p>cSearch=alltrim(thisform.text1.value)</p>

<p>select * from customer where &amp;cSearch</p>

<p>order by子句：对查询结果进行排序；</p>

<p>groud by子句：对查询结果进行分组小计；</p>

<p>having子句：分组条件，where子句只能对基表中的记录做筛选。</p>

<p>使用top子句选择一定数量或一定百分比的记录：如：select top 10 * from…</p>

<p>如果要查询所藏图书中，各个出版社的图书最高单价、平均单价和册数，请对下面的SQL语句填空。</p>

<p>SELECT 出版单位，MAX（单价）,AVG（单价）,  COUNT(*) ；</p>

<p>FROM 图书管理!图书； GROUP BY 出版单位 </p>
<h4>子查询</h4>
<p>SELECT pub-name</p>
<p>&nbsp;&nbsp;FROM publishers</p>
<p>&nbsp;&nbsp;WHERE pub-id IN</p>
<p>&nbsp;&nbsp;(SELECT pub-id </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;FROM titles</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;WHERE type = 'biography')   </p>
<p>索引是排序的列表，在这个列表中索引列（或列表）的每个不同值和包含该值的行的硬盘地址存储在一起。DBMS无需检索整个表来定位行，而仅需扫描索引中的地址，就可以直接访问相应列。索引搜索通常要比顺序搜索快，但也是有代价的。其实质也就是另建了一张反映被索引表的行的地址清单；</p>
<p>视图是存储的select语句，它能返回基于一个或多个表（或称作基础表）检索得到的数据表；</p>
<p>视图的基础表可以是基本表、临时表或其他视图，是指定的数据列或数据行的集合。</p>
<p>CREATE VIEW view-customes</p>
<p>&nbsp;&nbsp;AS</p>
<p>&nbsp;&nbsp;SELECT ...</p>
<p>创建视力并不会有任何显示，只是为了让DBMS用一个命名的select语句存储视图，然后通过其检索数据；   <br />
</p>
<p>&nbsp;</p>
</div>
<a name="bottom" id="bottom"></a>
<DIV style="DISPLAY: none" id=goTopBtn>&and;</DIV>
<div id="goBottom"><a href="#bottom" target="_self">&or;</a></div>
<SCRIPT type=text/javascript>goTopEx();</SCRIPT>
</body>
</html>
<script language="javascript"> 
bg_evensssss("tbrowser","#fff","#F5F5F5","#FFFFCC","#FFDDFF");/*#FFFF84*/
</script>