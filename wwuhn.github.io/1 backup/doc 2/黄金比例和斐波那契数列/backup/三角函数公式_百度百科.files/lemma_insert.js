baidu.more.ns("rs");rs.apply=function(C,A,_){if(_){rs.apply(C,_);}if(C&&A&&typeof A=="object"){for(var B in A){C[B]=A[B];}}return C;};rs.alert=function(A,D){var B="\u786e\u5b9a";if(D&&D.okText){B=D.okText;}var C={buttons:{accept:{content:"<div class='tangram-dialog-button' >"+B+"</div>",onclick:function(){var A=this,_=A.getParent();_.dispatchEvent("onaccept")&&_.close();}}},titleText:"\u63d0\u793a",width:300},_='<div class="rs-info">'+A+"</div>";rs.apply(C,D);baidu.ui.dialog.alert(_,C);};rs.confirm=function(_,B){var A={buttons:{accept:{content:"<div class='tangram-dialog-button' >"+(B.btnName||"\u786e\u5b9a")+"</div>",onclick:function(){var A=this,_=A.getParent();_.dispatchEvent("onaccept")&&_.close();}},cancel:{content:"<div class='tangram-dialog-button' >\u53d6\u6d88</div>",onclick:function(){var A=this,_=A.getParent();_.dispatchEvent("oncancel")&&_.close();}}},autoDispose:false,titleText:"\u786e\u8ba4"};rs.apply(A,B);return baidu.ui.dialog.confirm(_,A);};rs.trim=function(_){if(typeof(_)=="object"){if(typeof(_.length)=="number"){baidu.each(_,function(A,B){_[B]=rs.trim(_[B]);});}else{for(var A in _){_[A]=rs.trim(_[A]);}}}else{_=baidu.string.trim(_);}return _;};rs.hover=function(A,_){if(baidu.lang.isArray(A)){baidu.each(A,function(A){rs.hover(A,_);});}else{baidu.on(A,"mouseout",function(){baidu.dom.removeClass(A,_);});baidu.on(A,"mouseover",function(){baidu.dom.addClass(A,_);});}};baidu.dom.radioClass=function(A,_){baidu.each(A.parentNode.childNodes,function(A){if(A.nodeType==1){baidu.dom.removeClass(A,_);}});baidu.dom.addClass(A,_);};String.prototype.subText=function(A,_){if(!_){_="...";}if(this.length>A){return this.substr(0,A)+_;}else{return this;}};baidu.dom.ready(function(){if(baidu.ui&&baidu.ui.tree){baidu.ui.tree.Tree.options={draggable:false};}});rs.subByte=function(_,A){if(baidu.string.getByteLength(_)>A){return baidu.string.subByte(_,A)+"...";}return _;};var JSON=window.JSON||baidu.json;rs.log=function(_){alert("\u8981\u6253\u5370\u7684\u4fe1\u606f\u5982\u4e0b\n"+JSON.stringify(_));};baidu.more.ns("rs");rs.Request=function(_){this.method=_;this.url="/guanxi/api/"+_+"?token="+(new Date()).getTime();this.args=null;};rs.Request.prototype={post:function(){var _=this;this.args=this.args?("args="+encodeURIComponent(baidu.json.stringify(this.args))):"args=[]";baidu.ajax.post(this.url,this.args,function(B,C){var A=baidu.json.parse(C);if(A.error_code==-2){alert("\u4f60\u6ca1\u6709\u767b\u5f55\uff0c\u6216\u8005\u6ca1\u6709\u76f8\u5e94\u7684\u6743\u9650\uff01");window.location="/guanxi/admin/login";}if(A.error_code==-3){alert("\u4f60\u6ca1\u6709\u767b\u5f55,\u8bf7\u767b\u5f55\u540e\u518d\u64cd\u4f5c\uff01");userlogin.check(function(){if(_.callback){_.callback(A);}});return;}if(A.error_code==null){alert("\u6570\u636e\u9519\u8bef,\u8bf7\u8054\u7cfbRD!\nerror_code : null");return;}if(_.callback){_.callback(A);}});}};baidu.more.ns("rs");rs.PageTable=function(_){rs.apply(this,_,{container:null,pageDataKey:"pageData",listDataKey:"list",filterDataKey:"filter",idDataKey:"id",limit:10,offset:0,reuqestUrl:null,data:null,filter:{}});this.request=new rs.Request(this.requestUrl);this._bind();this.bind("pagetable_check_item",this.checkSelected);this.bind("pagetable_checkall",this.checkAll);};rs.PageTable.prototype={goPage:function(B,_){if(B!=null){this.offset=B;}if(_!=null){this.limit=parseInt(_);}var A=this;this.request.args=[this.offset,this.limit,this.filter];this.request.callback=function(_){A.data=_;A.renderTable();};this.dispatchEvent("onbeforerequest");this.request.post();},checkAll:function(A){isCheck=A.checked;var _=baidu.dom.q("pagetable_check_item",this.container);baidu.each(_,function(_){_.checked=isCheck?true:false;});_=baidu.dom.q("pagetable_checkall",this.container);baidu.each(_,function(_){_.checked=isCheck?true:false;});},addHover:function(A){var _=baidu.dom.query('table[class="common"]  tr');baidu.each(_,function(_){baidu.on(_,"mouseover",function(){baidu.dom.addClass(_,"over");});baidu.on(_,"mouseout",function(){baidu.dom.removeClass(_,"over");});});_=null;},editInRow:function(_){var B=this.data.pageData.list,A=baidu.array.find(B,function(A,B){return(A.id==_);});A.state="edit";this.renderTable();},renderTable:function(){this.dispatchEvent("onbeforerender");this.data.tableFlag=this.tableFlag||"";this.render(this.data,this.container);this.dispatchEvent("onafterrender");},search:function(_,C){var A=rs.form.getFormData(_);if(!C){rs.apply(this.filter,A);}else{for(var B in A){this.filter[B]=null;}}this.goPage(0);},addRow:function(){var A=this.getListData(),_=baidu.object.clone(A[0]);_.state="edit";A.push(_);this.renderTable();},getSelectedRows:function(){var A=baidu.dom.q("pagetable_check_item",this.container),C=[],_=this,B=_.getListData();baidu.each(A,function(A,_){B[_].checkState=A.checked;if(A.checked){C.push(B[_]);}});return C;},checkSelected:function(A){if(A){var B=baidu.dom.getAncestorByTag(A,"tr");if(B){A.checked?baidu.dom.addClass(B,"tr-selected"):baidu.dom.removeClass(B,"tr-selected");}}var D=baidu.dom.q("pagetable_check_item",this.container),_=this.getSelectedRows(),C=(D.length==_.length)&&(D.length!=0);baidu.each(baidu.dom.q("pagetable_checkall",this.container),function(_){_.checked=C;});},getPageData:function(){return this.data[this.pageDataKey];},getListData:function(){return this.data[this.pageDataKey][this.listDataKey];},getFilterData:function(){if(this.data){return this.data[this.pageDataKey][this.filterDataKey];}},getDataItemById:function(_){var B=this,A=this.getListData();return baidu.array.find(A,function(A,C){return(A[B.idDataKey]==_);});},saveData:function(B,C,A,_){this.getListData()[B][C]=A;},_bind:function(){var A=this,_=function(C){var B=false,F=baidu.event.get(C),G=F.target,_=A._actionConfig||{};for(var H in _){if(baidu.dom.hasClass(G,H)){_[H].call(A,G);baidu.event.stopPropagation(C);B=true;break;}}if(!B&&G.tagName.toLowerCase()!="a"&&G.tagName.toLowerCase()!="button"&&G.tagName.toLowerCase()!="input"){var E=baidu.dom.getAncestorByTag(G,"tr");if(E){var D=baidu.q("pagetable_check_item",E);if(D.length>0){baidu.event.fire(D[0],"click");}}}H=null;_=null;G=null;F=null;C=null;};baidu.on(this.container,"click",_);},bind:function(B,A){var _=this._actionConfig||{};_[B]=A;this._actionConfig=_;},unbind:function(){var _=this._actionConfig||{};delete _[sel];this._actionConfig=_;}};baidu.lang.inherits(rs.PageTable,baidu.lang.Class);var pageTable=pageTable||{},lemmars={buildHTML:function(B,_,D){var C="";for(var E=0;E<B.length;E++){var A=B[E];C+='<div style="display:none">'+'\t<div id="rs'+A.fentryTableId+'" class="lemma-relation-table clearfix '+(D?" lemma-relation-top ":"")+(A.isExpand==0?"lemma-relation-table-close":"")+'">'+'\t\t<div class="relation-table-banner relation-banner-'+_+'" id="table-banner-'+_+"-"+(A.fcategoryId||A.fentryTableId)+'">'+'\t\t\t<a id="relation-title-link-more-'+_+"-"+(A.fcategoryId||A.fentryTableId)+'" class="relation-table-icon nslog:'+(D?"2130":"2140")+'" title="\u767e\u79d1\u5173\u7cfb" href="/guanxi/view/'+encodeURIComponent(A.entryTitle)+"/"+A.entryId+"#"+A.templateId+'" target="_blank"></a>'+'\t\t\t<span class="relation-table-view-control">'+'\t\t\t\t<a class="relation-control-enter-edit nslog:'+(D?"2131":"2141")+' " target="_blank" href="/guanxi/view/'+encodeURIComponent(A.entryTitle)+"/"+A.entryId+"?e=1#"+A.templateId+'" hidefocus="true"></a>'+'\t\t\t\t<a class="relation-control relation-control-enter-close nslog:'+(D?"2132":"2142")+'" href="#" onclick="return false;" hidefocus="true" title="\u6536\u8d77"></a>'+'\t\t\t\t<a class="relation-control relation-control-enter-open nslog:'+(D?"2132":"2142")+'" href="#" onclick="return false;" hidefocus="true" title="\u5c55\u5f00"></a>'+"\t\t\t</span>"+'\t\t\t<h3 class="relation-table-title">'+'\t\t\t\t<a id="relation-title-'+_+"-"+(A.fcategoryId||A.fentryTableId)+'" class="table-title nslog:'+(D?"2133":"2143")+'" href="/guanxi/view/'+encodeURIComponent(A.entryTitle)+"/"+A.entryId+"#"+A.templateId+'" target="_blank" hidefocus="true"></a>'+"\t\t\t</h3>"+"\t\t</div>"+'\t\t<div class="relation-table-main nslog-area"  data-nslog-type="'+(D?"2134":"2144")+'" id="relation-table-main-'+_+"-"+(A.fcategoryId||A.fentryTableId)+'"></div>\t'+"\t</div>"+"</div>";}return C;},relationInsert:function(_,B){nslog.set("rs-relation","1");B.foot=B.foot||[];B.top=B.top||[];allData=B.foot.concat(B.top);if(B.foot.length){nslog.set("rs-relation-foot","1");document.write((B.top.length?"":'<a name="rs-1" id="rs-1" oid="'+B.foot[0].fentryTableId+'"></a>')+'<div id="rs-foot" oid="'+B.foot[0].fentryTableId+'">'+this.buildHTML(B.foot,_)+"</div>");}if(B.top.length){nslog.set("rs-relation-top","1");document.write('<span id="place-'+_+'"></span>');var A=baidu.g("place-"+_).parentNode,C=baidu.dom.query('fieldset[id^="catalog"]',A)[0]||baidu.dom.query('.lemma-main-content[id^="lemmaContent"]',A)[0];baidu.insertHTML(C,"beforeBegin",'<a name="rs-1" id="rs-1" oid="'+B.top[0].fentryTableId+'"></a><div id="rs-top" oid="'+B.top[0].fentryTableId+'">'+this.buildHTML(B.top,_,true)+"</div>");}baidu.each(allData,function(A){var B=baidu.g("table-banner-"+_+"-"+(A.fcategoryId||A.fentryTableId));baidu.on(B,"click",function(_){var A=baidu.event.getTarget(_);if((A.nodeName.toLowerCase()=="a")&&!baidu.dom.hasClass(A,"relation-control")){return true;}lemmars.lemmaRelationAction(B);});});if(typeof(clientTable)=="undefined"){baidu.sio.callByBrowser("/guanxi/static/js/template_render_lemma.js",function(){baidu.each(B.top,function(A){lemmars.showRelation(_,A,true);});baidu.each(B.foot,function(A){lemmars.showRelation(_,A);});},{charset:"utf-8"});}else{baidu.each(B.top,function(A){lemmars.showRelation(_,A,true);});baidu.each(B.foot,function(A){lemmars.showRelation(_,A);});}},cateInsert:function(_,B){nslog.set("rs-category","1");var C="";for(var D=0;D<B.length;D++){var A=B[D];C+='<div style="display:none">'+'\t<div class="lemma-category-table">'+'\t\t<div class="relation-table-banner table-banner-'+_+'" id="table-banner-'+_+"-"+A.fcategoryId+'">'+'\t\t\t<h3 class="relation-table-title">'+'\t\t\t\t<a id="cate-title-'+_+"-"+A.fcategoryId+'" class="table-title  nslog:2016" href="#" hidefocus="true" target="_blank"></a>'+'\t\t\t\t<span class="relation-table-view-control">'+'\t\t\t\t\t<a class="relation-control relation-control-enter-close nslog:2017" href="#" hidefocus="true" onclick="return false;" title="\u6536\u8d77"></a>'+'\t\t\t\t\t<a class="relation-control relation-control-enter-open nslog:2017" href="#" hidefocus="true" onclick="return false;" title="\u5c55\u5f00"></a>'+"\t\t\t\t</span>"+"\t\t\t</h3>"+"\t\t</div>"+'\t\t<div class="relation-table-main" id="cate-table-main-'+_+"-"+A.fcategoryId+'"> </div>'+"\t</div>"+'\t<div class="relation-come-from">\u4ee5\u4e0a\u5185\u5bb9\u6765\u81ea\u767e\u79d1\u5173\u7cfb<a id="cate-title-link-more-'+_+"-"+A.fcategoryId+'" href="#" class="more nslog:2018 relation-table-icon" target="_blank" hidefocus="true"></a></div>'+'\t<div class="bpctrl"></div>'+"</div>";}document.write(C);baidu.each(B,function(A){var B=baidu.g("table-banner-"+_+"-"+(A.fcategoryId||A.fentryTableId));baidu.on(B,"click",function(_){var A=baidu.event.getTarget(_);if((A.nodeName.toLowerCase()=="a")&&!baidu.dom.hasClass(A,"relation-control")){return true;}lemmars.lemmaRelationAction(B);});});if(typeof(clientCategoryRender)=="undefined"){baidu.sio.callByBrowser("/guanxi/static/js/category_render.js",function(){baidu.each(B,function(A){lemmars.showCategory(_,A);});},{charset:"utf-8"});}else{baidu.each(B,function(A){lemmars.showCategory(_,A);});}},lemmaRelationAction:function(_){_=_.parentNode;if(!baidu.dom.hasClass(_,"lemma-relation-table-close")){baidu.dom.addClass(_,"lemma-relation-table-close");}else{baidu.dom.removeClass(_,"lemma-relation-table-close");}return false;},showRelation:function(B,C,D){var F=C.entryId,_=C.templateId,E=C.fentryTableId,A=new rs.Request("view/getFEntryTableContent");A.callback=function(C){if(C.error_code==0){C.isTop=D;if(C.selectedTable.tpl.isSingle=="1"){var _={requestUrl:"view/getFEntryTableContent",limit:8,container:"relation-table-main-"+B+"-"+E,data:C,tableFlag:B+"-"+E,render:buildRelationTable},A=new rs.PageTable(_);A.filter={fentryTableId:E};pageTable[B+"-"+E]=A;A.renderTable();}else{buildRelationTable(C,"relation-table-main-"+B+"-"+E);}baidu.g("relation-title-"+B+"-"+E).innerHTML=baidu.string.encodeHTML(C.selectedTable.tableName)||"";baidu.show(baidu.g("relation-table-main-"+B+"-"+E).parentNode.parentNode);}else{baidu.g("relation-table-main-"+B+"-"+E).parentNode.parentNode.style.display="none";}};A.args=[0,8,{fentryTableId:E}];A.post();},showCategory:function(A,B){var C=B.fcategoryId,_=new rs.Request("category/gd");_.callback=function(E){if(E.error_code==0){var _={requestUrl:"category/getEntryListByFCategory",limit:40,container:"cate-table-main-"+A+"-"+C,data:E,tableFlag:A+"-"+C,render:clientCategoryRender,tableFlag:A+"-"+C},D=new rs.PageTable(_);D.filter={categoryId:C,fcategoryId:B.fcategoryId};pageTable[A+"-"+C]=D;D.renderTable();if(E.categoryTitle){baidu.g("cate-title-"+A+"-"+C).innerHTML=baidu.string.encodeHTML(E.pageData.fcategoryName);baidu.g("cate-title-"+A+"-"+C).href="/guanxi/category/"+encodeURIComponent(E.categoryTitle);baidu.g("cate-title-link-more-"+A+"-"+C).href="/guanxi/category/"+encodeURIComponent(E.categoryTitle);baidu.show(baidu.g("cate-table-main-"+A+"-"+C).parentNode.parentNode);}else{baidu.g("cate-table-main-"+A+"-"+C).parentNode.parentNode.style.display="none";}}else{baidu.g("cate-table-main-"+A+"-"+C).parentNode.parentNode.style.display="none";}};_.args=[0,40,B];_.post();},showRsPath:function(B,A){nslog.set("rs-path","1");var _=new rs.Request("view/getPath");_.callback=function(D){if(D.error_code==0){D.subId=A;var B="";for(var H=0;H<D.entryCategory.length;H++){var G="";for(var F=0,E=D.entryCategory[H].category.length;F<E;F++){G+='<a href="/guanxi/category/${encodeURIComponent(categoryPath.title)}" class="relation-category-title" target="_blank">${categoryPath.title}</a>';if(F<E){G+='<span class="relation-category-gt">&gt;</span>';}}B+='<p class="'+(H>1?"relation-category-hide":"")+'"> '+G+"</p>";}B='<div class="relation-category nslog-area" data-nslog-type="2003" id="relation-category-'+A+'">'+B+"</div>";document.write(B);if(baidu.g("relation-category-show-span-"+A)){var C=baidu.g("relation-category-show-span-"+A),_=baidu.g("relation-category-"+A);baidu.on(C,"click",function(){if(!baidu.dom.hasClass(_,"relation-category-all")){C.innerHTML="\u6536\u8d77";baidu.dom.addClass(_,"relation-category-all");}else{baidu.dom.removeClass(_,"relation-category-all");C.innerHTML="\u5c55\u5f00";}});}}};_.args=[B];_.post();}};